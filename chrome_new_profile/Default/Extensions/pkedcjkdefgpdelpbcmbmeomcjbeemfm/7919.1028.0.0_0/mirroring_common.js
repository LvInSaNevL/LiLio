'use strict';var qi;var ri=chrome.i18n.getMessage("545449835455981095");v("mr.IssueSeverity",{vx:"fatal",QC:"warning",Mz:"notification"});v("mr.IssueAction",{jx:"dismiss",Qy:"learn_more"});
var si=function(a,b){this.sinkId=this.routeId=null;this.severity=b;this.isBlocking="fatal"==this.severity?!0:!1;this.title=a;this.message=null;this.defaultAction="dismiss";this.helpPageId=this.secondaryActions=null},ui=function(){var a=new si(ti,"notification");a.helpPageId=6320939;a.defaultAction="learn_more";a.secondaryActions=["dismiss"];return a},vi=function(a){a.isBlocking=!0;return a},wi=function(a,b){a.routeId=b;return a},xi=function(a,b){a.sinkId=b;return a};var yi=function(a,b){var c=this;this.h=void 0===b?null:b;this.g=new Promise(function(d,e){var f=function(g){c.h=null;e(g)};c.j=f;a(function(g){c.h=null;d(g)},f)})};yi.prototype.cancel=function(a){this.j(a);if(this.h){var b=this.h;this.h=null;setTimeout(function(){return b(a)},0)}};var zi=function(a,b,c){c=void 0===c?null:c;return new yi(function(d,e){a.g.then(function(f){if(b)try{d(b(f))}catch(g){e(g)}else d(f)},function(f){if(c)try{d(c(f))}catch(g){e(g)}else e(f)})},function(d){a.cancel(d)})};
yi.prototype.then=function(a,b){return zi(this,a,void 0===b?null:b)};yi.prototype.catch=function(a){return zi(this,null,a)};var Ai=function(a){return new yi(function(b){b(a)})},Bi=function(a){return new yi(function(b,c){c(a)})},Ci=function(a){return new yi(function(b,c){a.then(b,c)})},Di=function(a,b){var c=!1,d=null;return new yi(function(e,f){a.then(function(g){c||(d=b(g),d.g.then(e,f))},f)},function(e){d?d.cancel(e):c=!0})};var Ei={qw:0,ow:1,tw:2,pw:3,Pv:4,rw:5,gy:6,fC:7,ax:8,UNKNOWN:9},Fi=function(a,b){a=Error.call(this,a);this.message=a.message;"stack"in a&&(this.stack=a.stack);this.reason=0<=b&&9>=b?b:9};q(Fi,Error);var aaa=function(){var a=l(navigator.userAgent.match(/Windows NT (\d+.\d+)/)||[]);a.next();a=a.next().value;return 6.2<=parseFloat(a)},Gi=function(){var a=navigator.userAgent;return a.includes("CrOS")?"ChromeOS":a.includes("Windows")?"Windows":a.includes("Macintosh")?"Mac":a.includes("Linux")?"Linux":"Other"};var baa=!("undefined"==typeof chrome||!chrome.networkingPrivate||!chrome.networkingPrivate.setWifiTDLSEnabledState||"ChromeOS"!=Gi()),Hi=["ChromeOS","Windows"].includes(Gi());var Ii=function(a,b,c,d){this.h=a;this.g=b;this.j=c||null;this.presentationId=d||null},Li=function(a,b){if("tab"==a.h)a=Ji(a);else if("offscreen_tab"==a.h)b=Ji(a),b.presentationId=a.presentationId,a=b;else{var c={audio:!1,video:!1};a.g.shouldCaptureVideo?(c.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:b}},Ki(a,c.video.mandatory),Hi&&a.g.shouldCaptureAudio&&(c.audio={mandatory:{chromeMediaSource:"system",chromeMediaSourceId:b}})):a.g.shouldCaptureAudio&&(c.audio={mandatory:{chromeMediaSource:"system"}});
a=c}return a},Ji=function(a){var b={audio:a.g.shouldCaptureAudio,video:a.g.shouldCaptureVideo};a.g.shouldCaptureVideo&&(b.videoConstraints={mandatory:{enableAutoThrottling:!0}},Ki(a,b.videoConstraints.mandatory));return b},Ki=function(a,b){var c=a.g.minWidth,d=a.g.minHeight;if(a.g.senderSideLetterboxing){c=a.g;if(0==c.minHeight||0==c.maxHeight?0:Math.floor(100*c.minWidth/c.minHeight)==Math.floor(100*c.maxWidth/c.maxHeight))c={width:c.minWidth,height:c.minHeight};else{d=c.maxWidth;for(var e=c.maxHeight;0!=
e;){var f=d%e;d=e;e=f}e=c.maxWidth/d;d=c.maxHeight/d;if(e<c.minWidth||d<c.minHeight)if(f=Math.max(c.minWidth/e,c.minHeight/d),e*=f,d*=f,e>c.maxWidth||d>c.maxHeight)e=c.maxWidth,d=c.maxHeight;e=Math.round(e);d=Math.round(d);c={width:e,height:d}}d=c;c=d.width;d=d.height}Object.assign(b,{minWidth:c,minHeight:d,maxWidth:a.g.maxWidth,maxHeight:a.g.maxHeight,minFrameRate:a.g.minFrameRate,maxFrameRate:a.g.maxFrameRate})};var Mi=function(a){this.g=a;this.h=this.qg=null;this.s=gb("mr.mirror.MirrorMediaStream")};Mi.prototype.start=function(){return"tab"==this.g.h?caa(this):"offscreen_tab"==this.g.h?daa(this):eaa(this)};
var caa=function(a){var b=Li(a.g);a.s.info("Starting tab capture with constraints "+JSON.stringify(b));return new Promise(function(c,d){chrome.tabCapture.capture(b,function(e){e?(Ni(a,e),c(a)):d(Oi())});window.setTimeout(function(){d(new Fi("chrome.tabCapture.capture failed to call its callback",2))},5E3)})};Mi.prototype.j=function(a){a&&this.s.info(function(){return"Track "+JSON.stringify(a.target)+" ended"});this.stop()};
var Oi=function(){return chrome.runtime.lastError&&chrome.runtime.lastError.message?new Fi(chrome.runtime.lastError.message,7):new Fi("empty_stream",0)},Pi=function(a){a=void 0===a?!0:a;return new Promise(function(b,c){var d=["screen"];a&&d.push("audio");"Linux"==Gi()&&d.push("window");var e=window.setTimeout(function(){f&&chrome.desktopCapture.cancelChooseDesktopMedia(f);c(new Fi("timeout",1))},6E4);var f=chrome.desktopCapture.chooseDesktopMedia(d,null,function(g){window.clearTimeout(e);g?b(g):c(new Fi("User cancelled capture dialog",
3))})})},Qi=function(a,b){return new Promise(function(c,d){a.s.info(function(){return"Starting desktop capture with constraints "+JSON.stringify(b)});navigator.mediaDevices.getUserMedia(b).then(function(e){e||d(new Fi("empty_stream",8));Ni(a,e);c(e)},function(e){var f=8;"NotAllowedError"==e.name&&(f=3);d(new Fi(e.name+" "+e.constraintName+": "+e.message,f))})})},eaa=function(a){return Hi&&a.g.g.shouldCaptureAudio&&!a.g.g.shouldCaptureVideo?Qi(a,Li(a.g)).then(function(){return a}):Pi().then(function(b){b=
Li(a.g,b);return Qi(a,b).then(function(){return a})})},daa=function(a){var b=Li(a.g);a.s.info(function(){return"Starting offscreen tab capture with constraints "+JSON.stringify(b)});return new Promise(function(c,d){chrome.tabCapture.captureOffscreenTab(a.g.j.toString(),b,function(e){e?(Ni(a,e),c(a)):d(Oi())})})},Ni=function(a,b){a.h=b;b.getAudioTracks().length||b.getVideoTracks();b.getTracks().forEach(function(c){c.onended=a.j.bind(a)})};
Mi.prototype.stop=function(){this.h&&(this.h.getTracks().forEach(function(a){a.onended=null;a.stop()}),this.h=null,this.qg&&this.qg())};var Ri=function(){},Ui=function(a){var b=Si.get(a)||null;if(b)return Promise.resolve(b);b=Ti.get(a);b||(b=new Cb,Ti.set(a,b),faa(a,b));return b.g},faa=function(a,b){var c=gaa.get(a)||null;if(!c)b.reject(Error("No corresponding bundle for "+a));else if(!haa.has(c)){var d=Vi.get(c);d||(Wi.info("Loading bundle "+c+" for module "+a),d=iaa(c),Vi.set(c,d));d.catch(function(e){b.reject(e)})}},iaa=function(a){var b=new Cb;b.g.then(function(){Wi.info("Bundle "+a+" loaded")},function(d){Wi.error("Failed to load bundle "+
a);throw d;});var c=document.createElement("script");c.src=chrome.extension.getURL(a);c.setAttribute("type","text/javascript");c.async=!0;c.onload=function(){return b.resolve(void 0)};c.onerror=function(){return b.reject(Error("Failed to load bundle "+a))};document.head.appendChild(c);return b.g},Xi=function(a,b){if(Si.has(a))throw Error("Duplicate module "+a);Si.set(a,b);(a=Ti.get(a))&&a.resolve(b)};
Ri.prototype.handleEvent=function(a,b){for(var c=1;c<arguments.length;++c);throw Error("Not implemented");};
var gaa=new Map([["mr.cast.ChannelService","background_script.js"],["mr.cast.SinkDiscoveryService","background_script.js"],["mr.mirror.cast.Service","mirroring_cast_streaming.js"],["mr.cloud.slarti.SinkDiscoveryService","background_script.js"],["mr.cloud.discovery.WeaveSinkDiscoveryService","background_script.js"],["mr.mirror.hangouts.HangoutsService","mirroring_hangouts.js"],["mr.mirror.hangouts.MeetingsService","mirroring_hangouts.js"],["mr.ProviderManager","background_script.js"],["mr.mirror.webrtc.WebRtcService",
"mirroring_webrtc.js"]]),haa=new Set(["background_script.js"]),Wi=gb("mr.Module"),Si=new Map,Ti=new Map,Vi=new Map;var Yi,jaa={Zy:0,uw:1,vw:2,bx:3,gx:4,Hx:5,iy:6,Xy:7,Cz:8,Dz:9,MA:10,zB:11,AB:12,PB:13,eC:14},Zi=function(a){void 0==Yi&&(Bb("MediaRouter.Provider.WakeEvent",a,jaa),Yi=a)};var bj=function(a){return $i(a)||aj(a)},dj=function(a){try{var b=new URL(a);return"http:"!=b.protocol&&"https:"!=b.protocol?!1:-1==b.hash.indexOf("__castAppId__")}catch(c){return!1}},ej=["https://docs.google.com"],$i=function(a){return a.startsWith("urn:x-org.chromium.media:source:tab:")||-1!=a.indexOf("0F5096E8")},aj=function(a){return"urn:x-org.chromium.media:source:desktop"==a},kaa=function(a){var b=a.search("urn:x-org.chromium.media:source:tab:");return-1==b?null:parseInt(a.substr(b+36),10)||
null};var fj=function(a,b){this.ua=a;this.j=b||null;this.h=this.g=null;this.V=gb("mr.mirror.Service."+a);this.ia=this.ra.bind(this);this.C=!1};q(fj,Ri);h=fj.prototype;h.initialize=function(a,b){this.C||(this.j=a,this.C=!0,this.Og(b))};h.Og=function(){};h.getName=function(){return this.ua};
h.Yj=function(a,b,c,d,e){var f=this;this.V.info("Start mirroring on route "+a.id);if(!this.C)return Bi(Error("Not initialized"));var g=new Promise(function(k,m){f.o().then(function(){var p=gj(b,c,d);return(new Mi(p)).start()}).then(function(p){if(f.h)throw p.stop(),new Fi("Cannot start multiple streams");f.h=p;p=f.G.bind(f);f.h.qg=p;return e?e(a).g:a}).then(function(p){if(f.g)throw new Fi("Cannot start multiple sessions");if(!f.h)throw new Fi("Media stream ended before session could start.");f.g=
f.Oh(c,p);p.Db.Fc=f.g.Fc;p=f.j.pj.bind(f.j);f.g.J=p;hj(f.g);return f.g.start(f.h.h)}).then(function(){$i(b)&&!chrome.tabs.onUpdated.hasListener(f.ia)&&chrome.tabs.onUpdated.addListener(f.ia);return f.bd(a,b,c)}).then(function(){k(a)}).catch(function(p){ij(f,p);return f.G().then(function(){m(p)})})});return Ci(g)};h.Zj=function(a,b,c,d,e,f){this.V.info("Update mirroring on route "+a.id);return this.C?Ci(laa(this,a,b,c,d,f)):Bi(Error("Not initialized"))};
var laa=function(a,b,c,d,e,f){if(!a.g)return Promise.reject(new Fi("No session to update streams on",7));if(!a.g.Go())return Promise.reject(new Fi("Session does not support updating stream",7));var g=!1;return new Promise(function(k,m){var p=gj(c,d,e);(new Mi(p)).start().then(function(u){a.h&&(a.h.qg=null,a.h.stop(),a.vh());a.h=u;u=a.G.bind(a);a.h.qg=u;g=!0;return f?f(b).g:b}).then(function(){if(!a.g)throw new Fi("Session ended while updating stream");if(!a.h)throw new Fi("Media stream ended before session could be updated.");
return a.g.Lo(a.h.h)}).then(a.bd.bind(a,b,c,d)).then(function(){return k(b)}).catch(function(u){ij(a,u);if(g)return a.G().then(function(){m(u)});m(u)})})};
fj.prototype.bd=function(a,b,c){var d=this;return new Promise(function(e,f){if(d.g){$i(b)?(jj(d.g,a.Db.tabId),d.wh()):dj(b)?(jj(d.g,a.Db.tabId),d.ui()):d.th();f=d.h;var g=a.sinkId;c.shouldCaptureAudio&&f.h&&!f.h.getAudioTracks().length&&d.j.qf(xi(new si(ri,"notification"),g));hj(d.g);e()}else f(new Fi("Session gone before executing post-startup steps",7))})};
var ij=function(a,b){b.reason=null!=b.reason?b.reason:9;a.V.error("Failed to start mirroring: "+b.message+(",  reason = "+b.reason+": "+b.stack));a.rg(b.reason)};fj.prototype.o=function(){var a=this;return this.C?this.G().then(function(b){b&&a.uh();return b}):Promise.reject("Not initialized")};
fj.prototype.G=function(){var a=this;chrome.tabs.onUpdated.removeListener(this.ia);var b=this.h;this.h=null;b&&(b.qg=null);var c=this.g;this.g=null;var d;c?d=this.Si(c).catch(function(e){return a.V.error("Error in before-cleanup steps",e)}).then(function(){return c.stop()}).catch(function(e){return a.V.error("Error stopping session",e)}).then(function(){a.j.oi(c.h.id)}).catch(function(e){return a.V.error("Error in ended callbacks",e)}).then(function(){return!0}):d=Promise.resolve(!1);b&&(d=d.then(function(e){b.stop();
a.vh();return e}));return d};fj.prototype.Si=function(){return Promise.resolve()};fj.prototype.ra=function(a,b,c){Zi(14);this.g&&kj(this.g,a,b,c)};var gj=function(a,b,c){if($i(a))return new Ii("tab",b);if(aj(a))return new Ii("desktop",b);if(dj(a)){if(!c)throw new Fi("Missing offscreen tab presentation id");return new Ii("offscreen_tab",b,a,c)}throw new Fi("Source URN does not suggest a known capture type.");};h=fj.prototype;h.Oh=function(){};h.wh=function(){};h.th=function(){};h.ui=function(){};
h.uh=function(){};h.rg=function(){};h.vh=function(){};h.Xj=function(){return db()};h.createMediaRouteController=function(){return db()};var maa=function(a,b,c){this.h=a;this.l=b;this.g=void 0===c?null:c;this.j=null},lj=function(a){switch(a.h){case "mirror_tab":return a.g?"Casting tab ("+a.g+")":"Casting tab";case "mirror_desktop":return"Casting desktop";case "mirror_file":return"Casting local content";case "media_remoting":return a.g?"Casting media ("+a.g+")":"Casting media";case "presentation":return"Casting "+(a.g||"site");default:return""}},naa=function(a){if(a.l)return"Casting active";switch(a.h){case "mirror_tab":return"Casting tab";
case "mirror_desktop":return"Casting desktop";case "mirror_file":return"Casting local content";case "media_remoting":return"Casting media";case "presentation":return"Casting site";default:return""}};var oaa=function(a){return(new Promise(function(b){chrome.tabs.get(a,b)})).then(function(b){if(!b)throw Error("No such tab "+a);return b})};var mj=function(a,b){this.h=a;this.J=void 0===b?null:b;b=null;var c=a.mediaSource;if(dj(c)){var d="presentation";b=(new URL(c)).origin}else $i(c)?d="mirror_tab":aj(c)&&(d="mirror_desktop");this.Fc=new maa(d,a.offTheRecord,b);this.j=this.tabId=null;this.M=!1},jj=function(a,b){a.tabId!=b?(a.tabId=b,oaa(b).then(function(c){a.j=c;hj(a)})):Promise.resolve()},kj=function(a,b,c,d){b==a.tabId&&("complete"==c.status||c.favIconUrl&&"complete"==d.status)&&(a.j=d,hj(a))},hj=function(a){if(a.j){a.Fc.j=a.j.title;
a.Fc.l=a.j.incognito;var b=new URL(a.j.url);"file:"==b.protocol?(a.Fc.h="mirror_file",a.Fc.g=null):(a.Fc.h=a.M?"media_remoting":"mirror_tab",a.Fc.g="https:"==b.protocol?b.origin.substr(8):b.origin)}a.h.description=lj(a.Fc);a.J&&a.J(a.h,a.Fc);a.ho()};h=mj.prototype;h.start=function(){};h.Go=function(){return!1};h.Lo=function(){};h.stop=function(){return Promise.resolve()};h.ho=function(){};var qj=function(){var a=this;this.h=1920;this.g=1080;this.maxWidth=this.h;this.maxHeight=this.g;this.minHeight=this.minWidth=180;this.senderSideLetterboxing=!1;this.minFrameRate=0;this.maxFrameRate=30;this.minVideoBitrate=300;this.maxVideoBitrate=5E3;this.audioBitrate=0;this.animatedLatencyMillis=this.minLatencyMillis=this.maxLatencyMillis=400;this.dscpEnabled=["Mac","Linux","ChromeOS"].includes(Gi())||aaa();this.enableLogging=!0;this.useTdls=!1;this.shouldCaptureAudio=this.shouldCaptureVideo=!0;
var b=window.localStorage?window.localStorage.getItem(nj):null;if(b)try{var c=JSON.parse(String(b));if(c instanceof Object)oj(this,c),gb("mr.mirror.Settings").K(function(){return"Initial mr.mirror.Settings overridden to: "+pj(a)});else throw Error("localStorage["+nj+"] does not parse as an Object: "+b);}catch(d){throw gb("mr.mirror.Settings").error(nj+' must be of the form \'{"maxWidth":640, "maxHeight":360}\'.',d),Error("Overrides not parseable.  See ERROR log for details.");}};
qj.prototype.clone=function(){var a=new qj;oj(a,this);return a};
var pj=function(a){return JSON.stringify(a,function(b,c){if(0==b.length||!b.endsWith("_"))return c})},oj=function(a,b){for(var c=l(Object.keys(b)),d=c.next();!d.done;d=c.next())d=d.value,d.endsWith("_")||typeof b[d]!==typeof a[d]||(a[d]=b[d])},rj=function(a){var b=Math.round(screen.width*window.devicePixelRatio),c=Math.round(screen.height*window.devicePixelRatio);c>b&&(c=l([c,b]),b=c.next().value,c=c.next().value);a.maxHeight*b<a.maxWidth*c?(b=Math.min(a.maxWidth,b),b-=b%160,c=90*b/160):(c=Math.min(a.maxHeight,
c),c-=c%90,b=160*c/90);if(b<Math.max(160,a.minWidth)||c<Math.max(90,a.minHeight))b=Math.max(160,a.minWidth),c=Math.max(90,a.minHeight);a.maxWidth=b;a.maxHeight=c},nj="mr.mirror.Settings.Overrides";var sj=function(a,b){this.type=a;this.data=b},tj=function(a){a=JSON.parse(a);if(!a.type)throw Error("Invalid message");return new sj(a.type,a.data)},uj=function(a,b,c,d,e){this.description=a;this.settings=b||null;this.mediaConstraints=c||null;this.presentationUrl=d||null;this.presentationId=e||null};var wj=function(a,b){this.s=gb("cv2.PeerConnection");this.J=vj;this.la=paa(this,b);this.l=this.la.createDataChannel(a,{reliable:!1});this.H=new Cb;this.o=!1;this.j=0;this.h=null;this.u=this.m=0;this.g=!1;this.G=function(){};this.D=function(){};this.C=function(){};this.F=function(){}},xj=function(a,b){a.D=b},yj=function(a,b){a.C=b},zj=function(a,b){a.F=b},Aj=function(a,b){a.G=b},Bj=function(a,b){a.l.onmessage=function(c){b(c.data)}},qaa=function(a){var b={};b.iceServers=[{url:"stun:stun.l.google.com:19302"}].concat(a);
return b},paa=function(a,b){var c=qaa(b);b=new webkitRTCPeerConnection(c);b.onicecandidate=a.L.bind(a);b.onicegatheringstatechange=a.W.bind(a);b.oniceconnectionstatechange=a.N.bind(a);a.s.info(function(){return"Created webkitRTCPeerConnnection with config: "+JSON.stringify(c)});return b};wj.prototype.start=function(){this.g||(this.g=!0,raa(this))};wj.prototype.stop=function(){this.s.info("Stopping peer connection...");this.g&&(this.g=!1,"closed"!=this.la.signalingState&&this.la.close());this.la=null};
var raa=function(a){a.s.info("Sending offer to peer.");a.m=Date.now();a.la.createOffer(a.M.bind(a),function(b){a.s.K("Error creating offer.",b)},a.J);a.H.g.then(function(b){a.G(b)})};wj.prototype.M=function(a){var b=this;this.s.info(function(){return"Setting local description: "+JSON.stringify(a)});this.la.setLocalDescription(a,function(){b.s.info("Local description set successfully")},function(c){b.s.K("Error setting local description.",c)})};
var Cj=function(a,b){nb(a.s,function(){return"<===: "+JSON.stringify(b)});var c=new RTCSessionDescription(b);a.s.info(function(){return"Setting remote description: "+JSON.stringify(c)});a.la.setRemoteDescription(c,function(){a.s.info("Remote description set successfully.")},function(d){a.s.K("Error setting remote description.",d)})};
wj.prototype.L=function(a){var b=this;a.candidate?(this.j++,this.u=Date.now(),1==this.j?this.h=setTimeout(function(){b.s.info("ICE candidate gathering timed out.");b.h=null;Dj(b)},5E3):this.o&&this.s.K("Received ICE candidate after resolving session description.")):(this.s.info("End of ICE candidates."),tb("MediaRouter.WebRtc.IceCandidateGathering.Duration.Reported",Date.now()-this.m),Dj(this),0<this.j&&tb("MediaRouter.WebRtc.IceCandidateGathering.Duration.Real",this.u-this.m))};
wj.prototype.W=function(){"completed"==this.la.iceGatheringState&&Dj(this)};var Dj=function(a){clearTimeout(a.h);a.h=null;if(!a.o){a.s.info("Resolving sesion description after gathering "+a.j+" ICE candidates.");var b=a.la.localDescription;a.H.resolve({type:b.type,sdp:b.sdp});a.o=!0}};
wj.prototype.N=function(a){var b=this;if(this.la){var c=this.la.iceConnectionState;this.s.info("New ICE connection state: "+c+".");"connected"==c?this.D("iceconnected"):"completed"==c?this.D("icecompleted"):"failed"==c?(this.s.K(function(){return"Ice connection failed: "+JSON.stringify(a)}),this.C("icefailed")):"closed"==c?this.F("iceclosed"):"disconnected"==c&&(this.s.K("Ice connection state is bad."),this.g&&(this.s.info("Restarting ICE."),this.la.createOffer(this.M.bind(this),function(d){b.s.K("Error creating new offer.",
d)},saa)))}};var vj={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},saa={mandatory:{IceRestart:!0,OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};var Ej=function(){var a=window.crypto.getRandomValues(new Uint8Array(16));return Nb(a,function(b){b=b.toString(16);return 1<b.length?b:"0"+b}).join("")},Fj=function(a){for(var b=[],c=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);128>e?b[c++]=e:(2048>e?b[c++]=e>>6|192:(55296==(e&64512)&&d+1<a.length&&56320==(a.charCodeAt(d+1)&64512)?(e=65536+((e&1023)<<10)+(a.charCodeAt(++d)&1023),b[c++]=e>>18|240,b[c++]=e>>12&63|128):b[c++]=e>>12|224,b[c++]=e>>6&63|128),b[c++]=e&63|128)}return b},Gj=function(a){for(var b=
[],c=0,d=0;c<a.length;){var e=a[c++];if(128>e)b[d++]=String.fromCharCode(e);else if(191<e&&224>e){var f=a[c++];b[d++]=String.fromCharCode((e&31)<<6|f&63)}else if(239<e&&365>e){f=a[c++];var g=a[c++],k=a[c++];e=((e&7)<<18|(f&63)<<12|(g&63)<<6|k&63)-65536;b[d++]=String.fromCharCode(55296+(e>>10));b[d++]=String.fromCharCode(56320+(e&1023))}else f=a[c++],g=a[c++],b[d++]=String.fromCharCode((e&15)<<12|(f&63)<<6|g&63)}return b.join("")};var Hj={},Ij=null,Kj=function(a){var b;void 0===b&&(b=0);Jj();b=Hj[b];for(var c=[],d=0;d<a.length;d+=3){var e=a[d],f=d+1<a.length,g=f?a[d+1]:0,k=d+2<a.length,m=k?a[d+2]:0,p=e>>2;e=(e&3)<<4|g>>4;g=(g&15)<<2|m>>6;m&=63;k||(m=64,f||(g=64));c.push(b[p],b[e],b[g]||"",b[m]||"")}return c.join("")},Lj=function(a){var b=a.length,c=3*b/4;c%3?c=Math.floor(c):-1!="=.".indexOf(a[b-1])&&(c=-1!="=.".indexOf(a[b-2])?c-2:c-1);var d=new Uint8Array(c),e=0;taa(a,function(f){d[e++]=f});return d.subarray(0,e)},taa=function(a,
b){function c(m){for(;d<a.length;){var p=a.charAt(d++),u=Ij[p];if(null!=u)return u;if(!ld(p))throw Error("Unknown base64 encoding at char: "+p);}return m}Jj();for(var d=0;;){var e=c(-1),f=c(0),g=c(64),k=c(64);if(64===k&&-1===e)break;b(e<<2|f>>4);64!=g&&(b(f<<4&240|g>>2),64!=k&&b(g<<6&192|k))}},Jj=function(){if(!Ij){Ij={};for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),b=["+/=","+/","-_=","-_.","-_"],c=0;5>c;c++){var d=a.concat(b[c].split(""));Hj[c]=d;for(var e=
0;e<d.length;e++){var f=d[e];void 0===Ij[f]&&(Ij[f]=e)}}}};var Mj=0,Nj=0,Oj=function(a){var b=0>a;a=Math.abs(a);var c=a>>>0;a=Math.floor((a-c)/4294967296);a>>>=0;b&&(a=~a>>>0,c=(~c>>>0)+1,4294967295<c&&(c=0,a++,4294967295<a&&(a=0)));Mj=c;Nj=a},Pj=function(a){var b=0>a?1:0;a=b?-a:a;if(0===a)0<1/a?Mj=Nj=0:(Nj=0,Mj=2147483648);else if(isNaN(a))Nj=0,Mj=2147483647;else if(3.4028234663852886E38<a)Nj=0,Mj=(b<<31|2139095040)>>>0;else if(1.1754943508222875E-38>a)a=Math.round(a/Math.pow(2,-149)),Nj=0,Mj=(b<<31|a)>>>0;else{var c=Math.floor(Math.log(a)/Math.LN2);a*=
Math.pow(2,-c);a=Math.round(8388608*a)&8388607;Nj=0;Mj=(b<<31|c+127<<23|a)>>>0}},Qj=function(a,b){return 4294967296*b+(a>>>0)},Rj=function(a,b){var c=b&2147483648;c&&(a=~a+1>>>0,b=~b>>>0,0==a&&(b=b+1>>>0));a=Qj(a,b);return c?-a:a},uaa=function(a,b){function c(e,f){e=e?String(e):"";return f?"0000000".slice(e.length)+e:e}if(2097151>=b)return""+(4294967296*b+a);var d=(a>>>24|b<<8)>>>0&16777215;b=b>>16&65535;a=(a&16777215)+6777216*d+6710656*b;d+=8147497*b;b*=2;1E7<=a&&(d+=Math.floor(a/1E7),a%=1E7);1E7<=
d&&(b+=Math.floor(d/1E7),d%=1E7);return c(b,0)+c(d,b)+c(a,1)},vaa=function(a,b){var c=b&2147483648;c&&(a=~a+1>>>0,b=~b+(0==a?1:0)>>>0);a=uaa(a,b);return c?"-"+a:a},Sj=function(a){if(a.constructor===Uint8Array)return a;if(a.constructor===ArrayBuffer)return new Uint8Array(a);if(a.constructor===Array)return new Uint8Array(a);if(a.constructor===String)return Lj(a);Gb("Type not convertible to Uint8Array.");return new Uint8Array(0)};var Uj=function(a,b,c){this.h=null;this.g=this.j=this.m=0;this.o=!1;a&&Tj(this,a,b,c)},Vj=[],Wj=function(a,b,c){if(Vj.length){var d=Vj.pop();a&&Tj(d,a,b,c);return d}return new Uj(a,b,c)};Uj.prototype.clone=function(){return Wj(this.h,this.m,this.j-this.m)};Uj.prototype.clear=function(){this.h=null;this.g=this.j=this.m=0;this.o=!1};var Tj=function(a,b,c,d){a.h=Sj(b);a.m=void 0!==c?c:0;a.j=void 0!==d?a.m+d:a.h.length;a.g=a.m};Uj.prototype.reset=function(){this.g=this.m};
var Xj=function(a,b){for(var c=128,d=0,e=0,f=0;4>f&&128<=c;f++)c=a.h[a.g++],d|=(c&127)<<7*f;128<=c&&(c=a.h[a.g++],d|=(c&127)<<28,e|=(c&127)>>4);if(128<=c)for(f=0;5>f&&128<=c;f++)c=a.h[a.g++],e|=(c&127)<<7*f+3;if(128>c)return b(d>>>0,e>>>0);Gb("Failed to read varint, encoding is invalid.");a.o=!0};
Uj.prototype.l=function(){var a=this.h;var b=a[this.g+0];var c=b&127;if(128>b)return this.g+=1,c;b=a[this.g+1];c|=(b&127)<<7;if(128>b)return this.g+=2,c;b=a[this.g+2];c|=(b&127)<<14;if(128>b)return this.g+=3,c;b=a[this.g+3];c|=(b&127)<<21;if(128>b)return this.g+=4,c;b=a[this.g+4];c|=(b&15)<<28;if(128>b)return this.g+=5,c>>>0;this.g+=5;128<=a[this.g++]&&128<=a[this.g++]&&128<=a[this.g++]&&128<=a[this.g++]&&this.g++;return c};Uj.prototype.D=Uj.prototype.l;
var Yj=function(a){var b=a.h[a.g+0];var c=a.h[a.g+1];var d=a.h[a.g+2],e=a.h[a.g+3];a.g+=4;c=(b<<0|c<<8|d<<16|e<<24)>>>0;a=2*(c>>31)+1;b=c>>>23&255;c&=8388607;return 255==b?c?NaN:Infinity*a:0==b?a*Math.pow(2,-149)*c:a*Math.pow(2,b-150)*(c+Math.pow(2,23))};Uj.prototype.u=function(){return this.D()};var Zj=function(a){this.g=Wj(a,void 0,void 0);this.D=this.g.g;this.l=this.h=-1;this.m=!1},ak=function(a){return 4==a.l};Zj.prototype.reset=function(){this.g.reset();this.l=this.h=-1};
var bk=function(a){var b=a.g;if(b.g==b.j)return!1;(b=a.m)||(b=a.g,b=b.o||0>b.g||b.g>b.j);if(b)return Gb("Decoder hit an error"),!1;a.D=a.g.g;var c=a.g.l();b=c>>>3;c&=7;if(0!=c&&5!=c&&1!=c&&2!=c&&3!=c&&4!=c)return Gb("Invalid wire type: %s (at position %s)",c,a.D),a.m=!0,!1;a.h=b;a.l=c;return!0},ck=function(a){switch(a.l){case 0:if(0!=a.l)Gb("Invalid wire type for skipVarintField"),ck(a);else{for(a=a.g;a.h[a.g]&128;)a.g++;a.g++}break;case 1:1!=a.l?(Gb("Invalid wire type for skipFixed64Field"),ck(a)):
(a=a.g,a.g+=8);break;case 2:if(2!=a.l)Gb("Invalid wire type for skipDelimitedField"),ck(a);else{var b=a.g.l();a=a.g;a.g+=b}break;case 5:5!=a.l?(Gb("Invalid wire type for skipFixed32Field"),ck(a)):(a=a.g,a.g+=4);break;case 3:b=a.h;do{if(!bk(a)){Gb("Unmatched start-group tag: stream EOF");a.m=!0;break}if(4==a.l){a.h!=b&&(Gb("Unmatched end-group tag"),a.m=!0);break}ck(a)}while(1);break;default:Gb("Invalid wire encoding for field.")}};
Zj.prototype.j=function(a,b){var c=this.g.j,d=this.g.l();d=this.g.g+d;this.g.j=d;b(a,this);this.g.g=d;this.g.j=c};
var dk=function(a){return!!a.g.l()},ek=function(a){return Xj(a.g,Rj)},fk=function(a){var b=a.g.l();a=a.g;var c=a.h,d=a.g,e=d+b,f=[];for(b="";d<e;){var g=c[d++];if(128>g)f.push(g);else if(192>g)continue;else if(224>g){var k=c[d++];f.push((g&31)<<6|k&63)}else if(240>g){k=c[d++];var m=c[d++];f.push((g&15)<<12|(k&63)<<6|m&63)}else if(248>g){k=c[d++];m=c[d++];var p=c[d++];g=(g&7)<<18|(k&63)<<12|(m&63)<<6|p&63;g-=65536;f.push((g>>10&1023)+55296,(g&1023)+56320)}8192<=f.length&&(b+=String.fromCharCode.apply(null,
f),f.length=0)}if(8192>=f.length)f=String.fromCharCode.apply(null,f);else{c="";for(e=0;e<f.length;e+=8192)c+=String.fromCharCode.apply(null,hc(f,e,e+8192));f=c}a.g=d;return b+f},gk=function(a,b){var c=a.g.l();c=a.g.g+c;for(var d=[];a.g.g<c;)d.push(b.call(a.g));return d};var hk=function(a,b){this.g=a;this.h=b},ik=function(a){return new hk((a.g>>>1|(a.h&1)<<31)>>>0,a.h>>>1>>>0)},jk=function(a){return new hk(a.g<<1>>>0,(a.h<<1|a.g>>>31)>>>0)};hk.prototype.add=function(a){return new hk((this.g+a.g&4294967295)>>>0>>>0,((this.h+a.h&4294967295)>>>0)+(4294967296<=this.g+a.g?1:0)>>>0)};hk.prototype.sub=function(a){return new hk((this.g-a.g&4294967295)>>>0>>>0,((this.h-a.h&4294967295)>>>0)-(0>this.g-a.g?1:0)>>>0)};
var kk=function(a){var b=a&65535,c=a>>>16;a=10*b+65536*(0*b&65535)+65536*(10*c&65535);for(b=0*c+(0*b>>>16)+(10*c>>>16);4294967296<=a;)a-=4294967296,b+=1;return new hk(a>>>0,b>>>0)};
hk.prototype.toString=function(){for(var a="",b=this;0!=b.g||0!=b.h;){var c=new hk(0,0);b=new hk(b.g,b.h);for(var d=new hk(10,0),e=new hk(1,0);!(d.h&2147483648);)d=jk(d),e=jk(e);for(;0!=e.g||0!=e.h;)0>=(d.h<b.h||d.h==b.h&&d.g<b.g?-1:d.h==b.h&&d.g==b.g?0:1)&&(c=c.add(e),b=b.sub(d)),d=ik(d),e=ik(e);c=[c,b];b=c[0];a=c[1].g+a}""==a&&(a="0");return a};
var lk=function(a){for(var b=new hk(0,0),c=new hk(0,0),d=0;d<a.length;d++){if("0">a[d]||"9"<a[d])return null;c.g=parseInt(a[d],10);var e=kk(b.g);b=kk(b.h);b.h=b.g;b.g=0;b=e.add(b).add(c)}return b};hk.prototype.clone=function(){return new hk(this.g,this.h)};var mk=function(a,b){this.g=a;this.h=b};mk.prototype.add=function(a){return new mk((this.g+a.g&4294967295)>>>0>>>0,((this.h+a.h&4294967295)>>>0)+(4294967296<=this.g+a.g?1:0)>>>0)};
mk.prototype.sub=function(a){return new mk((this.g-a.g&4294967295)>>>0>>>0,((this.h-a.h&4294967295)>>>0)-(0>this.g-a.g?1:0)>>>0)};mk.prototype.clone=function(){return new mk(this.g,this.h)};mk.prototype.toString=function(){var a=0!=(this.h&2147483648),b=new hk(this.g,this.h);a&&(b=(new hk(0,0)).sub(b));return(a?"-":"")+b.toString()};var nk=function(){this.g=[]};nk.prototype.length=function(){return this.g.length};nk.prototype.end=function(){var a=this.g;this.g=[];return a};
var ok=function(a,b,c){for(;0<c||127<b;)a.g.push(b&127|128),b=(b>>>7|c<<25)>>>0,c>>>=7;a.g.push(b)},pk=function(a,b){for(;127<b;)a.g.push(b&127|128),b>>>=7;a.g.push(b)},qk=function(a,b){if(0<=b)pk(a,b);else{for(var c=0;9>c;c++)a.g.push(b&127|128),b>>=7;a.g.push(1)}},rk=function(a,b){a.g.push(b>>>0&255);a.g.push(b>>>8&255);a.g.push(b>>>16&255);a.g.push(b>>>24&255)};var z=function(){this.D=[];this.m=0;this.j=new nk;this.o=[]},tk=function(a,b){sk(a,b,2);b=a.j.end();a.D.push(b);a.m+=b.length;b.push(a.m);return b},uk=function(a,b){var c=b.pop();for(c=a.m+a.j.length()-c;127<c;)b.push(c&127|128),c>>>=7,a.m++;b.push(c);a.m++};z.prototype.reset=function(){this.D=[];this.j.end();this.m=0;this.o=[]};
var B=function(a){for(var b=new Uint8Array(a.m+a.j.length()),c=a.D,d=c.length,e=0,f=0;f<d;f++){var g=c[f];b.set(g,e);e+=g.length}c=a.j.end();b.set(c,e);a.D=[b];return b},sk=function(a,b,c){pk(a.j,8*b+c)};z.prototype.h=function(a,b){null!=b&&null!=b&&(sk(this,a,0),qk(this.j,b))};
var C=function(a,b,c){null!=c&&null!=c&&(sk(a,b,0),a=a.j,Oj(c),ok(a,Mj,Nj))},vk=function(a,b,c){if(null!=c){var d=c;(c=0<d.length&&"-"==d[0])&&(d=d.substring(1));d=lk(d);null===d?c=null:(c&&(d=(new hk(0,0)).sub(d)),c=new mk(d.g,d.h));sk(a,b,0);ok(a.j,c.g,c.h)}};z.prototype.l=function(a,b){null!=b&&null!=b&&(sk(this,a,0),pk(this.j,b))};
var wk=function(a,b,c){null!=c&&null!=c&&(sk(a,b,0),a=a.j,Oj(c),ok(a,Mj,Nj))},xk=function(a,b,c){null!=c&&(c=lk(c),sk(a,b,0),ok(a.j,c.g,c.h))},yk=function(a,b,c){null!=c&&(sk(a,b,5),rk(a.j,c))},zk=function(a,b,c){null!=c&&(sk(a,b,5),a=a.j,Pj(c),rk(a,Mj))},Ak=function(a,b,c){if(null!=c){sk(a,b,1);a=a.j;var d=c;d=(c=0>d?1:0)?-d:d;if(0===d)Nj=0<1/d?0:2147483648,Mj=0;else if(isNaN(d))Nj=2147483647,Mj=4294967295;else if(1.7976931348623157E308<d)Nj=(c<<31|2146435072)>>>0,Mj=0;else if(2.2250738585072014E-308>
d)d/=Math.pow(2,-1074),Nj=(c<<31|d/4294967296)>>>0,Mj=d>>>0;else{var e=d;b=0;if(2<=e)for(;2<=e&&1023>b;)b++,e/=2;else for(;1>e&&-1022<b;)e*=2,b--;d*=Math.pow(2,-b);Nj=(c<<31|b+1023<<20|1048576*d&1048575)>>>0;Mj=4503599627370496*d>>>0}rk(a,Mj);rk(a,Nj)}},D=function(a,b,c){null!=c&&(sk(a,b,0),a.j.g.push(c?1:0))},G=function(a,b,c){null!=c&&(sk(a,b,0),qk(a.j,c))},H=function(a,b,c){if(null!=c){b=tk(a,b);for(var d=a.j,e=0;e<c.length;e++){var f=c.charCodeAt(e);if(128>f)d.g.push(f);else if(2048>f)d.g.push(f>>
6|192),d.g.push(f&63|128);else if(65536>f)if(55296<=f&&56319>=f&&e+1<c.length){var g=c.charCodeAt(e+1);56320<=g&&57343>=g&&(f=1024*(f-55296)+g-56320+65536,d.g.push(f>>18|240),d.g.push(f>>12&63|128),d.g.push(f>>6&63|128),d.g.push(f&63|128),e++)}else d.g.push(f>>12|224),d.g.push(f>>6&63|128),d.g.push(f&63|128)}uk(a,b)}},Bk=function(a,b,c){null!=c&&(c=Sj(c),sk(a,b,2),pk(a.j,c.length),b=a.j.end(),a.D.push(b),a.D.push(c),a.m+=b.length+c.length)};
z.prototype.g=function(a,b,c){null!=b&&(a=tk(this,a),c(b,this),uk(this,a))};
var Ck=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++){var e=a,f=c[d];null!=f&&(sk(e,b,0),qk(e.j,f))}},Dk=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++){var e=a,f=c[d];null!=f&&(sk(e,b,0),e=e.j,Oj(f),ok(e,Mj,Nj))}},Ek=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++){var e=a,f=c[d];null!=f&&(sk(e,b,0),pk(e.j,f))}},Fk=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++)yk(a,b,c[d])},Gk=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++)G(a,b,c[d])},Hk=function(a,b,c){if(null!=
c)for(var d=0;d<c.length;d++)H(a,b,c[d])},Ik=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++)Bk(a,b,c[d])},I=function(a,b,c,d){if(null!=c)for(var e=0;e<c.length;e++){var f=tk(a,b);d(c[e],a);uk(a,f)}},Jk=function(a,b,c,d){if(null!=c)for(var e=0;e<c.length;e++)sk(a,b,3),d(c[e],a),sk(a,b,4)},Kk=function(a,b,c){if(null!=c&&c.length){b=tk(a,b);for(var d=0;d<c.length;d++)qk(a.j,c[d]);uk(a,b)}},Lk=function(a,b,c){if(null!=c&&c.length)for(sk(a,b,2),pk(a.j,4*c.length),b=0;b<c.length;b++){var d=a.j;Pj(c[b]);
rk(d,Mj)}},Mk=function(a,b,c){if(null!=c&&c.length){b=tk(a,b);for(var d=0;d<c.length;d++)qk(a.j,c[d]);uk(a,b)}};var Ok=function(a){this.h=a;this.g={};this.j=!0;if(0<this.h.length){for(a=0;a<this.h.length;a++){var b=this.h[a],c=b[0];this.g[c.toString()]=new Nk(c,b[1])}this.j=!0}};Ok.prototype.xc=function(){var a;if(!this.j){this.h.length=0;var b=Pk(this);b.sort();for(var c=0;c<b.length;c++){var d=this.g[b[c]];(a=d.g)&&a.xc();this.h.push([d.key,d.value])}this.j=!0}return this.h};var Qk=function(a){this.g=0;this.h=a};
Qk.prototype.next=function(){return this.g<this.h.length?{done:!1,value:this.h[this.g++]}:{done:!0,value:void 0}};"undefined"!=typeof Symbol&&(Qk.prototype[Symbol.iterator]=function(){return this});h=Ok.prototype;h.clear=function(){this.g={};this.j=!1};h.entries=function(){var a=[],b=Pk(this);b.sort();for(var c=0;c<b.length;c++){var d=this.g[b[c]];a.push([d.key,d.value])}return new Qk(a)};h.keys=function(){var a=[],b=Pk(this);b.sort();for(var c=0;c<b.length;c++)a.push(this.g[b[c]].key);return new Qk(a)};
h.values=function(){var a=[],b=Pk(this);b.sort();for(var c=0;c<b.length;c++)a.push(this.g[b[c]].value);return new Qk(a)};h.forEach=function(a,b){var c=Pk(this);c.sort();for(var d=0;d<c.length;d++){var e=this.g[c[d]];a.call(b,e.value,e.key,this)}};h.set=function(a,b){var c=new Nk(a);c.value=b;this.g[a.toString()]=c;this.j=!1;return this};h.get=function(a){if(a=this.g[a.toString()])return a.value};h.has=function(a){return a.toString()in this.g};
h.w=function(a,b,c,d){var e=Pk(this);e.sort();for(var f=0;f<e.length;f++){var g=this.g[e[f]];b.o.push(tk(b,a));c.call(b,1,g.key);d.call(b,2,g.value);uk(b,b.o.pop())}};var Pk=function(a){a=a.g;var b=[],c;for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b},Nk=function(a,b){this.key=a;this.value=b;this.g=void 0};var K=function(){},Rk="function"==typeof Uint8Array,L=function(a,b,c,d,e,f){a.g=null;b||(b=c?[c]:[]);a.df=c?String(c):void 0;a.m=0===c?-1:0;a.h=b;a:{c=a.h.length;b=-1;if(c&&(b=c-1,c=a.h[b],!(null===c||"object"!=typeof c||Sa(c)||Rk&&c instanceof Uint8Array))){a.o=b-a.m;a.j=c;break a}-1<d?(a.o=Math.max(d,b+1-a.m),a.j=null):a.o=Number.MAX_VALUE}a.F={};if(e)for(d=0;d<e.length;d++)b=e[d],b<a.o?(b+=a.m,a.h[b]=a.h[b]||Sk):(Tk(a),a.j[b]=a.j[b]||Sk);if(f&&f.length)for(d=0;d<f.length;d++)Uk(a,f[d])},Sk=Object.freeze?
Object.freeze([]):[],Tk=function(a){var b=a.o+a.m;a.h[b]||(a.j=a.h[b]={})},Vk=function(a,b,c,d){for(var e in c){var f=c[e],g=f.zr;if(!f.Ui)throw Error("Message extension present that was generated without binary serialization support");var k=d.call(a,g);if(null!=k)if(g.Qd)if(f.cm)f.Ui.call(b,g.pm,k,f.cm);else throw Error("Message extension present holding submessage without binary support enabled, and message is being serialized to binary format");else f.Ui.call(b,g.pm,k)}},M=function(a,b){if(b<a.o){b+=
a.m;var c=a.h[b];return c===Sk?a.h[b]=[]:c}if(a.j)return c=a.j[b],c===Sk?a.j[b]=[]:c},Wk=function(a,b){a=M(a,b);return null==a?a:+a},Xk=function(a,b){a=M(a,b);return null==a?a:!!a},Yk=function(a,b){var c=M(a,b);a.F||(a.F={});if(!a.F[b]){for(var d=0;d<c.length;d++)c[d]=+c[d];a.F[b]=!0}return c},Zk=function(a){if(null==a||a instanceof Uint8Array)return a;if("string"===typeof a)return Lj(a);Gb("Cannot coerce to Uint8Array: "+Qa(a));return null},$k=function(a){waa(a);return!a.length||a[0]instanceof Uint8Array?
a:Nb(a,Zk)},waa=function(a){if(a&&1<a.length){var b=Qa(a[0]);Kb(a,function(c){Qa(c)!=b&&Gb("Inconsistent type in JSPB repeated field array. Got "+Qa(c)+" expected "+b)})}},N=function(a,b,c){a=M(a,b);return null==a?c:a},al=function(a,b,c){a=Xk(a,b);return null==a?c:a},bl=function(a,b){a=Wk(a,b);return null==a?0:a},O=function(a,b,c){b<a.o?a.h[b+a.m]=c:(Tk(a),a.j[b]=c);return a},P=function(a,b,c){return cl(a,b,c,"")},dl=function(a,b,c){cl(a,b,c,0)},cl=function(a,b,c,d){c!==d?O(a,b,c):a.h[b+a.m]=null;
return a},Uk=function(a,b){for(var c,d,e=0;e<b.length;e++){var f=b[e],g=M(a,f);null!=g&&(c=f,d=g,O(a,f,void 0))}return c?(O(a,c,d),c):0},Q=function(a,b,c,d){a.g||(a.g={});if(!a.g[c]){var e=M(a,c);if(d||e)a.g[c]=new b(e)}return a.g[c]},R=function(a,b,c){el(a,b,c);b=a.g[c];b==Sk&&(b=a.g[c]=[]);return b},el=function(a,b,c){a.g||(a.g={});if(!a.g[c]){for(var d=M(a,c),e=[],f=0;f<d.length;f++)e[f]=new b(d[f]);a.g[c]=e}},T=function(a,b,c){a.g||(a.g={});var d=c?c.xc():c;a.g[b]=c;return O(a,b,d)},gl=function(a,
b,c){var d=fl[0];a.g||(a.g={});var e=c?c.xc():c;a.g[b]=c;(c=Uk(a,d))&&c!==b&&void 0!==e&&(a.g&&c in a.g&&(a.g[c]=void 0),O(a,c,void 0));O(a,b,e)},hl=function(a,b,c){a.g||(a.g={});c=c||[];for(var d=[],e=0;e<c.length;e++)d[e]=c[e].xc();a.g[b]=c;return O(a,b,d)},il=function(a,b,c,d,e){el(a,d,b);var f=a.g[b];f||(f=a.g[b]=[]);c=c?c:new d;a=M(a,b);void 0!=e?(f.splice(e,0,c),a.splice(e,0,c.xc())):(f.push(c),a.push(c.xc()));return c},jl=function(a){if(a.g)for(var b in a.g){var c=a.g[b];if(Sa(c))for(var d=
0;d<c.length;d++)c[d]&&c[d].xc();else c&&c.xc()}};K.prototype.xc=function(){jl(this);return this.h};K.prototype.Aa=Rk?function(){var a=Uint8Array.prototype.toJSON;Uint8Array.prototype.toJSON=function(){return Kj(this)};try{return JSON.stringify(this.h&&this.xc(),kl)}finally{Uint8Array.prototype.toJSON=a}}:function(){return JSON.stringify(this.h&&this.xc(),kl)};var kl=function(a,b){return"number"!==typeof b||!isNaN(b)&&Infinity!==b&&-Infinity!==b?b:String(b)};
K.prototype.toString=function(){jl(this);return this.h.toString()};K.prototype.D=function(a){if(this.j)return this.g||(this.g={}),a.Qd?(!this.g[175237375]&&this.j[175237375]&&(this.g[175237375]=new a.Qd(this.j[175237375])),this.g[175237375]):this.j[175237375]};
var ml=function(a,b){a=a||{};b=b||{};var c={},d;for(d in a)c[d]=0;for(d in b)c[d]=0;for(d in c)if(!ll(a[d],b[d]))return!1;return!0},ll=function(a,b){if(a==b)return!0;if(!Va(a)||!Va(b))return"number"===typeof a&&isNaN(a)||"number"===typeof b&&isNaN(b)?String(a)==String(b):!1;if(a.constructor!=b.constructor)return!1;if(Rk&&a.constructor===Uint8Array){if(a.length!=b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!=b[c])return!1;return!0}if(a.constructor===Array){var d=void 0,e=void 0,f=Math.max(a.length,
b.length);for(c=0;c<f;c++){var g=a[c],k=b[c];g&&g.constructor==Object&&(d=g,g=void 0);k&&k.constructor==Object&&(e=k,k=void 0);if(!ll(g,k))return!1}return d||e?(d=d||{},e=e||{},ml(d,e)):!0}if(a.constructor===Object)return ml(a,b);throw Error("Invalid type in JSPB array");};K.prototype.clone=function(){return nl(this)};
var nl=function(a){return new a.constructor(ol(a.xc()))},ol=function(a){if(Sa(a)){for(var b=Array(a.length),c=0;c<a.length;c++){var d=a[c];null!=d&&(b[c]="object"==typeof d?ol(d):d)}return b}if(Rk&&a instanceof Uint8Array)return new Uint8Array(a);b={};for(c in a)d=a[c],null!=d&&(b[c]="object"==typeof d?ol(d):d);return b};var pl=function(a){L(this,a,0,-1,null,null)};w(pl,K);var ql=function(a){L(this,a,0,-1,null,null)};w(ql,K);var yaa=function(a,b){for(;bk(b)&&!ak(b);)switch(b.h){case 1:var c=Xj(b.g,Rj);O(a,1,c);break;case 2:c=fk(b);O(a,2,c);break;case 3:c=new ql;b.j(c,xaa);T(a,3,c);break;default:ck(b)}return a};pl.prototype.w=function(){var a=new z;rl(this,a);return B(a)};
var rl=function(a,b){var c=M(a,1);null!=c&&C(b,1,c);c=M(a,2);null!=c&&H(b,2,c);c=Q(a,ql,3);null!=c&&b.g(3,c,sl)},xaa=function(a,b){for(;bk(b)&&!ak(b);)switch(b.h){case 1:var c=fk(b);O(a,1,c);break;case 2:c=Xj(b.g,Rj);O(a,2,c);break;default:ck(b)}return a};ql.prototype.w=function(){var a=new z;sl(this,a);return B(a)};var sl=function(a,b){var c=M(a,1);null!=c&&H(b,1,c);c=M(a,2);null!=c&&C(b,2,c)};pl.prototype.Rb=function(){return M(this,1)};var tl=function(a,b){this.type="cast_app";this.originId=window["castApp.eventPage.Message.OriginID"]||void 0;this.subtype=a;this.devices=b;this.logRecord=this.deviceJustSetUp=void 0};v("castApp.eventPage.Message",tl);var ul=function(a,b,c){this.ipAddress=a;this.appId=b;this.sessionId=c};tl.DeviceData=ul;tl.DeviceJustSetUp=function(a,b,c,d){this.ipAddress=a;this.name=b;this.udn=c;this.modelName=d};tl.DeviceCapabilities=function(){};
tl.LogRecord=function(a,b,c,d){this.levelValue=a;this.msg=b;this.loggerName=c;this.time=d};var vl=function(a,b){this.type=a;this.entryPoint=b};v("castApp.frontEnd.ExtensionMessage",vl);var wl=function(a){return"urn:x-cast:com.google.cast."+a},xl=wl("tp.connection"),yl=wl("receiver"),zl=wl("remoting"),Al=wl("media"),Bl=wl("webrtc"),Cl=wl("broadcast"),Dl=Oc({kC:xl,lC:wl("tp.heartbeat"),UA:yl,ZA:zl,Yy:Al,bz:wl("media.universalRemote.optIn"),SC:Bl,cw:Cl});var El=function(a){return"available"==a||"available_rescan"==a};var Fl=function(a,b,c,d,e){this.id=a;this.friendlyName=b;this.iconType=c||"generic";this.description=void 0===d?null:d;this.domain=void 0===e?null:e};var Gl=window.localStorage,Hl=0,Jl=function(a){return(a=window.localStorage.getItem(Il(a,!1)))?JSON.parse(a):null},Kl=function(a){return(a=window.localStorage.getItem(Il(a,!0)))?JSON.parse(a):null},Ml=function(a){if(Ll.has(a.Ia()))throw Error("Duplicate instance name "+a.Ia());Ll.set(a.Ia(),a);a.sb()},Aaa=function(a){for(var b=0,c=l(Object.keys(Gl)),d=c.next();!d.done;d=c.next()){d=d.value;var e=d.length+window.localStorage.getItem(d).length;d.startsWith("mr.")?Hl+=e:b+=e}Nl=a;(window.localStorage.getItem("version")&&
window.localStorage.getItem("version")!==chrome.runtime.getManifest().version||Ol(a))&&Pl();Ql.info("initialize: "+Hl+" chars used, "+b+" other chars");chrome.runtime.onSuspend.addListener(zaa)},Nl=null,Ql=gb("mr.PersistentDataManager"),Ll=new Map,Il=function(a,b){return"mr."+(b?"persistent.":"temp.")+a.Ia()},Ol=function(a){return!!window.localStorage.getItem("mrInstanceId")&&window.localStorage.getItem("mrInstanceId")!==a},zaa=function(){Ql.info("onSuspend");Rl("version",chrome.runtime.getManifest().version);
Nl&&Rl("mrInstanceId",Nl);for(var a=Ll.get("LogManager"),b=l(Ll),c=b.next();!c.done;c=b.next())c=l(c.value),c.next(),c=c.next().value,c!=a&&Sl(c);a&&Sl(a)},Sl=function(a){try{var b=a.tb();b&&void 0!=b[0]&&Rl(Il(a,!1),JSON.stringify(b[0]));b&&void 0!=b[1]&&Rl(Il(a,!0),JSON.stringify(b[1]))}catch(c){Ql.error("Error while saving data for "+a.Ia()+": "+c.message)}},Rl=function(a,b){var c=window.localStorage.getItem(a);c=null!=c?b.length-c.length:a.length+b.length;52E5<Hl+c&&(Ql.K("Unable to write "+c+
" chars"),Pl());if(52E5<Hl+c)throw Ql.error("Unable to write "+c+" chars after clearing temporary"),Error("Setting the value of '"+a+"' would exceed the quota, according to accounting.");try{window.localStorage.setItem(a,b)}catch(d){throw Error("Setting the value of '"+a+"' would exceed the quota, according to the browser.");}Hl+=c},Tl=function(a){a=0==a.size%2?new Blob([a,new Uint8Array([0,0])]):new Blob([a,new Uint8Array([1])]);return new Promise(function(b,c){var d=new FileReader;d.onloadend=function(){if(d.error)c(d.error);
else try{for(var e=d.result,f=[],g=0,k=e.byteLength;g<k;g+=8192)f.push(String.fromCharCode.apply(null,new Uint16Array(e,g,Math.min(k-g,8192)/2)));Rl("mr.temp.mirror.cast.Service.eventsBlob",f.join(""));b()}catch(m){c(m)}};d.readAsArrayBuffer(a)})},Pl=function(){for(var a=l(Object.keys(Gl)),b=a.next();!b.done;b=a.next())b=b.value,b.startsWith("mr.temp.")&&(Hl-=b.length+window.localStorage.getItem(b).length,delete window.localStorage[b]);Ql.info("removeTemporary_: "+Hl+" chars used")};var Baa=(new Map).set("+","-").set("/","_").set("=","."),Caa=(new Map).set("-","+").set("_","/").set(".","="),Ul=function(a){return atob(a.replace(/[-_.]/g,function(b){return Caa.get(b)}))},Daa=function(a){return btoa(String.fromCharCode.apply(String,n(a))).replace(/[+/=]/g,function(b){return Baa.get(b)})};var Vl=function(){this.g=[];this.m=[];this.D=[];this.j=[];this.j[0]=128;for(var a=1;64>a;++a)this.j[a]=0;this.l=this.h=0;this.reset()};Vl.prototype.reset=function(){this.g[0]=1732584193;this.g[1]=4023233417;this.g[2]=2562383102;this.g[3]=271733878;this.g[4]=3285377520;this.l=this.h=0};
var Wl=function(a,b,c){c=void 0===c?0:c;var d=a.D;if("string"===typeof b)for(var e=0;16>e;e++)d[e]=b.charCodeAt(c)<<24|b.charCodeAt(c+1)<<16|b.charCodeAt(c+2)<<8|b.charCodeAt(c+3),c+=4;else for(e=0;16>e;e++)d[e]=b[c]<<24|b[c+1]<<16|b[c+2]<<8|b[c+3],c+=4;for(b=16;80>b;b++)c=d[b-3]^d[b-8]^d[b-14]^d[b-16],d[b]=(c<<1|c>>>31)&4294967295;b=a.g[0];c=a.g[1];e=a.g[2];for(var f=a.g[3],g=a.g[4],k,m,p=0;80>p;p++)40>p?20>p?(k=f^c&(e^f),m=1518500249):(k=c^e^f,m=1859775393):60>p?(k=c&e|f&(c|e),m=2400959708):(k=
c^e^f,m=3395469782),k=(b<<5|b>>>27)+k+g+m+d[p]&4294967295,g=f,f=e,e=(c<<30|c>>>2)&4294967295,c=b,b=k;a.g[0]=a.g[0]+b&4294967295;a.g[1]=a.g[1]+c&4294967295;a.g[2]=a.g[2]+e&4294967295;a.g[3]=a.g[3]+f&4294967295;a.g[4]=a.g[4]+g&4294967295};
Vl.prototype.update=function(a,b){b=void 0===b?a.length:b;for(var c=b-64,d=0,e=this.m,f=this.h;d<b;){if(0==f)for(;d<=c;)Wl(this,a,d),d+=64;if("string"===typeof a)for(;d<b;){if(e[f]=a.charCodeAt(d),++f,++d,64==f){Wl(this,e);f=0;break}}else for(;d<b;)if(e[f]=a[d],++f,++d,64==f){Wl(this,e);f=0;break}}this.h=f;this.l+=b};
Vl.prototype.digest=function(){var a=[],b=8*this.l;56>this.h?this.update(this.j,56-this.h):this.update(this.j,64-(this.h-56));for(var c=63;56<=c;c--)this.m[c]=b&255,b/=256;Wl(this,this.m);for(c=b=0;5>c;c++)for(var d=24;0<=d;d-=8)a[b]=this.g[c]>>d&255,++b;return a};var Xl=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)};var Zl=function(){this.l=Xl();this.h=new Yl(null,null);this.g=new Yl(null,null);this.m=[];this.j=0;Ml(this)},am=function(){$l||($l=new Zl);return $l},bm=function(a,b){b=b.toLowerCase();var c=new Vl;c.update(b);c.update(a.l);return"r"+Daa(c.digest())},Eaa=function(){var a=am();return a.h.model?a.h:a.g.model?a.g:new Yl(null,null)};Zl.prototype.Ia=function(){return"SinkUtils"};
Zl.prototype.tb=function(){return[{recentLaunchedDevice:this.h,recentDiscoveredDevice:this.g},{receiverIdToken:this.l,fixedIpList:this.m.join(","),castControlPort:this.j}]};Zl.prototype.sb=function(){var a=Jl(this);a&&(this.h=a.recentLaunchedDevice||new Yl(null,null),this.g=a.recentDiscoveredDevice||new Yl(null,null));if(a=Kl(this))this.l=a.receiverIdToken||Xl(),this.m=a.fixedIpList&&a.fixedIpList.split(",")||[],this.j=a.castControlPort||0};var $l=null,Yl=function(a,b){this.model=a;this.ip=b};var cm=function(a,b){this.Kc=this.Of=this.fe=this.Oa=this.rc=null;this.Lc=new Fl(b,a);this.qc={};this.fi={};this.Re=!1};cm.prototype.getId=function(){return this.Lc.id};cm.prototype.update=function(a){if(this.getId()!=a.getId())return!1;var b=!1;this.Lc.friendlyName!=a.Lc.friendlyName&&(this.Lc.friendlyName=a.Lc.friendlyName,b=!0);this.fe!=a.fe&&(this.fe=a.fe,b=!0);this.Of!=a.Of&&(this.Of=a.Of,b=!0);this.rc!=a.rc&&(this.rc=a.rc,b=!0);this.Oa!=a.Oa&&(this.Oa=a.Oa,b=!0);return b};cm.prototype.gc=function(){return this.rc};
cm.prototype.Jb=function(){return this.Oa};var dm=function(a,b){return a.qc[b]||"unknown"},Faa=function(a){var b=new cm(a.Lc.friendlyName,"");b.Lc.id=a.Lc.id;b.rc=a.rc;b.Oa=a.Oa;b.fe=a.fe;b.Of=a.Of;b.Kc=a.Kc;b.qc=a.qc;b.fi=a.fi;b.Re=a.Re;return b};var em=function(a,b,c,d,e,f){this.h=new Fl(a,b,d&1?"cast":d&32?"cast_audio_group":"cast_audio");this.Kc=c||null;this.g=d||null;this.rc=e||null;this.Oa=f||null;this.qc={};this.Zi=!1};em.prototype.update=function(a,b,c,d){var e=!1;this.h.friendlyName!=a&&(this.h.friendlyName=a,e=!0);null!=b&&this.rc!=b&&(this.rc=b,e=!0);null!=c&&this.Oa!=c&&(this.Oa=c,e=!0);null!=d&&this.g!=d&&(this.g=d,e=!0);return e};em.prototype.getId=function(){return this.h.id};em.prototype.gc=function(){return this.rc};
em.prototype.Jb=function(){return this.Oa};var fm=function(a,b){return a.qc[b]||"unknown"};var gm="StopIteration"in Ha?Ha.StopIteration:{message:"StopIteration",stack:""},hm=function(){};hm.prototype.next=function(){throw gm;};hm.prototype.Yb=function(){return this};
var im=function(a){if(a instanceof hm)return a;if("function"==typeof a.Yb)return a.Yb(!1);if(Ta(a)){var b=0,c=new hm;c.next=function(){for(;;){if(b>=a.length)throw gm;if(b in a)return a[b++];b++}};return c}throw Error("Not implemented");},jm=function(a,b,c){if(Ta(a))try{Kb(a,b,c)}catch(d){if(d!==gm)throw d;}else{a=im(a);try{for(;;)b.call(c,a.next(),void 0,a)}catch(d){if(d!==gm)throw d;}}},km=function(a,b){a=im(a);try{for(;!b.call(void 0,a.next(),void 0,a););}catch(c){if(c!==gm)throw c;}},Gaa=function(a){if(Ta(a))return x(a);
a=im(a);var b=[];jm(a,function(c){b.push(c)});return b};var mm=function(a,b){this.h={};this.g=[];this.l=this.j=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&lm(this,a)};mm.prototype.Ca=function(){return this.j};mm.prototype.Na=function(){nm(this);for(var a=[],b=0;b<this.g.length;b++)a.push(this.h[this.g[b]]);return a};mm.prototype.Qb=function(){nm(this);return this.g.concat()};var pm=function(a,b){return om(a.h,b)};
mm.prototype.Rf=function(a){for(var b=0;b<this.g.length;b++){var c=this.g[b];if(om(this.h,c)&&this.h[c]==a)return!0}return!1};mm.prototype.equals=function(a,b){if(this===a)return!0;if(this.j!=a.Ca())return!1;b=b||Haa;nm(this);for(var c,d=0;c=this.g[d];d++)if(!b(this.get(c),a.get(c)))return!1;return!0};var Haa=function(a,b){return a===b};mm.prototype.bc=function(){return 0==this.j};mm.prototype.clear=function(){this.h={};this.l=this.j=this.g.length=0};
mm.prototype.remove=function(a){return om(this.h,a)?(delete this.h[a],this.j--,this.l++,this.g.length>2*this.j&&nm(this),!0):!1};var nm=function(a){if(a.j!=a.g.length){for(var b=0,c=0;b<a.g.length;){var d=a.g[b];om(a.h,d)&&(a.g[c++]=d);b++}a.g.length=c}if(a.j!=a.g.length){var e={};for(c=b=0;b<a.g.length;)d=a.g[b],om(e,d)||(a.g[c++]=d,e[d]=1),b++;a.g.length=c}};mm.prototype.get=function(a,b){return om(this.h,a)?this.h[a]:b};
mm.prototype.set=function(a,b){om(this.h,a)||(this.j++,this.g.push(a),this.l++);this.h[a]=b};var lm=function(a,b){if(b instanceof mm)for(var c=b.Qb(),d=0;d<c.length;d++)a.set(c[d],b.get(c[d]));else for(c in b)a.set(c,b[c])};mm.prototype.forEach=function(a,b){for(var c=this.Qb(),d=0;d<c.length;d++){var e=c[d],f=this.get(e);a.call(b,f,e,this)}};mm.prototype.clone=function(){return new mm(this)};var qm=function(a){nm(a);for(var b={},c=0;c<a.g.length;c++){var d=a.g[c];b[d]=a.h[d]}return b};
mm.prototype.Yb=function(a){nm(this);var b=0,c=this.l,d=this,e=new hm;e.next=function(){if(c!=d.l)throw Error("The map has changed since the iterator was created");if(b>=d.g.length)throw gm;var f=d.g[b++];return a?f:d.h[f]};return e};var om=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};var rm=function(a,b){this.l=b;this.h=a;this.h.ta=this.ta.bind(this);this.g=new mm;this.m=new mm;this.s=gb("mr.cast.SinkDiscoveryService");this.j={Ig:0,Yg:0}};q(rm,Ri);rm.prototype.init=function(){Ml(this);Xi("mr.cast.SinkDiscoveryService",this)};
var Kaa=function(a,b){a.s.info("addSinks returned "+b.length+" sinks");nb(a.s,function(){return"....the list is: "+JSON.stringify(b)});var c=new Set(a.g.Qb());b.forEach(function(e){var f=e.sink_id;var g=e.extra_data.cast_media_sink,k=g.ip_endpoint?g.ip_endpoint.address:g.ip_address,m=g.ip_endpoint?g.ip_endpoint.port:am().j||8009;f=new em(f,e.name,g.model_name,g.capabilities,k.address_bytes.join("."),m);g=a.g.get(f.getId());k=a.h;e=e.extra_data.cast_media_sink.cast_channel_id;m=f.getId();var p=k.h.get(m);
if(!p||p.channelId!=e){sm.info("Added cast channel "+e+" to receiver: "+m);p&&k.g.remove(p.channelId);p={auth:"ssl_verified",ipAddress:f.gc(),port:f.Jb()};p={channelId:e,readyState:"open",keepAlive:!0,audioOnly:!(f.g&1),connectInfo:p};k.h.set(m,p);k.g.set(e,m);var u=k.l.get(m);u&&u.channelId!=e&&(sm.info("Re-connected to receiver: "+f.getId()),Iaa(k.j,u,p),tm(k.m.m,f,!0));k.l.set(m,p)}if(g){if(k=g.update(f.h.friendlyName,f.gc(),f.Jb(),f.g))g.Zi=!1;k&&um(a.l,g)}else a.s.info("Adding sink "+f.getId()),
vm(a,f),g=a.l,g.j.onSinkAvailabilityUpdated(g,1),um(g,f),tm(g.m,f),am().g=new Yl(f.Kc,f.gc());c.delete(f.getId())});c.forEach(function(e){var f=a.h,g=f.l.get(e);g&&(Jaa(f.j,g),f.l.remove(e));wm(a,e)});var d=a.g.Ca();a.j={Ig:d,Yg:d}};rm.prototype.lf=function(){return this.j};
var vm=function(a,b){var c=a.g.get(b.getId()),d=null,e=b.gc(),f=b.Jb();null!=e&&null!=f&&(d=a.m.get(e+":"+f));if(c&&!d){var g=b.gc(),k=b.Jb();g&&k&&a.m.remove(g+":"+k)}d&&!c&&a.g.remove(d.getId());a.g.set(b.getId(),b);null!=e&&null!=f&&a.m.set(e+":"+f,b)},wm=function(a,b){var c=a.g.get(b);if(c){a.s.info("Removing sink "+b);a.g.remove(b);b=c.gc();var d=c.Jb();null!=b&&null!=d&&a.m.remove(b+":"+d);a=a.l;if(0==a.g.g.Ca())a.j.onSinkAvailabilityUpdated(a,0);b=a.m;c=c.getId();(c=xm(b.g,c))&&c.session&&
ym(b,c.session.sessionId);zm(a.H);a.j.td()}},Laa=function(a){a.s.info("Pruning inactive sinks.");var b=new Set;a.g.forEach(function(c){Am(a.h,c)||b.add(c.getId())});b.forEach(function(c){return wm(a,c)})};rm.prototype.ta=function(a){return this.g.get(a,null)};var Maa=function(a,b){var c=[];jm(a.g.Yb(!1),function(d){El(fm(d,b))&&c.push(d)});return c};rm.prototype.Ia=function(){return"cast.SinkDiscoveryService"};
rm.prototype.tb=function(){var a=this,b={};jm(this.g.Yb(!0),function(c){var d=a.g.get(c);d={id:d.getId(),ip:d.gc(),port:d.Jb(),friendlyName:d.h.friendlyName,modelName:d.Kc,capabilities:d.g,discoveredByDial:d.Zi,appStatusMap:d.qc};b[c]=d});return[new Naa(b,this.j)]};
rm.prototype.sb=function(){var a=Jl(this);if(a&&4==a.version){this.j=a.deviceCounts;a=a.sinkMap;for(var b in a){var c=void 0,d=a[b],e=new em("",d.friendlyName,d.modelName,d.capabilities,d.ip,d.port);e.h.id=d.id;e.Zi=d.discoveredByDial;e.qc=d.appStatusMap;for(c in e.qc)"unavailable"==e.qc[c]&&(e.qc[c]="unavailable_rescan");c=e;this.ta(c.getId())||vm(this,c)}Laa(this)}};var Naa=function(a,b){this.sinkMap=a;this.deviceCounts=b;this.version=4};var Bm={STOP_MEDIA:"STOP",MEDIA_SET_VOLUME:"SET_VOLUME",MEDIA_GET_STATUS:"GET_STATUS"};var Cm=function(){this.type="GET_STATUS";this.requestId=0};var Dm=function(a,b){this.requestId=a;this.zh=b;this.Ho=null};Dm.prototype.g=function(){};var Em=function(){this.g=new mm},Fm=function(a,b){a.g.set(b.requestId,b);b.Ho=setTimeout(function(){a.g.remove(b.requestId);b.g()},b.zh)},Gm=function(a,b){var c=a.g.get(b);if(!c)return null;clearTimeout(c.Ho);a.g.remove(b);return c};var Oaa=function(a,b,c){this.type="APPLICATION_BROADCAST";this.requestId=0;this.appIds=a;this.namespace=b;this.message=c};var Paa=function(a){this.type="LAUNCH";this.requestId=0;this.appId=a;this.language=null};var Qaa=function(a){this.type="STOP";this.requestId=0;this.sessionId=a||null};var Hm=function(a){this.h=a;this.g=1E3*Math.floor(1E6*Math.random())},Im=function(a){var b=a.g++;0==b&&(b=a.g++);return b};Hm.prototype.Ia=function(){return"IdGenerator."+this.h};Hm.prototype.tb=function(){return[this.g]};Hm.prototype.sb=function(){var a=Jl(this);a&&(this.g=a)};var Jm=function(a,b){this.h=a;this.j=b;this.g=new Em;this.l=new Hm("cast.RequestIdGenerator")};Jm.prototype.init=function(){Ml(this.l)};var Lm=function(a,b,c,d){var e=Im(a.l);b.requestId=e;b=new Cb;c=new Km(e,b,"number"===typeof c&&0<c?c:6E5,d);Fm(a.g,c);return c};
Jm.prototype.sendRequest=function(a,b,c,d,e,f){var g=this;if(!Dl.hasOwnProperty(c))return Promise.reject(Error("Custom namespace is not supported"));var k=Lm(this,a,void 0!==d?d:3E3,e),m=k.Kb;Mm(this.h,b,c,a,e||this.j,f).then(null,function(){Gm(g.g,k.requestId);m.reject(Nm)});return m.g};
Jm.prototype.sendMessage=function(a,b,c,d,e,f){var g=this,k=Lm(this,a,void 0!==d?d:3E3,e),m=k.Kb;Mm(this.h,b,c,a,e||this.j,f).then(function(){Gm(g.g,k.requestId);m.resolve(!0)},function(){Gm(g.g,k.requestId);m.reject(Nm)});return m.g};
var Raa=function(a,b,c){var d=new Paa(b.appId);d.language=b.language?b.language:chrome.i18n.getUILanguage?chrome.i18n.getUILanguage():chrome.runtime.getManifest().default_locale;return a.sendRequest(d,c,yl,b.requestSessionTimeout)},Om=Error("Timeout"),Nm=Error("Failed to send message"),Km=function(a,b,c,d){Dm.call(this,a,c);this.Kb=b;this.sourceId=d};q(Km,Dm);Km.prototype.g=function(){this.Kb.reject(Om)};var Pm=function(a){return a.Ca&&"function"==typeof a.Ca?a.Ca():Ta(a)||"string"===typeof a?a.length:Ec(a)},Qm=function(a){if(a.Na&&"function"==typeof a.Na)return a.Na();if("string"===typeof a)return a.split("");if(Ta(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return Gc(a)},Rm=function(a){if(a.Qb&&"function"==typeof a.Qb)return a.Qb();if(!a.Na||"function"!=typeof a.Na){if(Ta(a)||"string"===typeof a){var b=[];a=a.length;for(var c=0;c<a;c++)b.push(c);return b}return Hc(a)}},Saa=function(a){return a.bc&&
"function"==typeof a.bc?a.bc():Ta(a)||"string"===typeof a?Wb(a):Kc(a)},Sm=function(a,b,c){if(a.forEach&&"function"==typeof a.forEach)a.forEach(b,c);else if(Ta(a)||"string"===typeof a)Kb(a,b,c);else for(var d=Rm(a),e=Qm(a),f=e.length,g=0;g<f;g++)b.call(c,e[g],d&&d[g],a)},Tm=function(a,b,c){if("function"==typeof a.map)return a.map(b,c);if(Ta(a)||"string"===typeof a)return Nb(a,b,c);var d=Rm(a),e=Qm(a),f=e.length;if(d){var g={};for(var k=0;k<f;k++)g[d[k]]=b.call(c,e[k],d[k],a)}else for(g=[],k=0;k<f;k++)g[k]=
b.call(c,e[k],void 0,a);return g},Taa=function(a,b){if("function"==typeof a.every)return a.every(b,void 0);if(Ta(a)||"string"===typeof a)return Qb(a,b,void 0);for(var c=Rm(a),d=Qm(a),e=d.length,f=0;f<e;f++)if(!b.call(void 0,d[f],c&&c[f],a))return!1;return!0};var Vm=function(a){this.g=new mm;a&&Um(this,a)},Wm=function(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+(a[Wa]||(a[Wa]=++Za)):b.substr(0,1)+a};Vm.prototype.Ca=function(){return this.g.Ca()};Vm.prototype.add=function(a){this.g.set(Wm(a),a)};var Um=function(a,b){b=Qm(b);for(var c=b.length,d=0;d<c;d++)a.add(b[d])};h=Vm.prototype;h.removeAll=function(a){a=Qm(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])};h.remove=function(a){return this.g.remove(Wm(a))};h.clear=function(){this.g.clear()};
h.bc=function(){return this.g.bc()};h.contains=function(a){return pm(this.g,Wm(a))};h.Na=function(){return this.g.Na()};h.clone=function(){return new Vm(this)};h.equals=function(a){return this.Ca()==Pm(a)&&Uaa(this,a)};var Uaa=function(a,b){var c=Pm(b);if(a.Ca()>c)return!1;!(b instanceof Vm)&&5<c&&(b=new Vm(b));return Taa(a,function(d){var e=b;return e.contains&&"function"==typeof e.contains?e.contains(d):e.Rf&&"function"==typeof e.Rf?e.Rf(d):Ta(e)||"string"===typeof e?Vb(e,d):Jc(e,d)})};
Vm.prototype.Yb=function(){return this.g.Yb(!1)};var Ym=function(a,b){this.l=a;this.j=b;this.h=new mm;this.g=new Vm;this.m=0;this.u=new mm("serviceCheck",this.bs.bind(this),"startDeviceMonitor",this.cs.bind(this),"releaseDeviceMonitor",this.Zr.bind(this),"deviceJustSetUp",this.Wr.bind(this),"logRecord",this.Xr.bind(this));chrome.runtime.onMessage.addListener(this.o.bind(this));chrome.runtime.onMessageExternal.addListener(this.D.bind(this));Xm(this,"serviceReady")};Ym.prototype.s=gb("castApp.eventPage.Service");
var zm=function(a){if(Zm(a)){var b=new Vm;jm(a.l.g.Yb(!1),function(d){var e=d.gc();b.add(e);pm(this.h,e)||this.j.sendRequest(new Cm,d,yl)}.bind(a));var c=!1;a.h.Qb().forEach(function(d){b.contains(d)||(this.h.remove(d),c=!0)}.bind(a));c&&$m(a)}},Zm=function(a){if(0===a.g.Ca())return!1;var b=cb();3E4<b-a.m&&(a.m=b,chrome.tabs.query({url:["chrome://cast/*","chrome-extension://"+chrome.runtime.id+"/cast_setup/*"]},function(c){0===c.length?(this.s.info("No tabs found. Clearing device monitor clients."),
this.g.clear()):this.s.info(function(){return"Tab check found active tabs: "+c.map(function(d){return d.id})})}.bind(a)));b=a.g.Ca();a.s.info("Monitor client count: "+b);return 0<b};Ym.prototype.o=function(a,b,c){if("object"!==typeof a||"cast_app"!==a.type)return!1;var d=this.u.get(a.subtype);if(!d)return!1;if(!a.originId)return Gb("Missing origin ID in the incoming message."),!1;try{var e=d(a,b,c);e&&c(e)}catch(f){this.s.error("Error while handling request",f)}return!1};
var Xm=function(a,b,c){var d=new tl(b,c);nb(a.s,function(){return"Sending message: "+JSON.stringify(d)});chrome.runtime.sendMessage(d)};h=Ym.prototype;h.bs=function(){Xm(this,"serviceReady")};h.cs=function(a){this.g.contains(a.originId)?this.s.info("Client: "+a.originId+"already registered, dispatching current device list."):(this.s.info("Registering monitor client: "+a.originId),this.g.add(a.originId));$m(this);Vaa(this)};
h.Zr=function(a){this.s.info("Unregistering monitor client: "+a.originId);this.g.remove(a.originId)};h.Wr=function(a){a=a.deviceJustSetUp.udn.replace(/-/g,"").toLowerCase();this.s.info("Device just set up: "+a.slice(-4))};h.Xr=function(a){a=a.logRecord;jb({level:qb(a.levelValue),V:a.loggerName,time:a.time,message:a.msg})};var $m=function(a){var b=a.h.Na();Xm(a,"devices",b)},Vaa=function(a){a.l.g.Na().forEach(function(b){this.j.sendRequest(new Cm,b,yl)}.bind(a))};
Ym.prototype.D=function(a,b,c){switch(a.type){case "handshake":c(new vl("handshake"));break;case "launch":b=b.tab&&"number"===typeof b.tab.id?b.tab.id:null,null===b||"setup"!==a.entryPoint&&"offers"!==a.entryPoint&&"devices"!==a.entryPoint||chrome.tabs.update(b,{url:"chrome://cast#"+a.entryPoint})}};chrome.cast.VERSION=[1,2];v("chrome.cast.VERSION",chrome.cast.VERSION);chrome.cast.tv=!0;v("chrome.cast.usingPresentationApi",chrome.cast.tv);chrome.cast.Error=function(a,b,c){this.code=a;this.description=b||null;this.details=c||null};v("chrome.cast.Error",chrome.cast.Error);chrome.cast.lq=function(a){this.platform=a;this.packageId=this.url=null};v("chrome.cast.SenderApplication",chrome.cast.lq);chrome.cast.Image=function(a){this.url=a;this.width=this.height=null};v("chrome.cast.Image",chrome.cast.Image);
chrome.cast.Volume=function(a,b){this.level=void 0!==a?a:null;this.muted=void 0!==b?b:null};v("chrome.cast.Volume",chrome.cast.Volume);chrome.cast.zd={CUSTOM_CONTROLLER_SCOPED:"custom_controller_scoped",TAB_AND_ORIGIN_SCOPED:"tab_and_origin_scoped",ORIGIN_SCOPED:"origin_scoped",PAGE_SCOPED:"page_scoped"};v("chrome.cast.AutoJoinPolicy",chrome.cast.zd);chrome.cast.Fh={CREATE_SESSION:"create_session",CAST_THIS_TAB:"cast_this_tab"};v("chrome.cast.DefaultActionPolicy",chrome.cast.Fh);chrome.cast.ee={VIDEO_OUT:"video_out",AUDIO_OUT:"audio_out",VIDEO_IN:"video_in",AUDIO_IN:"audio_in",MULTIZONE_GROUP:"multizone_group"};
v("chrome.cast.Capability",chrome.cast.ee);chrome.cast.Bd={CANCEL:"cancel",TIMEOUT:"timeout",API_NOT_INITIALIZED:"api_not_initialized",INVALID_PARAMETER:"invalid_parameter",EXTENSION_NOT_COMPATIBLE:"extension_not_compatible",EXTENSION_MISSING:"extension_missing",RECEIVER_UNAVAILABLE:"receiver_unavailable",SESSION_ERROR:"session_error",CHANNEL_ERROR:"channel_error",LOAD_MEDIA_FAILED:"load_media_failed"};v("chrome.cast.ErrorCode",chrome.cast.Bd);chrome.cast.Vp={AVAILABLE:"available",UNAVAILABLE:"unavailable"};
v("chrome.cast.ReceiverAvailability",chrome.cast.Vp);chrome.cast.mq={CHROME:"chrome",IOS:"ios",ANDROID:"android"};v("chrome.cast.SenderPlatform",chrome.cast.mq);chrome.cast.Gh={CAST:"cast",DIAL:"dial",HANGOUT:"hangout",CUSTOM:"custom"};v("chrome.cast.ReceiverType",chrome.cast.Gh);chrome.cast.jp={RUNNING:"running",STOPPED:"stopped",ERROR:"error"};v("chrome.cast.DialAppState",chrome.cast.jp);chrome.cast.Eg={CAST:"cast",STOP:"stop"};v("chrome.cast.ReceiverAction",chrome.cast.Eg);
chrome.cast.Jl={CONNECTED:"connected",DISCONNECTED:"disconnected",STOPPED:"stopped"};v("chrome.cast.SessionStatus",chrome.cast.Jl);chrome.cast.Nl={ATTENUATION:"attenuation",FIXED:"fixed",MASTER:"master"};v("chrome.cast.VolumeControlType",chrome.cast.Nl);chrome.cast.Uo=function(a,b,c,d,e){this.sessionRequest=a;this.sessionListener=b;this.receiverListener=c;this.autoJoinPolicy=d||chrome.cast.zd.TAB_AND_ORIGIN_SCOPED;this.defaultActionPolicy=e||chrome.cast.Fh.CREATE_SESSION;this.customDialLaunchCallback=null;this.invisibleSender=!1;this.additionalSessionRequests=[]};v("chrome.cast.ApiConfig",chrome.cast.Uo);chrome.cast.lp=function(a,b){this.appName=a;this.launchParameter=b||null};v("chrome.cast.DialRequest",chrome.cast.lp);
chrome.cast.ql=function(a,b,c){this.receiver=a;this.appState=b;this.extraData=c||null};v("chrome.cast.DialLaunchData",chrome.cast.ql);chrome.cast.kp=function(a,b){this.doLaunch=a;this.launchParameter=b||null};v("chrome.cast.DialLaunchResponse",chrome.cast.kp);chrome.cast.Il=function(a,b,c){this.appId=a;this.capabilities=Sa(b)?b:[chrome.cast.ee.VIDEO_OUT,chrome.cast.ee.AUDIO_OUT];this.requestSessionTimeout=c||chrome.cast.timeout.requestSession;this.dialRequest=this.language=null};
v("chrome.cast.SessionRequest",chrome.cast.Il);chrome.cast.Fi=function(a,b,c,d){this.label=a;this.friendlyName=qe(b);this.capabilities=c||[];this.volume=d||null;this.receiverType=chrome.cast.Gh.CAST;this.displayStatus=this.isActiveInput=null};v("chrome.cast.Receiver",chrome.cast.Fi);chrome.cast.Wp=function(a,b){this.statusText=a;this.appImages=b;this.showStop=null};v("chrome.cast.ReceiverDisplayStatus",chrome.cast.Wp);
chrome.cast.Ll=function(){this.requestSession=6E4;this.sendCustomMessage=this.setReceiverVolume=this.stopSession=this.leaveSession=3E3};v("chrome.cast.Timeout",chrome.cast.Ll);chrome.cast.timeout=new chrome.cast.Ll;v("chrome.cast.timeout",chrome.cast.timeout);chrome.cast.kl="auto-join";chrome.cast.El="cast-session_";chrome.cast.media.sp={SDR:"sdr",HDR:"hdr",DV:"dv"};v("chrome.cast.media.HdrType",chrome.cast.media.sp);chrome.cast.media.tp={AAC:"aac",AC3:"ac3",MP3:"mp3",TS:"ts",TS_AAC:"ts_aac",E_AC3:"e_ac3",FMP4:"fmp4"};v("chrome.cast.media.HlsSegmentFormat",chrome.cast.media.tp);chrome.cast.media.up={MPEG2_TS:"mpeg2_ts",FMP4:"fmp4"};v("chrome.cast.media.HlsVideoSegmentFormat",chrome.cast.media.up);chrome.cast.media.De={PAUSE:"pause",SEEK:"seek",STREAM_VOLUME:"stream_volume",STREAM_MUTE:"stream_mute"};
v("chrome.cast.media.MediaCommand",chrome.cast.media.De);chrome.cast.media.Sp={ALBUM:"ALBUM",PLAYLIST:"PLAYLIST",AUDIOBOOK:"AUDIOBOOK",RADIO_STATION:"RADIO_STATION",PODCAST_SERIES:"PODCAST_SERIES",TV_SERIES:"TV_SERIES",VIDEO_PLAYLIST:"VIDEO_PLAYLIST",LIVE_TV:"LIVE_TV",MOVIE:"MOVIE"};v("chrome.cast.media.QueueType",chrome.cast.media.Sp);chrome.cast.media.Ai={GENERIC_CONTAINER:0,AUDIOBOOK_CONTAINER:1};v("chrome.cast.media.ContainerType",chrome.cast.media.Ai);
chrome.cast.media.Ee={GENERIC:0,MOVIE:1,TV_SHOW:2,MUSIC_TRACK:3,PHOTO:4,AUDIOBOOK_CHAPTER:5};v("chrome.cast.media.MetadataType",chrome.cast.media.Ee);chrome.cast.media.PlayerState={IDLE:"IDLE",PLAYING:"PLAYING",PAUSED:"PAUSED",BUFFERING:"BUFFERING"};v("chrome.cast.media.PlayerState",chrome.cast.media.PlayerState);chrome.cast.media.Gi={OFF:"REPEAT_OFF",ALL:"REPEAT_ALL",SINGLE:"REPEAT_SINGLE",ALL_AND_SHUFFLE:"REPEAT_ALL_AND_SHUFFLE"};v("chrome.cast.media.RepeatMode",chrome.cast.media.Gi);
chrome.cast.media.Xp={PLAYBACK_START:"PLAYBACK_START",PLAYBACK_PAUSE:"PLAYBACK_PAUSE"};v("chrome.cast.media.ResumeState",chrome.cast.media.Xp);chrome.cast.media.Kl={BUFFERED:"BUFFERED",LIVE:"LIVE",OTHER:"OTHER"};v("chrome.cast.media.StreamType",chrome.cast.media.Kl);chrome.cast.media.wp={CANCELLED:"CANCELLED",INTERRUPTED:"INTERRUPTED",FINISHED:"FINISHED",ERROR:"ERROR"};v("chrome.cast.media.IdleReason",chrome.cast.media.wp);chrome.cast.media.wq={TEXT:"TEXT",AUDIO:"AUDIO",VIDEO:"VIDEO"};
v("chrome.cast.media.TrackType",chrome.cast.media.wq);chrome.cast.media.sq={SUBTITLES:"SUBTITLES",CAPTIONS:"CAPTIONS",DESCRIPTIONS:"DESCRIPTIONS",CHAPTERS:"CHAPTERS",METADATA:"METADATA"};v("chrome.cast.media.TextTrackType",chrome.cast.media.sq);chrome.cast.media.oq={NONE:"NONE",OUTLINE:"OUTLINE",DROP_SHADOW:"DROP_SHADOW",RAISED:"RAISED",DEPRESSED:"DEPRESSED"};v("chrome.cast.media.TextTrackEdgeType",chrome.cast.media.oq);chrome.cast.media.tq={NONE:"NONE",NORMAL:"NORMAL",ROUNDED_CORNERS:"ROUNDED_CORNERS"};
v("chrome.cast.media.TextTrackWindowType",chrome.cast.media.tq);chrome.cast.media.pq={SANS_SERIF:"SANS_SERIF",MONOSPACED_SANS_SERIF:"MONOSPACED_SANS_SERIF",SERIF:"SERIF",MONOSPACED_SERIF:"MONOSPACED_SERIF",CASUAL:"CASUAL",CURSIVE:"CURSIVE",SMALL_CAPITALS:"SMALL_CAPITALS"};v("chrome.cast.media.TextTrackFontGenericFamily",chrome.cast.media.pq);chrome.cast.media.qq={NORMAL:"NORMAL",BOLD:"BOLD",BOLD_ITALIC:"BOLD_ITALIC",ITALIC:"ITALIC"};v("chrome.cast.media.TextTrackFontStyle",chrome.cast.media.qq);
chrome.cast.media.yq={LIKE:"LIKE",DISLIKE:"DISLIKE",FOLLOW:"FOLLOW",UNFOLLOW:"UNFOLLOW"};v("chrome.cast.media.UserAction",chrome.cast.media.yq);chrome.cast.media.qp=function(){this.customData=null};v("chrome.cast.media.GetStatusRequest",chrome.cast.media.qp);chrome.cast.media.Hp=function(){this.customData=null};v("chrome.cast.media.PauseRequest",chrome.cast.media.Hp);chrome.cast.media.Ip=function(){this.customData=null};v("chrome.cast.media.PlayRequest",chrome.cast.media.Ip);chrome.cast.media.kq=function(){this.customData=this.resumeState=this.currentTime=null};v("chrome.cast.media.SeekRequest",chrome.cast.media.kq);
chrome.cast.media.nq=function(){this.customData=null};v("chrome.cast.media.StopRequest",chrome.cast.media.nq);chrome.cast.media.Cq=function(a){this.volume=a;this.customData=null};v("chrome.cast.media.VolumeRequest",chrome.cast.media.Cq);chrome.cast.media.yp=function(a){this.type="LOAD";this.requestId=0;this.sessionId=null;this.media=a;this.activeTrackIds=null;this.autoplay=!0;this.customData=this.currentTime=null};v("chrome.cast.media.LoadRequest",chrome.cast.media.yp);
chrome.cast.media.RA=function(a){this.type="PRECACHE";this.requestId=0;this.precacheData=a};chrome.cast.media.pp=function(a,b){this.requestId=0;this.activeTrackIds=a||null;this.textTrackStyle=b||null};v("chrome.cast.media.EditTracksInfoRequest",chrome.cast.media.pp);chrome.cast.media.zi=function(a){this.containerType=a=void 0===a?chrome.cast.media.Ai.GENERIC_CONTAINER:a;this.containerDuration=this.containerImages=this.sections=this.title=void 0};v("chrome.cast.media.ContainerMetadata",chrome.cast.media.zi);
chrome.cast.media.Cc=function(a){this.metadataType=this.type=a;this.queueItemId=this.sectionStartTimeInContainer=this.sectionStartAbsoluteTime=this.sectionStartTimeInMedia=this.sectionDuration=void 0};v("chrome.cast.media.MediaMetadata",chrome.cast.media.Cc);chrome.cast.media.wl=function(){chrome.cast.media.Cc.call(this,chrome.cast.media.Ee.GENERIC);this.releaseDate=this.releaseYear=this.images=this.subtitle=this.title=void 0};q(chrome.cast.media.wl,chrome.cast.media.Cc);
v("chrome.cast.media.GenericMediaMetadata",chrome.cast.media.wl);chrome.cast.media.yl=function(){chrome.cast.media.Cc.call(this,chrome.cast.media.Ee.MOVIE);this.releaseDate=this.releaseYear=this.images=this.subtitle=this.studio=this.title=void 0};q(chrome.cast.media.yl,chrome.cast.media.Cc);v("chrome.cast.media.MovieMediaMetadata",chrome.cast.media.yl);
chrome.cast.media.Ml=function(){chrome.cast.media.Cc.call(this,chrome.cast.media.Ee.TV_SHOW);this.originalAirdate=this.releaseYear=this.images=this.episode=this.episodeNumber=this.season=this.seasonNumber=this.episodeTitle=this.title=this.seriesTitle=void 0};q(chrome.cast.media.Ml,chrome.cast.media.Cc);v("chrome.cast.media.TvShowMediaMetadata",chrome.cast.media.Ml);
chrome.cast.media.zl=function(){chrome.cast.media.Cc.call(this,chrome.cast.media.Ee.MUSIC_TRACK);this.releaseDate=this.releaseYear=this.images=this.discNumber=this.trackNumber=this.artistName=this.songName=this.composer=this.artist=this.albumArtist=this.title=this.albumName=void 0};q(chrome.cast.media.zl,chrome.cast.media.Cc);v("chrome.cast.media.MusicTrackMediaMetadata",chrome.cast.media.zl);
chrome.cast.media.Fl=function(){chrome.cast.media.Cc.call(this,chrome.cast.media.Ee.PHOTO);this.creationDateTime=this.height=this.width=this.longitude=this.latitude=this.images=this.location=this.artist=this.title=void 0};q(chrome.cast.media.Fl,chrome.cast.media.Cc);v("chrome.cast.media.PhotoMediaMetadata",chrome.cast.media.Fl);chrome.cast.media.ml=function(){chrome.cast.media.zi.call(this,chrome.cast.media.Ai.AUDIOBOOK_CONTAINER);this.releaseDate=this.publisher=this.narrators=this.authors=void 0};
q(chrome.cast.media.ml,chrome.cast.media.zi);v("chrome.cast.media.AudiobookContainerMetadata",chrome.cast.media.ml);chrome.cast.media.ll=function(){chrome.cast.media.Cc.call(this,chrome.cast.media.Ee.AUDIOBOOK_CHAPTER);this.images=this.subtitle=this.bookTitle=this.chapterNumber=this.title=this.chapterTitle=void 0};q(chrome.cast.media.ll,chrome.cast.media.Cc);v("chrome.cast.media.AudiobookChapterMediaMetadata",chrome.cast.media.ll);
chrome.cast.media.Ap=function(a,b){this.contentId=a;this.contentUrl=void 0;this.streamType=chrome.cast.media.Kl.BUFFERED;this.contentType=b;this.metadata=null;this.entity=void 0;this.duration=null;this.startAbsoluteTime=void 0;this.customData=this.textTrackStyle=this.tracks=null;this.userActionStates=this.hlsVideoSegmentFormat=this.hlsSegmentFormat=this.vmapAdsRequest=this.breakClips=this.breaks=void 0};v("chrome.cast.media.MediaInfo",chrome.cast.media.Ap);
chrome.cast.media.Mp=function(a){this.itemId=null;this.media=a;this.autoplay=!0;this.startTime=0;this.playbackDuration=null;this.preloadTime=0;this.customData=this.activeTrackIds=null};v("chrome.cast.media.QueueItem",chrome.cast.media.Mp);chrome.cast.media.fp="CC1AD845";v("chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID",chrome.cast.media.fp);chrome.cast.media.timeout={};chrome.cast.media.timeout.load=0;v("chrome.cast.media.timeout.load",chrome.cast.media.timeout.load);
chrome.cast.media.timeout.Xa=0;v("chrome.cast.media.timeout.getStatus",chrome.cast.media.timeout.Xa);chrome.cast.media.timeout.play=0;v("chrome.cast.media.timeout.play",chrome.cast.media.timeout.play);chrome.cast.media.timeout.pause=0;v("chrome.cast.media.timeout.pause",chrome.cast.media.timeout.pause);chrome.cast.media.timeout.seek=0;v("chrome.cast.media.timeout.seek",chrome.cast.media.timeout.seek);chrome.cast.media.timeout.stop=0;v("chrome.cast.media.timeout.stop",chrome.cast.media.timeout.stop);
chrome.cast.media.timeout.setVolume=0;v("chrome.cast.media.timeout.setVolume",chrome.cast.media.timeout.setVolume);chrome.cast.media.timeout.aj=0;v("chrome.cast.media.timeout.editTracksInfo",chrome.cast.media.timeout.aj);chrome.cast.media.timeout.lu=0;v("chrome.cast.media.timeout.queue",chrome.cast.media.timeout.lu);chrome.cast.media.uq=function(a,b){this.trackId=a;this.trackContentType=this.trackContentId=null;this.type=b;this.customData=this.subtype=this.language=this.name=null};
v("chrome.cast.media.Track",chrome.cast.media.uq);chrome.cast.media.rq=function(){this.customData=this.fontStyle=this.fontGenericFamily=this.fontFamily=this.fontScale=this.windowRoundedCornerRadius=this.windowColor=this.windowType=this.edgeColor=this.edgeType=this.backgroundColor=this.foregroundColor=null};v("chrome.cast.media.TextTrackStyle",chrome.cast.media.rq);
chrome.cast.media.Op=function(a){this.type="QUEUE_LOAD";this.sessionId=this.requestId=null;this.items=a;this.startIndex=0;this.repeatMode=chrome.cast.media.Gi.OFF;this.customData=null};v("chrome.cast.media.QueueLoadRequest",chrome.cast.media.Op);chrome.cast.media.Lp=function(a){this.type="QUEUE_INSERT";this.sessionId=this.requestId=null;this.items=a;this.customData=this.insertBefore=null};v("chrome.cast.media.QueueInsertItemsRequest",chrome.cast.media.Lp);
chrome.cast.media.Tp=function(a){this.type="QUEUE_UPDATE";this.sessionId=this.requestId=null;this.items=a;this.customData=null};v("chrome.cast.media.QueueUpdateItemsRequest",chrome.cast.media.Tp);chrome.cast.media.Np=function(){this.type="QUEUE_UPDATE";this.customData=this.jump=this.currentItemId=this.sessionId=this.requestId=null};v("chrome.cast.media.QueueJumpRequest",chrome.cast.media.Np);
chrome.cast.media.Rp=function(){this.type="QUEUE_UPDATE";this.customData=this.repeatMode=this.sessionId=this.requestId=null};v("chrome.cast.media.QueueSetPropertiesRequest",chrome.cast.media.Rp);chrome.cast.media.Pp=function(a){this.type="QUEUE_REMOVE";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=null};v("chrome.cast.media.QueueRemoveItemsRequest",chrome.cast.media.Pp);
chrome.cast.media.Qp=function(a){this.type="QUEUE_REORDER";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=this.insertBefore=null};v("chrome.cast.media.QueueReorderItemsRequest",chrome.cast.media.Qp);chrome.cast.media.Xo=function(a,b,c){this.id=a;this.breakClipIds=b;this.position=c;this.duration=void 0;this.isWatched=!1;this.isEmbedded=void 0};v("chrome.cast.media.Break",chrome.cast.media.Xo);
chrome.cast.media.Yo=function(a){this.id=a;this.vastAdsRequest=this.customData=this.hlsSegmentFormat=this.clickThroughUrl=this.posterUrl=this.whenSkippable=this.duration=this.title=this.contentType=this.contentUrl=this.contentId=void 0};v("chrome.cast.media.BreakClip",chrome.cast.media.Yo);chrome.cast.media.Aq=function(){this.adsResponse=this.adTagUrl=void 0};v("chrome.cast.media.VastAdsRequest",chrome.cast.media.Aq);
chrome.cast.media.Zo=function(){this.whenSkippable=this.breakClipId=this.breakId=this.currentBreakClipTime=this.currentBreakTime=void 0};v("chrome.cast.media.BreakStatus",chrome.cast.media.Zo);chrome.cast.media.xp=function(a,b,c,d){this.start=a;this.end=b;this.isMovingWindow=c;this.isLiveDone=d};v("chrome.cast.media.LiveSeekableRange",chrome.cast.media.xp);
chrome.cast.media.Kp=function(a,b,c,d,e,f,g){this.id=a;this.queueType=this.entity=void 0;this.name=b;this.description=c;this.repeatMode=d;this.shuffle=!1;this.items=e;this.startIndex=f;this.startTime=g;this.containerMetadata=void 0};v("chrome.cast.media.QueueData",chrome.cast.media.Kp);chrome.cast.media.zq=function(a){this.userAction=a;this.customData=void 0};v("chrome.cast.media.UserActionState",chrome.cast.media.zq);chrome.cast.media.Bq=function(a,b,c){this.width=a;this.height=b;this.hdrType=c};
v("chrome.cast.media.VideoInformation",chrome.cast.media.Bq);chrome.cast.media.aa=function(a,b){this.sessionId=a;this.mediaSessionId=b;this.media=null;this.videoInfo=this.queueData=void 0;this.playbackRate=1;this.playerState=chrome.cast.media.PlayerState.IDLE;this.currentTime=0;this.supportedMediaCommands=[];this.volume=new chrome.cast.Volume;this.items=this.preloadedItemId=this.loadingItemId=this.currentItemId=this.customData=this.activeTrackIds=this.idleReason=null;this.repeatMode=chrome.cast.media.Gi.OFF;this.liveSeekableRange=this.breakStatus=void 0};
v("chrome.cast.media.Media",chrome.cast.media.aa);chrome.cast.media.aa.prototype.Xa=function(){};chrome.cast.media.aa.prototype.getStatus=chrome.cast.media.aa.prototype.Xa;chrome.cast.media.aa.prototype.play=function(){};chrome.cast.media.aa.prototype.play=chrome.cast.media.aa.prototype.play;chrome.cast.media.aa.prototype.Vt=function(){};chrome.cast.media.aa.prototype.playWithContext=chrome.cast.media.aa.prototype.Vt;chrome.cast.media.aa.prototype.pause=function(){};
chrome.cast.media.aa.prototype.pause=chrome.cast.media.aa.prototype.pause;chrome.cast.media.aa.prototype.Ut=function(){};chrome.cast.media.aa.prototype.pauseWithContext=chrome.cast.media.aa.prototype.Ut;chrome.cast.media.aa.prototype.seek=function(){};chrome.cast.media.aa.prototype.seek=chrome.cast.media.aa.prototype.seek;chrome.cast.media.aa.prototype.stop=function(){};chrome.cast.media.aa.prototype.stop=chrome.cast.media.aa.prototype.stop;chrome.cast.media.aa.prototype.setVolume=function(){};
chrome.cast.media.aa.prototype.setVolume=chrome.cast.media.aa.prototype.setVolume;chrome.cast.media.aa.prototype.aj=function(){};chrome.cast.media.aa.prototype.editTracksInfo=chrome.cast.media.aa.prototype.aj;chrome.cast.media.aa.prototype.nu=function(){};chrome.cast.media.aa.prototype.queueInsertItems=chrome.cast.media.aa.prototype.nu;chrome.cast.media.aa.prototype.mu=function(){};chrome.cast.media.aa.prototype.queueAppendItem=chrome.cast.media.aa.prototype.mu;chrome.cast.media.aa.prototype.xu=function(){};
chrome.cast.media.aa.prototype.queueUpdateItems=chrome.cast.media.aa.prototype.xu;chrome.cast.media.aa.prototype.su=function(){};chrome.cast.media.aa.prototype.queuePrev=chrome.cast.media.aa.prototype.su;chrome.cast.media.aa.prototype.ru=function(){};chrome.cast.media.aa.prototype.queueNext=chrome.cast.media.aa.prototype.ru;chrome.cast.media.aa.prototype.ou=function(a){an(this,a)};chrome.cast.media.aa.prototype.queueJumpToItem=chrome.cast.media.aa.prototype.ou;chrome.cast.media.aa.prototype.wu=function(){};
chrome.cast.media.aa.prototype.queueSetRepeatMode=chrome.cast.media.aa.prototype.wu;chrome.cast.media.aa.prototype.uu=function(){};chrome.cast.media.aa.prototype.queueRemoveItems=chrome.cast.media.aa.prototype.uu;chrome.cast.media.aa.prototype.tu=function(a){an(this,a)};chrome.cast.media.aa.prototype.queueRemoveItem=chrome.cast.media.aa.prototype.tu;chrome.cast.media.aa.prototype.vu=function(){};chrome.cast.media.aa.prototype.queueReorderItems=chrome.cast.media.aa.prototype.vu;
chrome.cast.media.aa.prototype.qu=function(a,b,c,d){a=an(this,a);0>a||(0>b?d&&d(new chrome.cast.Error(chrome.cast.Bd.INVALID_PARAMETER)):a==b&&c&&c())};chrome.cast.media.aa.prototype.queueMoveItemToNewIndex=chrome.cast.media.aa.prototype.qu;chrome.cast.media.aa.prototype.mv=function(a){return-1<this.supportedMediaCommands.indexOf(a)};chrome.cast.media.aa.prototype.supportsCommand=chrome.cast.media.aa.prototype.mv;chrome.cast.media.aa.prototype.Fr=function(){return this.currentTime};
chrome.cast.media.aa.prototype.getEstimatedTime=chrome.cast.media.aa.prototype.Fr;chrome.cast.media.aa.prototype.Dr=function(){if(this.breakStatus&&void 0!==this.breakStatus.currentBreakTime)return this.breakStatus.currentBreakTime};chrome.cast.media.aa.prototype.getEstimatedBreakTime=chrome.cast.media.aa.prototype.Dr;chrome.cast.media.aa.prototype.Cr=function(){if(this.breakStatus&&void 0!==this.breakStatus.currentBreakClipTime)return this.breakStatus.currentBreakClipTime};
chrome.cast.media.aa.prototype.getEstimatedBreakClipTime=chrome.cast.media.aa.prototype.Cr;chrome.cast.media.aa.prototype.Er=function(){if(this.liveSeekableRange&&void 0!==this.liveSeekableRange.start&&void 0!==this.liveSeekableRange.end)return this.liveSeekableRange};chrome.cast.media.aa.prototype.getEstimatedLiveSeekableRange=chrome.cast.media.aa.prototype.Er;chrome.cast.media.aa.prototype.Pi=function(){};chrome.cast.media.aa.prototype.addUpdateListener=chrome.cast.media.aa.prototype.Pi;
chrome.cast.media.aa.prototype.Qi=function(){};chrome.cast.media.aa.prototype.addUpdateListenerWithContext=chrome.cast.media.aa.prototype.Qi;chrome.cast.media.aa.prototype.Ak=function(){};chrome.cast.media.aa.prototype.removeUpdateListener=chrome.cast.media.aa.prototype.Ak;chrome.cast.media.aa.prototype.Bk=function(){};chrome.cast.media.aa.prototype.removeUpdateListenerWithContext=chrome.cast.media.aa.prototype.Bk;var an=function(a,b){return Rb(a.items,function(c){return c.itemId==b})};var Waa=function(a,b,c){this.sessionId=a;this.namespaceName=b;this.message=c};var bn=function(a,b){this.type="SET_VOLUME";this.requestId=0;this.volume=a;this.expectedVolume=b||null};chrome.cast.ga=function(a,b,c,d,e){this.sessionId=a;this.appId=b;this.displayName=c;this.statusText=null;this.appImages=d;this.receiver=e;this.senderApps=[];this.namespaces=[];this.media=[];this.status=chrome.cast.Jl.CONNECTED;this.transportId=""};v("chrome.cast.Session",chrome.cast.ga);chrome.cast.ga.prototype.av=function(a,b,c){this.zo(null,a,b,c)};chrome.cast.ga.prototype.setReceiverVolumeLevel=chrome.cast.ga.prototype.av;
chrome.cast.ga.prototype.zo=function(a,b,c,d){b=new bn(new chrome.cast.Volume(b,null),this.receiver.volume);a.setReceiverVolume(this.sessionId,b,c,d)};chrome.cast.ga.prototype.setReceiverVolumeLevelWithContext=chrome.cast.ga.prototype.zo;chrome.cast.ga.prototype.Zu=function(a,b,c){this.yo(null,a,b,c)};chrome.cast.ga.prototype.setReceiverMuted=chrome.cast.ga.prototype.Zu;
chrome.cast.ga.prototype.yo=function(a,b,c,d){a=new bn(new chrome.cast.Volume(null,b),this.receiver.volume);null.setReceiverVolume(this.sessionId,a,c,d)};chrome.cast.ga.prototype.setReceiverMutedWithContext=chrome.cast.ga.prototype.yo;chrome.cast.ga.prototype.leave=function(a,b){null.leaveSession(this.sessionId,a,b)};chrome.cast.ga.prototype.leave=chrome.cast.ga.prototype.leave;chrome.cast.ga.prototype.stop=function(){};chrome.cast.ga.prototype.stop=chrome.cast.ga.prototype.stop;
chrome.cast.ga.prototype.kv=function(){};chrome.cast.ga.prototype.stopWithContext=chrome.cast.ga.prototype.kv;chrome.cast.ga.prototype.sendMessage=function(){};chrome.cast.ga.prototype.sendMessage=chrome.cast.ga.prototype.sendMessage;chrome.cast.ga.prototype.Lu=function(){};chrome.cast.ga.prototype.sendMessageWithContext=chrome.cast.ga.prototype.Lu;chrome.cast.ga.prototype.Pi=function(){};chrome.cast.ga.prototype.addUpdateListener=chrome.cast.ga.prototype.Pi;chrome.cast.ga.prototype.Qi=function(){};
chrome.cast.ga.prototype.addUpdateListenerWithContext=chrome.cast.ga.prototype.Qi;chrome.cast.ga.prototype.Ak=function(){};chrome.cast.ga.prototype.removeUpdateListener=chrome.cast.ga.prototype.Ak;chrome.cast.ga.prototype.Bk=function(){};chrome.cast.ga.prototype.removeUpdateListenerWithContext=chrome.cast.ga.prototype.Bk;chrome.cast.ga.prototype.Qq=function(){};chrome.cast.ga.prototype.addMessageListener=chrome.cast.ga.prototype.Qq;chrome.cast.ga.prototype.Rq=function(){};
chrome.cast.ga.prototype.addMessageListenerWithContext=chrome.cast.ga.prototype.Rq;chrome.cast.ga.prototype.Oq=function(){};chrome.cast.ga.prototype.addMediaListener=chrome.cast.ga.prototype.Oq;chrome.cast.ga.prototype.Pq=function(){};chrome.cast.ga.prototype.addMediaListenerWithContext=chrome.cast.ga.prototype.Pq;chrome.cast.ga.prototype.Eu=function(){};chrome.cast.ga.prototype.removeMediaListener=chrome.cast.ga.prototype.Eu;chrome.cast.ga.prototype.Fu=function(){};
chrome.cast.ga.prototype.removeMediaListenerWithContext=chrome.cast.ga.prototype.Fu;chrome.cast.ga.prototype.Gu=function(){};chrome.cast.ga.prototype.removeMessageListener=chrome.cast.ga.prototype.Gu;chrome.cast.ga.prototype.Hu=function(){};chrome.cast.ga.prototype.removeMessageListenerWithContext=chrome.cast.ga.prototype.Hu;chrome.cast.ga.prototype.Ss=function(a){a.sessionId=this.sessionId};chrome.cast.ga.prototype.loadMedia=chrome.cast.ga.prototype.Ss;
chrome.cast.ga.prototype.pu=function(a){a.sessionId=this.sessionId};chrome.cast.ga.prototype.queueLoad=chrome.cast.ga.prototype.pu;var en=function(a,b){if(!b.applications||1!=b.applications.length)return null;var c=b.applications[0];a=cn(a);a=new chrome.cast.ga(c.sessionId,c.appId,c.displayName,c.appImages,a);a.senderApps=c.senderApps;a.namespaces=c.namespaces||[];a.transportId=c.transportId;a.statusText=c.statusText;if(!a.sessionId||!(a.namespaces&&0!=a.namespaces.length||dn(a)))return null;a.receiver.volume=b.volume;"boolean"===typeof b.isActiveInput&&(a.receiver.isActiveInput=b.isActiveInput);return a},fn=function(a){var b=
[];if(!a)return b;a&1&&b.push(chrome.cast.ee.VIDEO_OUT);a&2&&b.push(chrome.cast.ee.VIDEO_IN);a&4&&b.push(chrome.cast.ee.AUDIO_OUT);a&8&&b.push(chrome.cast.ee.AUDIO_IN);a&32&&b.push(chrome.cast.ee.MULTIZONE_GROUP);return b},cn=function(a){var b=bm(am(),a.getId());return new chrome.cast.Fi(b,a.h.friendlyName,fn(a.g))},Xaa=function(a,b){if(a.statusText!=b.statusText)return!0;var c=a.namespaces||[],d=b.namespaces||[];if(c.length!=d.length)return!0;for(var e={Bg:0};e.Bg<c.length;e={Bg:e.Bg},e.Bg++)if(!d.some(function(f){return function(g){return g.name==
c[f.Bg].name}}(e)))return!0;return a.receiver.volume.level!==b.receiver.volume.level||a.receiver.volume.muted!==b.receiver.volume.muted?!0:!1},gn=function(a){Sa(a)?a.forEach(gn):Va(a)&&Object.keys(a).forEach(function(b){null===a[b]?delete a[b]:(Va(a[b])||Sa(a[b]))&&gn(a[b])})},Yaa=function(a){return a.namespaces.some(function(b){return b.name==Al})},dn=function(a){return null!==a&&"MultizoneLeader"==a.appId},hn=function(a){return"E8C28D3C"==a||"00000000-0000-0000-0000-000000000000"==a};var jn=function(a,b,c){this.type=a;this.message=b;this.sequenceNumber=void 0!==c?c:-1;this.timeoutMillis=0;this.clientId=""};var kn=function(a,b){this.l=a;this.g=b;this.j=[];this.h=new Em},mn=function(a,b){return(a=ln(a.g,b))?a.routeId:null};kn.prototype.listen=function(a,b){this.j[a]=b};var on=function(a,b,c,d){nb(nn,"Sending to "+c);nb(nn,JSON.stringify(d));d.clientId=c;a.l.j.re(b,d)},pn=function(a,b,c){var d=ln(a.g,b);d&&d.g?on(a,d.routeId,b,c):a.connect(b).then(function(e){e?(e=mn(a,b))?on(a,e,b,c):nn.K("No route for "+b):nn.K("No connected client "+b)},null)};
kn.prototype.connect=function(a){var b=ln(this.g,a);if(null!=b&&b.g)return Promise.resolve(!0);b=mn(this,a);if(!b)return nn.K("No route for client "+a),Promise.resolve(!1);if(a=this.h.g.get(b,null))return a.Kb.g;a=new Cb;Fm(this.h,new qn(b,a));return a.g};var nn=gb("mr.cast.ApiMessenger"),qn=function(a,b){Dm.call(this,a,3E4);this.Kb=b};q(qn,Dm);qn.prototype.g=function(){this.Kb.resolve(!1)};var rn=function(a,b,c){this.j=a;this.g=b;this.h=c},Zaa=function(a){var b="cast-dial:"+a.j,c=new URLSearchParams;a.g&&c.set("dialPostData",a.g);a.h&&c.set("clientId",a.h);(a=c.toString())&&(b+="?"+a);return b};var sn=function(a,b,c,d,e,f,g,k,m,p){this.m=a;this.g=b||null;this.h=c||null;this.j=d||null;this.l=void 0!==e?e:null;this.F=f||null;this.C=g||null;this.u=k||!1;this.o=m||null;this.D=p||null},tn=function(a,b){return(a=a.match(b+"=([^/]*)"))?a[1]:null},aba=function(a){a=a.match(/__castAppId__=([^/]*)/g);return null==a?[]:Mb(Nb(a,function(b){b=tn(b,"__castAppId__");if(!b)return null;b=b.match($aa);if(!b||0==b.length)return null;var c=[];3==b.length&&b[2]&&(c=b[2].split(","));return{appId:b[1],capabilities:c}}),
function(b){return null!=b})},un=function(a){return Nb(a.m,function(b){return b.appId})},vn=function(a){return a.h?a.h:chrome.cast.zd.TAB_AND_ORIGIN_SCOPED},wn=function(a){var b=a.m.map(function(c){var d="cast:"+c.appId,e=new URLSearchParams;c.capabilities&&0<c.capabilities.length&&e.set("capabilities",c.capabilities.join(","));a.g&&e.set("clientId",a.g);a.h&&e.set("autoJoinPolicy",a.h);a.j&&e.set("defaultActionPolicy",a.j);null!=a.l&&e.set("launchTimeout",String(a.l));a.u&&e.set("invisibleSender",
"true");a.o&&(e.set("broadcastNamespace",a.o),e.set("broadcastId",String(Math.random())));a.D&&e.set("broadcastMessage",encodeURIComponent(JSON.stringify(a.D)));return d+"?"+e.toString()});a.F&&b.push(Zaa(new rn(a.F,a.C,a.g)));return b},bba=function(a,b){a=un(a);var c=xn(b);return Pb(a,function(d){return Vb(c,d)})},yn=function(a){try{var b=new URL(a)}catch(u){return null}if("https:"==b.protocol)if("https:"!=b.protocol||"google.com"!=b.host||"/cast"!=b.pathname)a=null;else{var c=b.hash;if((a=aba(c))&&
0!=a.length){b=tn(c,"__castClientId__");var d=tn(c,"__castAutoJoinPolicy__"),e=tn(c,"__castDefaultActionPolicy__");var f=tn(c,"__castLaunchTimeout__");null==f?f=null:(f=Number(f),f=!isNaN(f)&&0<f?f:null);var g=tn(c,"__dialAppName__"),k=tn(c,"__dialPostData__");var m=tn(c,"__castInvisibleSender__");m=null===m?null:"true"==m;var p=tn(c,"__castBroadcastNamespace__");c=(c=tn(c,"__castBroadcastMessage__"))?JSON.parse(decodeURIComponent(c)):null;a=new sn(a,b,d,e,f,g,k,m,p,c)}else a=null}else if("cast:"==
b.protocol){a=b.pathname;d=b.searchParams.get("capabilities");a={appId:a,capabilities:d?d.split(","):[]};k=b.searchParams;b=k.get("clientId");d=k.get("autoJoinPolicy");e=k.get("defaultActionPolicy");c=Number(k.get("launchTimeout"));if(isNaN(c)||0>=c)c=null;f="true"==k.get("invisibleSender");g=k.get("broadcastNamespace");k=(k=k.get("broadcastMessage"))?JSON.parse(decodeURIComponent(k)):null;a=new sn([a],b,d,e,c,void 0,void 0,f,g,k)}else a=null;return a},xn=function(a){return(a=yn(a))?un(a):null},zn=
function(a){return(a=yn(a))?a.g:null},$aa=/(^\w+)(?:\(([\w, ]*)\))?$/;var cba={Py:0,Ay:1},dba={MC:0,Up:1,VA:2},eba={Xz:0,TIMEOUT:1,FAILED:2},fba={ly:0,CA:1,SEEK:2,zz:3,QB:4,Qv:5},An=function(a){Bb("MediaRouter.Cast.Session.Ended",a,dba)},Bn=function(a){Bb("MediaRouter.Cast.Controller.ActionType",a,fba)},Cn=function(a){Bb("MediaRouter.Cast.Session.Fail",a,eba)};var Dn=function(a,b,c){this.V=gb("mr.MediaRouteController."+a);this.l=new mojo.Binding(mojo.MediaController,this,b);this.h=c;this.g=new mojo.MediaStatus({title:"",description:"",duration:new mojo.TimeDelta({microseconds:0}),current_time:new mojo.TimeDelta({microseconds:0})});this.u=!1;this.l.setConnectionErrorHandler(this.Dn.bind(this));this.h.ptr.setConnectionErrorHandler(this.Dn.bind(this))};h=Dn.prototype;h.Dn=function(){this.eb();this.Bn()};
h.eb=function(){this.u||(this.u=!0,this.l&&(this.l.close(),this.l=null),this.h&&(this.h.ptr.reset(),this.h=null))};h.Bn=function(){};h.play=function(){};h.pause=function(){};h.Nk=function(){};h.setVolume=function(){};h.seek=function(){};h.kr=function(a){a.close();throw Error("Not implemented");};Dn.prototype.connectHangoutsMediaRouteController=Dn.prototype.kr;Dn.prototype.seek=Dn.prototype.seek;Dn.prototype.setVolume=Dn.prototype.setVolume;Dn.prototype.setMute=Dn.prototype.Nk;Dn.prototype.pause=Dn.prototype.pause;
Dn.prototype.play=Dn.prototype.play;var gba=function(a){var b=new URL(a);a={};a.scheme=b.protocol.replace(":","");a.host=b.hostname;b=b.port?Number.parseInt(b.port,10):0;switch(a.scheme){case "http":a.port=b||80;break;case "https":a.port=b||443;break;default:throw Error("Scheme must be http or https");}a.suborigin="";return new mojo.Origin(a)},En=function(a){return new mojo.TimeDelta({microseconds:Math.floor(1E6*a)})};var Fn=function(a,b,c,d){this.type=a;this.mediaSessionId=b;this.requestId=0;this.sessionId=c;this.currentTime=d},Hn=function(a,b,c,d,e){Dn.call(this,"CastRouteController",a,b);this.session=c;this.j=d;this.m=e;this.o=new Date;this.D=new Set;Gn(this);Bn(0)};q(Hn,Dn);
var Gn=function(a){var b=In(a);b&&Jn(a,b);b&&a.m||!a.session.statusText||(a.g.title=a.session.statusText.substring(0,256));a.g.volume=null===a.session.receiver.volume.level?0:a.session.receiver.volume.level;a.g.is_muted=!!a.session.receiver.volume.muted;a.g.can_mute=a.session.receiver.volume.controlType!==chrome.cast.Nl.FIXED;a.g.can_set_volume=a.g.can_mute;if(a.h)a.h.onMediaStatusUpdated(a.g)};h=Hn.prototype;h.Bn=function(){Kn(this.j.g,this.session.sessionId)};
h.play=function(){var a=In(this);this.g.can_play_pause&&a&&this.g.play_state===mojo.MediaStatus.PlayState.PAUSED&&Ln(this.j,this.session,new Fn("PLAY",a.mediaSessionId,this.session.sessionId));Mn(this,1)};h.pause=function(){var a=In(this);this.g.can_play_pause&&a&&this.g.play_state!==mojo.MediaStatus.PlayState.PAUSED&&Ln(this.j,this.session,new Fn("PAUSE",a.mediaSessionId,this.session.sessionId));Mn(this,1)};
h.seek=function(a){var b=In(this);a=a?a.microseconds/1E6:0;var c;if(c=this.g.can_seek&&b&&0<=a)c=this.g.duration,c=a<=(c?c.microseconds/1E6:0);c&&Ln(this.j,this.session,new Fn("SEEK",b.mediaSessionId,this.session.sessionId,a));Mn(this,2)};h.Nk=function(a){this.g.can_mute&&a!==this.g.is_muted&&Nn(this.j,this.session,new chrome.cast.Volume(null,a));Mn(this,3)};h.setVolume=function(a){this.g.can_set_volume&&0<=a&&1>=a&&Nn(this.j,this.session,new chrome.cast.Volume(a));Mn(this,4)};
var In=function(a){return a.session.media.find(function(b){return!b.idleReason})||null},Jn=function(a,b){a.m&&b.media&&b.media.metadata&&b.media.metadata.title&&(a.g.title=b.media.metadata.title.substring(0,256));a.g.can_play_pause=b.supportedMediaCommands.includes(chrome.cast.media.De.PAUSE);a.g.can_seek=b.supportedMediaCommands.includes(chrome.cast.media.De.SEEK);var c=b.playerState;a.g.play_state=c===chrome.cast.media.PlayerState.PLAYING?mojo.MediaStatus.PlayState.PLAYING:c===chrome.cast.media.PlayerState.PAUSED?
mojo.MediaStatus.PlayState.PAUSED:mojo.MediaStatus.PlayState.BUFFERING;a.g.current_time=b.currentTime?En(b.playerState===chrome.cast.media.PlayerState.PLAYING?b.currentTime+(new Date-a.o)/1E3:b.currentTime):En(0);a.g.duration=b.media&&b.media.duration?En(b.media.duration):En(0)},Mn=function(a,b){0==a.D.size&&Bn(5);a.D.has(b)||(Bn(b),a.D.add(b))};Hn.prototype.setVolume=Hn.prototype.setVolume;Hn.prototype.setMute=Hn.prototype.Nk;Hn.prototype.seek=Hn.prototype.seek;Hn.prototype.pause=Hn.prototype.pause;
Hn.prototype.play=Hn.prototype.play;var On=function(a){this.h=a;this.s=gb("mr.cast.SessionLauncher")},hba=function(a,b,c){Bb("MediaRouter.Cast.Session.Type",0,cba);return Raa(a.h,b,c).then(a.g.bind(a,c),function(d){d&&Om==d?Cn(1):Cn(0);throw d;})};On.prototype.g=function(a,b){nb(this.s,"Got launch result from "+a.getId());if("LAUNCH_ERROR"==b.type)throw Cn(2),Error(b.reason);a=en(a,b.status);this.s.info("Launched session: "+a.sessionId);return a};var Pn=function(a){this.g=a;this.s=gb("mr.cast.ReceiverStatusQuerier")},iba=function(a,b){return(new hf(t(a.h,a,b),3500,5)).start().then(null,function(c){a.s.info("Failed to get receiver status from "+b.getId());throw c;})};Pn.prototype.h=function(a){this.s.info("Query receiver status: "+a.getId());return this.g.sendRequest(new Cm,a,yl)};var Qn=function(a,b,c,d,e,f){this.j=a;this.D=b;this.m=c;this.g=d;this.o=e;this.l=f;this.h=new kn(f,c);this.G=new Pn(this.j);this.H=new On(this.j)};Qn.prototype.init=function(){this.m.init();this.h.listen("v2_message",this.C.bind(this));this.h.listen("app_message",this.u.bind(this));this.h.listen("leave_session",this.F.bind(this))};
var Tn=function(a,b,c,d){Rn(a.g,b).slice().forEach(function(e){e!=d&&Sn(a,e,c)})},Sn=function(a,b,c){c.clientId=b;pn(a.h,b,c)},Un=function(a,b,c,d){c={receiver:cn(c),action:d};Sn(a,b,new jn("receiver_action",c))};
Qn.prototype.C=function(a){var b=a.message,c=b.sessionId;if(c){var d=Vn(this.g,c);if(d)if(c=Wn(this.g,c))if(c=this.D.ta(c))switch(b.type){case "STOP":jba(this,a,c);break;case "LOAD":case "PAUSE":case "PLAY":case "SEEK":case "STOP_MEDIA":case "MEDIA_SET_VOLUME":case "MEDIA_GET_STATUS":case "EDIT_TRACKS_INFO":case "QUEUE_LOAD":case "QUEUE_INSERT":case "QUEUE_UPDATE":case "QUEUE_REMOVE":case "QUEUE_REORDER":case "PRECACHE":kba(this,a,c,d);break;case "SET_VOLUME":lba(this,a,c);break;default:Xn.K("Unknown request")}else Yn(this,
a,chrome.cast.Bd.INVALID_PARAMETER,"No receiver");else Yn(this,a,chrome.cast.Bd.INVALID_PARAMETER,"No sink ID");else Yn(this,a,chrome.cast.Bd.INVALID_PARAMETER,"Unknown session ID")}else Yn(this,a,chrome.cast.Bd.INVALID_PARAMETER,"No session ID")};
var Yn=function(a,b,c,d){c=new chrome.cast.Error(c,d);Zn(a,b,c)},Zn=function(a,b,c){pn(a.h,b.clientId,new jn("error",c,b.sequenceNumber))},jba=function(a,b,c){var d=b.message;Ab("MediaRouter.Cast.Session.End");var e=d.sessionId,f=$n(a.g,e);f&&(f.m=!0);f=function(){ym(a,e,b)};a.j.sendRequest(d,c,yl,b.timeoutMillis,b.clientId).then(f,f)},kba=function(a,b,c,d){var e=b.message,f=e.type;f in Bm&&(e.type=Bm[f]);a.j.sendRequest(e,c,Al,b.timeoutMillis,b.clientId,d.transportId).then(function(g){ao(a,d,g);
pn(a.h,b.clientId,new jn("v2_message",g,b.sequenceNumber))},function(g){Zn(a,b,g)})},lba=function(a,b,c){var d=b.message;delete d.sessionId;a.j.sendRequest(d,c,yl,b.timeoutMillis,b.clientId).then(function(){pn(a.h,b.clientId,new jn("v2_message",null,b.sequenceNumber))},function(e){Zn(a,b,e)})};
Qn.prototype.u=function(a){var b=this,c=a.message,d=c.sessionId;if(d){var e=Wn(this.g,d);e?(e=this.D.ta(e))?(d=Vn(this.g,d),Sb(d.namespaces,function(f){return f.name==c.namespaceName})?Mm(this.o,e,c.namespaceName,c.message,a.clientId,d.transportId).then(function(){pn(b.h,a.clientId,new jn("app_message",null,a.sequenceNumber))},function(){Yn(b,a,chrome.cast.Bd.CHANNEL_ERROR,"Channel to receiver not available")}):Yn(this,a,chrome.cast.Bd.INVALID_PARAMETER,"Invalid namespace")):Xn.K("No receiver from sinkId"):
Xn.K("No sinkId from sessionId")}else Xn.K("No sessionId")};
Qn.prototype.F=function(a){var b=this;Xn.info("Leave session");var c=$n(this.g,a.message);if(c){var d=a.clientId,e=ln(this.m,d);if(e){var f=[],g=[],k=e.tabId,m=e.origin,p=e.autoJoinPolicy;c.h.forEach(function(u){var A=ln(b.m,u);p==chrome.cast.zd.TAB_AND_ORIGIN_SCOPED&&k==A.tabId&&m==A.origin||p==chrome.cast.zd.ORIGIN_SCOPED&&m==A.origin?(A.h=!0,f.push(u)):g.push(u)});pn(this.h,d,new jn("leave_session",null,a.sequenceNumber));f.forEach(function(u){(u=ln(b.m,u))&&bo(b.l,u.routeId,!0,!0)});c.h=g}else Xn.K("No client record")}else Xn.K("No session")};
var co=function(a,b,c){Yaa(b)&&a.j.sendRequest(new Cm,c,Al,void 0,void 0,b.transportId).catch(Oa)},tm=function(a,b,c){var d=b.getId();Xn.info("Query status for "+d);iba(a.G,b).then(function(e){eo(a,d,e);c&&(e=fo(a.g,d))&&co(a,e,b)},Oa)},mba=function(a,b){if("*"==b.destinationId)return!0;b=b.destinationId;if(b==a.o.D||null!=ln(a.m,b))return!0;Xn.info("Invalid destination "+b);return!1},pba=function(a,b,c){nb(Xn,function(){return"Cast message: "+JSON.stringify(c)});if(mba(a,c))if(c.namespace_==zl||
c.namespace_==Bl)(b=xm(a.g,b))&&b.g.forEach(function(f){var g=a.l,k=g.h.get(f);k&&k.Sf&&g.j.mi(f,c)});else{var d=JSON.parse(c.data),e=nba(a,d);e=e?e.sourceId:void 0;switch(d.type){case "RECEIVER_STATUS":eo(a,b,d);break;case "MEDIA_STATUS":oba(a,b,c,e)}}else go(a.o,b,c.destinationId,c.sourceId,!1)},nba=function(a,b){a=Gm(a.j.g,b.requestId);if(!a)return null;var c=a.Kb;switch(b.type){case "LAUNCH_ERROR":case "INVALID_REQUEST":case "LOAD_CANCELLED":case "LOAD_FAILED":case "INVALID_PLAYER_STATE":delete b.requestId;
c.reject(new chrome.cast.Error(chrome.cast.Bd.SESSION_ERROR,b.reason||b.type,b));break;default:c.resolve(b)}return a},qba=function(a,b,c){nb(Xn,function(){return"App message: "+JSON.stringify(c)});if(b=fo(a.g,b)){var d;"*"==c.destinationId?d=Rn(a.g,b.sessionId):d=[c.destinationId];var e=new Waa(b.sessionId,c.namespace_,c.data);d.forEach(function(f){pn(a.h,f,new jn("app_message",e))})}else Xn.K("No session for incoming app message")},rba=function(a,b){a.forEach(function(c){c.sessionId=b;var d=c.supportedMediaCommands,
e=[];d&1&&e.push(chrome.cast.media.De.PAUSE);d&2&&e.push(chrome.cast.media.De.SEEK);d&4&&e.push(chrome.cast.media.De.STREAM_VOLUME);d&8&&e.push(chrome.cast.media.De.STREAM_MUTE);c.supportedMediaCommands=e});return a},ao=function(a,b,c){b=b.sessionId;c.sessionId=b;c=rba(c.status,b);sba(a.g,b,c);if((a=$n(a.g,b))&&a.controller&&(a=a.controller,a.o=new Date,(c=In(a))?Jn(a,c):(a.m&&(a.g.title=""),a.g.can_play_pause=!1,a.g.can_seek=!1),a.h))a.h.onMediaStatusUpdated(a.g)},ho=function(a,b){if(b=fo(a.g,b)){b=
b.sessionId;var c=$n(a.g,b);c&&c.m||ym(a,b)}},ym=function(a,b,c){c&&Sn(a,c.clientId,c);(c=$n(a.g,b))&&c.g.slice().forEach(function(d){bo(a.l,d,!0)});tba(a.g,b);io(a.l)},eo=function(a,b,c){nb(Xn,"Receiver status for "+b);var d=c.status;if(d)if(c=a.D.ta(b)){d=en(c,d);var e=xm(a.g,b);e?d?d.sessionId==e.session.sessionId?(b=e.session,Xaa(b,d)&&(nb(Xn,"Updating session "+d.sessionId),e.j&&(b.statusText=d.statusText),b.namespaces=d.namespaces,b.receiver.volume=d.receiver.volume,uba(a.l,e),Tn(a,b.sessionId,
new jn("update_session",b)),e.controller&&Gn(e.controller))):(ho(a,b),An(1),jo(a.l,null,c,null,d)):(ho(a,b),An(1)):d&&jo(a.l,null,c,null,d)}else Ab("MediaRouter.Cast.Error.Sink.Missing.From.Discovery.Service"),Xn.K("Got message from receiver "+b+", but sink is no longer available.")},oba=function(a,b,c,d){if(b=fo(a.g,b))if(c=JSON.parse(c.data))ao(a,b,c),Tn(a,c.sessionId,new jn("v2_message",c),d)},vba=function(a,b){var c=fn(b.g);return(b=Sb(a.m,function(d){return Qb(d.capabilities,function(e){return Vb(c,
e)})}))?b.appId:un(a)[0]},wba=function(a,b,c){var d=yn(b);if(!d)return Promise.reject(Error("Invalid source "+b));var e=vba(d,c),f=new rb("MediaRouter.Cast.Session.Launch");return hba(a.H,new chrome.cast.Il(e,void 0,null==d.l?chrome.cast.timeout.requestSession:d.l),c).then(function(g){Xn.info("Launched session "+g.sessionId+" for appId "+e);f.end("Success");return g},function(g){Xn.error("Failed to session for appId "+e);f.end("Failure");throw g;})};
Qn.prototype.createMediaRouteController=function(a,b,c){a=ko(this.g,a);if(!a)return Error("Session not found for the route");var d=a.session;if(a.controller)return Error("Controller already exists for the route");var e=lo(this,d.sessionId);if(!e)return Error("Sink not found for the route");a.controller=new Hn(b,c,d,this,a.j);co(this,d,e);return null};
var Ln=function(a,b,c){var d=lo(a,b.sessionId);d&&a.j.sendRequest(c,d,Al,0,"",b.transportId).catch(function(e){Xn.K("Failed to send a media control request: "+e)})},Nn=function(a,b,c){c=new bn(c);(b=lo(a,b.sessionId))&&a.j.sendRequest(c,b,yl).catch(function(d){Xn.K("Failed to send a volume control request: "+d)})},lo=function(a,b){return(b=Wn(a.g,b))?a.D.ta(b):null},Xn=gb("mr.cast.ApiHandler");var mo=function(a){return"0F5096E8"==a||"85CDB22F"==a};var no=function(a,b,c,d,e){for(var f=[],g=4;g<arguments.length;++g)f[g-4]=arguments[g];var k=this;this.m=a;this.D=b;this.Wj=c;this.h=d;this.l=f;this.g=!1;this.j=function(m){for(var p=[],u=0;u<arguments.length;++u)p[u-0]=arguments[u];return k.rr.apply(k,n(p))}};h=no.prototype;h.addListener=function(){this.g||(this.g=!0,this.h.addListener.apply(this.h,[this.j].concat(n(this.l))))};h.removeListener=function(){this.g&&(this.h.removeListener(this.j),this.g=!1)};
h.Bh=function(a){for(var b=0;b<arguments.length;++b);return!0};h.rr=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];var d=this;Zi(this.m);if(!this.Bh.apply(this,n(b)))return!1;Ui(this.Wj).then(function(e){return e.handleEvent.apply(e,[d.h].concat(n(b)))});return this.Xi()};h.Ia=function(){return"mr.EventListener."+this.D};h.tb=function(){return[this.g]};h.sb=function(){Jl(this)&&this.addListener()};h.Xi=function(){};var oo=null,po=null,qo=function(){oo||(oo=new no(2,"CastChannelMessageListener","mr.cast.ChannelService",chrome.cast.channel.onMessage));po||(po=new no(1,"CastChannelErrorListener","mr.cast.ChannelService",chrome.cast.channel.onError));return[oo,po]};var xba=function(){},ro=function(a){if(!a.startsWith("urn:x-org.chromium:media:route:"))return null;var b=a.substring(31);if(!b)return null;var c=b.match(/([^/]*)\/([^-/]*)-([^/]*)\/(.*)/);if(!c)return null;b=new xba;b.h=a;a=l(c);a.next();b.g=a.next().value;b.l=a.next().value;b.m=a.next().value;b.j=a.next().value;return b};var yba=function(a,b,c,d,e,f){this.id=a;this.presentationId=b;this.sinkId=c;this.mediaSource=d;this.isLocal=e;this.description=f;this.iconUrl=null;this.allowStop=!0;this.customControllerPath=null;this.supportsMediaRouteController=!1;this.controllerType=mojo&&mojo.RouteControllerType&&mojo.RouteControllerType.kNone;this.forDisplay=!0;this.offTheRecord=!1;this.Sf=e;this.isOffscreenPresentation=!1},so=function(a,b,c,d,e,f){b=d&&dj(d)?a:"urn:x-org.chromium:media:route:"+a+"/"+b+"-"+c+"/"+d;return new yba(b,
a,c,d,e,f)};var to=function(a,b,c,d){c=so(c,"cast",b.getId(),a,d,"");c.supportsMediaRouteController=!0;mojo&&mojo.RouteControllerType&&(c.controllerType=d&&$i(a)&&b.g&1&&mojo.RouteControllerType.kMirroring?mojo.RouteControllerType.kMirroring:mojo.RouteControllerType.kGeneric);return c},uo=function(a,b){var c=b.Db.Fc;c&&(b.description=lj(c),a.displayName="",a.statusText="mirror_desktop"==c.h?"":c.j||"")};var vo=function(a,b,c,d){return{namespace_:a,data:"string"===typeof b?b:JSON.stringify(b),sourceId:c,destinationId:d}};var zba=function(a){this.type="CLOSE";this.reasonCode=a};var wo=function(a){return(a=a.exec(Zd))?a[1]:""},xo=function(){if(af)return wo(/Firefox\/([0-9.]+)/);if(Ee||Fe||De)return Ye;if(ef)return xe()||be("iPad")||be("iPod")?wo(/CriOS\/([0-9.]+)/):wo(/Chrome\/([0-9.]+)/);if(ff&&!(xe()||be("iPad")||be("iPod")))return wo(/Version\/([0-9.]+)/);if(bf||cf){var a=/Version\/(\S+).*Mobile\/(\S+)/.exec(Zd);if(a)return a[1]+"."+a[2]}else if(df)return(a=wo(/Android\s+([0-9.]+)/))?a:wo(/Version\/([0-9.]+)/);return""}(),yo=function(a){return 0<=yd(xo,a)};var Bba=function(a){this.type="CONNECT";this.origin={};this.userAgent=Zd;var b=this.userAgent.indexOf("(")+1;b=this.userAgent.substr(b,this.userAgent.indexOf(")",b)-1-b+1);this.senderInfo={sdkType:2,version:chrome.runtime.getManifest().version,browserVersion:xo,platform:Aba(),systemVersion:b,connectionType:1};this.connType=a?0:2},Aba=function(){switch(Gi()){case "ChromeOS":return 5;case "Windows":return 3;case "Mac":return 4;case "Linux":return 6}return 0};var zo=function(a){if(!chrome.runtime.lastError)return null;var b="chrome.cast.channel.send failed, chrome.runtime.lastError: "+(chrome.runtime.lastError.message||"Unknown error");a&&nb(a,b);return Error(b)};var Ao=function(){this.g=new mm};Ao.prototype.init=function(){Ml(this)};var Bo=function(a,b,c,d,e){if(!pm(a.g,[b.channelId,c,d].join("#"))){var f=vo(xl,new Bba(e),c,d);chrome.cast.channel.send(b,f,a.h.bind(a));a.g.set([b.channelId,c,d].join("#"),e)}};Ao.prototype.h=function(){zo(Cba)};
var Jaa=function(a,b){a.g.Qb().forEach(function(c){c.split("#")[0]==b.channelId.toString()&&a.g.remove(c)})},Iaa=function(a,b,c){a.g.forEach(function(d,e){var f=e.split("#");f[0]==b.channelId.toString()&&(Bo(a,c,f[1],f[2],d),a.g.remove(e))})};Ao.prototype.Ia=function(){return"cast.VirtualConnectionManager"};Ao.prototype.tb=function(){var a=qm(this.g);return[new Dba(a)]};Ao.prototype.sb=function(){var a=Jl(this);if(a)for(var b in a.g)this.g.set(b,a.g[b])};Pa(Ao);
var Cba=gb("mr.cast.VirtualConnectionManager"),Dba=function(a){this.g=a};var Co=function(a,b){this.m=b;this.D=a;this.h=new mm;this.g=new mm;this.j=Ao.ib();this.ta=null;this.l=new mm};q(Co,Ri);Co.prototype.handleEvent=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];a==chrome.cast.channel.onMessage?this.u.apply(this,n(c)):a==chrome.cast.channel.onError&&this.o.apply(this,n(c))};Co.prototype.init=function(){this.j.init();Ml(this);Xi("mr.cast.ChannelService",this);qo().forEach(function(a){return a.addListener()})};
var Mm=function(a,b,c,d,e,f){e=e||a.D;f=f||"receiver-0";var g=Am(a,b);return g?Eba(a,g,c,d,e,f):Promise.reject("Channel not found for "+b.getId())},go=function(a,b,c,d,e){if(b=a.h.get(b))a=a.j,pm(a.g,[b.channelId,c,d].join("#"))&&(a.g.remove([b.channelId,c,d].join("#")),c=vo(xl,new zba(e?5:0),c,d),chrome.cast.channel.send(b,c,a.h.bind(a)))};
Co.prototype.u=function(a,b){var c=this.g.get(a.channelId);if(c){var d=this.ta(c);if(d){if(Dl.hasOwnProperty(b.namespace_)){var e=JSON.parse(b.data);switch(e.type){case "CLOSE":this.j.g.remove([a.channelId,b.destinationId,b.sourceId].join("#"));return;case "RPC":break;default:nb(sm,function(){return"Got message "+(e.type||e.responseType)+" from "+d.getId()})}}else nb(sm,"Got message in "+b.namespace_+" from "+d.getId());Fba(this.m,d,b)}else sm.K("Got message for unknown receiver (receiverId="+c+").")}else sm.K("Got message for unknown channel (channelId="+
a.channelId+").")};var Do=function(a,b){var c=a.g.get(b.channelId);c&&(a.g.remove(b.channelId),a.h.remove(c))};Co.prototype.o=function(a,b){sm.K(function(){return"Channel error: "+JSON.stringify(a)+(b?", "+JSON.stringify(b):"")});Do(this,a)};
var Am=function(a,b){b=b.getId();(a=a.h.get(b))||sm.info("Channel not found for receiver: "+b);return a},Eba=function(a,b,c,d,e,f){Bo(a.j,b,e,f,0==f.indexOf("receiver-0"));gn(d);var g=vo(c,d,e,f);"object"===typeof d&&"RPC"==d.type||nb(sm,function(){return"Channel is sending message: "+JSON.stringify(g)});return new Promise(function(k,m){chrome.cast.channel.send(b,g,function(p){p?p.errorState?(m(Error("Failed to send message")),Do(a,p)):k(!0):(p=zo(sm||void 0),m(p))})})};Co.prototype.Ia=function(){return"cast.ChannelService"};
Co.prototype.tb=function(){return[new Gba(qm(this.h),qm(this.g),qm(this.l))]};Co.prototype.sb=function(){var a=Jl(this);a&&(lm(this.h,a.h),lm(this.g,a.g),lm(this.l,a.j))};var sm=gb("mr.cast.ChannelService"),Gba=function(a,b,c){this.h=a;this.g=b;this.j=c};var Hba=function(a,b,c,d,e,f){this.routeId=a;this.clientId=b;this.appIds=c;this.autoJoinPolicy=d;this.origin=e;this.tabId=f;this.h=this.g=!1},Eo=function(){this.g=[]};Eo.prototype.init=function(){Ml(this)};Eo.prototype.Ca=function(){return this.g.length};var ln=function(a,b){return Sb(a.g,function(c){return c.clientId==b})},Fo=function(a,b){return Sb(a.g,function(c){return c.routeId==b})},Iba=function(a,b){a.g=Mb(a.g,function(c){return c.clientId!=b})};Eo.prototype.Ia=function(){return"cast.ClientRecords"};
Eo.prototype.tb=function(){return[new Jba(this.g)]};Eo.prototype.sb=function(){var a=Jl(this);a&&(this.g=a.g)};var Jba=function(a){this.g=a};var Kba=function(){this.requestId=0;this.type="GET_APP_AVAILABILITY";this.appId=[]};var Go=function(a,b){this.l=a;this.h=b;this.j=new Vm;this.g=new mm};Go.prototype.init=function(){Ml(this)};var Lba=function(a,b){var c=a.g.get(b);c&&(c.yk--,0<c.yk||(jm(a.h.g.Yb(!1),function(d){switch(fm(d,b)){case "available":d.qc[b]="available_rescan";break;case "unavailable":d.qc[b]="unavailable_rescan"}}),a.g.remove(b)))};h=Go.prototype;
h.un=function(a){var b=this;jm(this.g.Yb(!0),function(c){a:{switch(fm(a,c)){case "unknown":case "available_rescan":case "unavailable_rescan":var d=!0;break a}d=!1}if(d){var e=a.getId()+":"+c;b.j.contains(e)||(b.j.add(e),d=function(){b.j.remove(e)},(new hf(b.fr.bind(b,a,c),5500,3)).start().then(b.Ko.bind(b,a,c),function(){b.s.error("Failed to get app availability response for "+a.getId()+", appId "+c+" after 3 attempts.");b.Ko(a,c,"unknown")}).then(d,d))}})};
h.Ko=function(a,b,c){c!=fm(a,b)&&(this.s.info(b+" on "+a.getId()+" is "+c),a.qc[b]=c,um(this.h.l,a))};
h.fr=function(a,b){var c=this,d=new Kba;d.appId=[b];var e=new rb("MediaRouter.Cast.App.Availability");return this.l.sendRequest(d,a,yl,5E3).then(function(f){e.end("Success");nb(c.s,function(){return"App availability response "+JSON.stringify(f)});for(var g in f.availability){if("APP_AVAILABLE"==f.availability[g])return"available";if("APP_UNAVAILABLE"==f.availability[g])return"unavailable"}return"unknown"},function(f){e.end("Failure");c.s.error("checkAppAvailability_ failed for "+a.getId()+", appId "+
b);throw f;})};h.Ia=function(){return"cast.AppDiscoveryService"};h.tb=function(){return[new Mba(qm(this.g))]};h.sb=function(){var a=Jl(this);a&&lm(this.g,a.g)};h.s=gb("mr.cast.AppDiscoveryService");var Mba=function(a){this.g=a};var Nba=chrome.i18n.getMessage("4528089202128275824");chrome.i18n.getMessage("2810417817914017289");chrome.i18n.getMessage("3413021810593924462");chrome.i18n.getMessage("7603034707785674700");chrome.i18n.getMessage("8009014317872238527");chrome.i18n.getMessage("8636962961150071298");chrome.i18n.getMessage("1802762746589457177");var Ho=function(a,b){this.h=[];this.g=[];this.sinkId=a;this.session=b;this.D=this.l=null;this.offTheRecord=this.m=!1;this.controller=null;this.j=!0},Io=function(){this.s=gb("mr.cast.SessionRecords");this.g=[]};Io.prototype.init=function(){Ml(this)};
var tba=function(a,b){a.s.info("Removing session "+b);Kn(a,b);a.g=Mb(a.g,function(c){return c.session.sessionId!=b})},Rn=function(a,b){return(a=$n(a,b))?a.h:[]},fo=function(a,b){return(a=xm(a,b))?a.session:null},Oba=function(a,b){return Sb(a.g,function(c){return Vb(c.h,b)})},ko=function(a,b){return Sb(a.g,function(c){return Vb(c.g,b)})},Pba=function(a,b){return Sb(a.g,function(c){return null!=Sb(c.g,function(d){return ro(d).g==b})})},xm=function(a,b){return Sb(a.g,function(c){return c.sinkId==b||
c.l==b})},$n=function(a,b){return Sb(a.g,function(c){return c.session.sessionId==b})},Wn=function(a,b){return(a=$n(a,b))?a.sinkId:null},Vn=function(a,b){return(a=$n(a,b))?a.session:null},sba=function(a,b,c){var d=Vn(a,b);d&&(a=Mb(c,function(e){return e.playerState!=chrome.cast.media.PlayerState.IDLE}),a.forEach(function(e){if(!e.media){var f=Sb(d.media,function(g){return g.mediaSessionId==e.mediaSessionId});f&&(e.media=f.media)}}),d.media=a)};Io.prototype.Ia=function(){return"cast.SessionRecords"};
Io.prototype.tb=function(){return[new Qba(this.g)]};Io.prototype.sb=function(){var a=Jl(this);if(a)for(var b=0;b<a.g.length;b++){var c=a.g[b],d=new Ho(c.sinkId,c.session);d.h=c.h;d.g=c.g;d.m=c.m;d.D=c.D;d.l=c.l;d.j=c.j;this.g.push(d)}};
var Kn=function(a,b){(a=$n(a,b))&&a.controller&&(a.controller.eb(),a.controller=null)},Qba=function(a){var b=[];a=l(a);for(var c=a.next();!c.done;c=a.next()){c=c.value;var d=new Ho(c.sinkId,c.session);d.h=c.h;d.g=c.g;d.m=c.m;d.D=c.D;d.l=c.l;d.offTheRecord=c.offTheRecord;d.j=c.j;b.push(d)}this.g=b};var Jo=function(a,b,c){var d=Error.call(this);this.message=d.message;"stack"in d&&(this.stack=d.stack);this.name="RouteRequestError";this.message=b||"";if(c)this.stack=c;else if(Error.captureStackTrace)Error.captureStackTrace(this,Jo);else if(b=Error().stack)this.stack=b;this.errorCode=a};q(Jo,Error);var Ko=function(a,b){this.sinks=a;this.origins=b||null},Lo=new Ko([]);var Mo=function(a){this.C="sender-"+ve();this.h=new mm;this.u=null;Ml(this);this.j=a;this.o=new Eo;this.l=new Io;this.F=new Co(this.C,this);this.g=new rm(this.F,this);this.G=new Jm(this.F,this.C);this.D=null;this.m=new Qn(this.G,this.g,this.o,this.l,this.F,this);this.H=new Ym(this.g,this.G)};h=Mo.prototype;h.getName=function(){return"cast"};
h.initialize=function(a){a=a&&"boolean"===typeof a.enable_cast_sink_query?a.enable_cast_sink_query:!0;this.s.info("Query enabled: "+a);this.G.init();this.l.init();this.m.init();this.F.init();this.g.init();a&&(this.D=new Go(this.G,this.g),this.D.init())};h.Rd=function(){return this.h.Na()};
h.Qg=function(a){var b=this;if(null!=No(a))return new Ko([]);var c=new Vm;Oo(a).forEach(function(d){Maa(b.g,d).map(function(e){return e.h}).forEach(function(e){c.add(e)})});return new Ko(c.Na(),-1!=a.indexOf("0F5096E8")?ej:null)};
h.startObservingMediaSinks=function(a){var b=this,c=No(a);c?(this.s.info("Received broadcast request "+a),jm(this.g.g.Yb(!1),function(d){b.G.sendMessage(c,d,Cl).catch(function(e){b.s.error("Broadcast failed "+e.message)})})):this.D&&Oo(a).forEach(function(d){var e=b.D,f=e.g.get(d);f?f.yk++:e.g.set(d,{yk:1});e.s.info("Scanning sinks for app availability");jm(e.h.g.Yb(!1),e.un,e)})};h.stopObservingMediaSinks=function(a){var b=this;null!=No(a)||this.D&&Oo(a).forEach(function(c){Lba(b.D,c)})};
h.startObservingMediaRoutes=function(){};h.stopObservingMediaRoutes=function(){};h.ta=function(a){return(a=this.g.ta(a))?a.h:null};
var Po=function(a,b,c){a.s.error("Error launching.",c);bo(a,b.id,!1,!0,"error");c=new si(Nba,"warning");wi(c,b.id);xi(c,b.sinkId);a.j.qf(c)},So=function(a,b,c,d,e,f,g,k){am().h=new Yl(c.Kc,c.gc());var m=to(b,c,d,!0);m.forDisplay=!1;m.offTheRecord=e;a.h.set(m.id,m);a.j.pg(a,m);io(a);(e=yn(b))&&e.g&&Qo(a,e,m.id,g,k);return new Promise(function(p,u){bj(b)||dj(b)?(m.Db={tabId:k,sessionId:"",vg:c.gc()||"",we:c.Kc||"",fv:c.h.friendlyName||""},dj(b)&&(m.isOffscreenPresentation=!0),a.j.Lj(a,m,d,function(A){return Ci(Ro(a,
b,c,d,f,g,k,A))}).g.then(function(){var A=ko(a.l,m.id);A.j=!1;uo(A.session,m);A.controller&&(A.controller.m=!1,Gn(A.controller));p(m)},function(A){Po(a,m,A);u(A)})):Ro(a,b,c,d,f,g,k,m).then(function(){p(m)},function(A){Po(a,m,A);u(A)})})},Ro=function(a,b,c,d,e,f,g,k){return wba(a.m,To(b,c,e),c).then(function(m){jo(a,b,c,d,m,f,g,k);return k})};
Mo.prototype.createRoute=function(a,b,c,d,e,f,g){var k=this,m=this.g.ta(b);if(!m)return Bi(Error("No sink with ID "+b));var p=zn(a);if(p){setTimeout(function(){Un(k.m,p,m,chrome.cast.Eg.CAST)},0);var u=function(){return So(k,a,m,c,d,e,f,g)},A=ln(this.o,p);if(A)return Ci(this.terminateRoute(A.routeId).then(u,u));if(f&&g&&(b=Uo(this,a,f,g,d,e,b)))return b}return Ci(So(this,a,m,c,d,e,f,g))};
var bo=function(a,b,c,d,e){d=void 0===d?!1:d;e=void 0===e?"closed":e;a.s.info("Remove route "+b);var f=Fo(a.o,b);if(f){c=c||f.h;var g=f.clientId;a.s.info("Remove client "+g);for(var k=a.l,m=0;m<k.g.length;m++)bc(k.g[m].h,g);Iba(a.o,g)}if(g=ko(a.l,b))bc(g.g,b),Vo(a,g.g);if(k=a.h.get(b))if(k.Sf&&g&&(go(a.F,k.sinkId,f?f.clientId:a.C,g.session.transportId,c),k.forDisplay&&f&&(a.u={Qf:f,mo:g})),a.h.remove(b),a.j.eh(k),io(a),d)a.j.onPresentationConnectionClosed(b,e,"Remove route");else a.j.onPresentationConnectionStateChanged(b,
"terminated")},uba=function(a,b){b.g.forEach(function(c){if(c=a.h.get(c)){var d=b.session;if(c.forDisplay){var e=mo(d.appId);e&&!c.isLocal?(c.description=d.statusText||"",d.displayName="",d.statusText=""):e||(c.description=d.statusText||d.displayName);b.controller&&Gn(b.controller)}a.j.vf(c)}})},Rba=function(a,b){Pb(b,function(c){c=a.h.get(c,null);if(!c||!c.mediaSource)return!1;var d=yn(c.mediaSource);d=d?d.u:!1;return c.isLocal&&!d})&&Kb(b,function(c){if(c=a.h.get(c,null))c.isLocal=!0})},Vo=function(a,
b){var c=[],d=[],e=null;b.forEach(function(f){if(f=a.h.get(f)){f.forDisplay=!1;var g=yn(f.mediaSource);g&&Sb(un(g),hn)||(f.Sf?(g=g?vn(g):null,e||g==chrome.cast.zd.CUSTOM_CONTROLLER_SCOPED||(c.push(f),e=f.sinkId)):e&&e!=f.sinkId?c.push(f):d.push(f))}});Kb(0<c.length?c:d,function(f){f.forDisplay=!0})},Qo=function(a,b,c,d,e){var f=b.g;if(f&&!ln(a.o,f)){a.s.info("Add client "+f);var g=un(b);a.o.g.push(new Hba(c,f,g,vn(b),d||null,void 0!==e?e:null))}},jo=function(a,b,c,d,e,f,g,k){var m=xm(a.l,c.getId());
if(!m){var p=a.l;m=c.getId();p.s.info("Adding new session: "+m+", "+e.sessionId);var u=$n(p,e.sessionId);u?(dn(e)?(u.D=e,u.l=m):dn(u.session)&&(u.D=u.session,u.l=u.sinkId,u.session=e,u.sinkId=m),m=u):(m=new Ho(m,e),p.g.push(m))}k&&k.isLocal&&k.Db&&(m.j=!1);var A=null!=b;if(!A&&hn(e.appId))return null;null==b?(u=new sn([{appId:e.appId,capabilities:e.capabilities}]),b=wn(u)[0]):u=yn(b);if(p=k){if(!a.h.get(p.id))return a.s.K("Route "+p.id+" not added"),p}else p=to(b,c,d||e.sessionId,A),a.h.set(p.id,
p);d=p.id;a.s.info("Add route "+d);b=null;u&&(b=u.g,Qo(a,u,d,f,g));Vb(m.g,d)||m.g.push(d);p.Sf&&(f=a.F,g=b||a.C,d=e.transportId,u=!(u&&u.u),(A=Am(f,c))&&Bo(f.j,A,g,d,u));m.offTheRecord=p.offTheRecord;f=m.g;Rba(a,f);Vo(a,f);f=p;g=e.sessionId;mo(e.appId)?f.isLocal&&g&&f.Db?f.Db.sessionId=g:(f.description=e.statusText||"",e.displayName="",e.statusText=""):f.description=e.statusText||e.displayName;k?a.j.vf(p):a.j.pg(a,p);io(a);if(k=b)Vb(m.h,b)?k=!1:(m.h.push(b),k=!0);k&&(a=a.m,pn(a.h,b,new jn("new_session",
e)),co(a,e,c));return p};
Mo.prototype.terminateRoute=function(a){var b=this,c=this.h.get(a);if(!c)return Promise.reject(new Jo(3,"Route in Cast provider not found for routeId  "+a));var d=ko(this.l,a);if(!d)return bo(this,a,!0),Promise.resolve();var e=d.session.sessionId,f=this.g.ta(c.sinkId);if(!f)return ym(this.m,e),Promise.resolve();(a=Fo(this.o,a))&&Un(this.m,a.clientId,f,chrome.cast.Eg.STOP);An(0);return new Promise(function(g){var k=function(){ho(b.m,f.getId());g()};b.G.sendRequest(new Qaa(e),f,yl).then(k,k)})};
var Sba=function(a,b){var c=null;km(a.h.Yb(!1),function(f){if(!f.Sf)return!1;var g=a.g.ta(f.sinkId);if(!g||!bba(b,To(f.mediaSource,g)))return!1;c=f;return!0});if(!c||!c.mediaSource)return null;var d=zn(c.mediaSource);if(!d)return null;var e=ln(a.o,d);return e?(d=Oba(a.l,d))?{Qf:e,mo:d}:null:null},Uo=function(a,b,c,d,e,f,g){var k=null;km(a.h.Yb(!1),function(p){var u=p.Db;return u&&null!=u.tabId&&u.tabId==d&&$i(p.mediaSource)?(k=p,!0):!1});if(!k)return null;var m=function(){return a.createRoute(b,g||
k.sinkId,"",e,f,c,null==d?void 0:d)};return Ci(a.terminateRoute(k.id).then(m,m))};h=Mo.prototype;h.connectRouteByRouteId=function(a,b,c,d,e){if(!yn(a))return Bi(Error("Unsupported presentation URL"));if(!b)return Bi(Error("No routeId"));b=ro(b);b=$n(this.l,b.g);if(!b)return Bi(Error("No matching route"));var f=this.g.ta(b.sinkId);return f?(a=jo(this,a,f,c,b.session,d,e))?Ai(a):Bi(Error("Failed to create route")):Bi(Error("No sink"))};
h.joinRoute=function(a,b,c,d,e,f){var g=yn(a);if(!g)return Bi(Error("Unsupported presentation URL"));if(b==chrome.cast.kl){a:{var k=Sba(this,g);if(!k){if(!this.u||this.u.Qf.origin!=e||this.u.Qf.tabId!=f){k=null;break a}k=this.u}switch(vn(g)){case chrome.cast.zd.PAGE_SCOPED:k=null;break a;case chrome.cast.zd.ORIGIN_SCOPED:if(e!=k.Qf.origin){k=null;break a}break;case chrome.cast.zd.TAB_AND_ORIGIN_SCOPED:if(e!=k.Qf.origin||f!=k.Qf.tabId){k=null;break a}}k=$n(this.l,k.mo.session.sessionId)}if(!k&&(g.j?
g.j:chrome.cast.Fh.CREATE_SESSION)!=chrome.cast.Fh.CAST_THIS_TAB&&(d=Uo(this,a,e,f,c,d)))return d}else k=Wo(this,b);if(!k)return Bi(Error("No matching route"));if(k.offTheRecord!=c)return Bi(Error("Off the record mismatch"));d=this.g.ta(k.sinkId);if(!d)return Bi(Error("No sink"));a=jo(this,a,d,b,k.session,e,f);a.offTheRecord=c;return Ai(a)};h.detachRoute=function(a){bo(this,a,!1,!0)};
h.bg=function(a){var b=this.g.ta(a);if(!b)throw Error("Cannot mirror with no sink.");var c=new qj;b=b.g;b&1||(c.shouldCaptureVideo=!1);b&4||(c.shouldCaptureAudio=!1);c.shouldCaptureAudio&&!c.shouldCaptureVideo&&(c.minLatencyMillis=c.maxLatencyMillis,c.animatedLatencyMillis=c.maxLatencyMillis);c.senderSideLetterboxing=!0;rj(c);Object.freeze(c);this.s.info(function(){return"Settings for "+a+": "+pj(c)});if(!c.shouldCaptureAudio&&!c.shouldCaptureVideo)throw Error("Cannot start mirroring without video or audio capture");
return c};h.ag=function(){return"cast_streaming"};h.ni=function(a){var b=this.h.get(a);b&&b.Db&&b.Db.Fc&&(a=ko(this.l,a))&&(uo(a.session,b),a.controller&&Gn(a.controller))};
h.sendRouteMessage=function(a,b,c){var d=this;if(!c)return new Promise(function(k,m){"string"!==typeof b&&m(Error("Cannot send non-string messages via ApiHandler."));m=d.m.h;nb(nn,"Received: "+b);var p=JSON.parse(b),u=p.clientId;"client_connect"==p.type?(nb(nn,"App "+u),(p=ln(m.g,u))?(p.g=!0,(m=Gm(m.h,p.routeId))&&m.Kb.resolve(!0)):nn.K("Client not found "+u)):mn(m,u)?(m=m.j[p.type])&&m(p):nn.K("No route for "+u);k()});var e=ko(this.l,a);if(!e)return Promise.reject(Error("Not managing the route "+
a));var f=this.g.ta(e.sinkId);if(!f)return Promise.reject(Error("Sink no longer accessible"));var g=(a=Fo(this.o,a))?a.clientId:this.C;return new Promise(function(k){Mm(d.F,f,c.namespace,b,g,e.session.transportId).then(k,k)})};h.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};h.Jg=function(a,b){var c=this.g.ta(b);if(!c)return!1;if(!this.D)return!0;a=To(a,c);return(a=xn(a))&&0!=a.length?Pb(a,function(d){return El(fm(c,d))}):!1};
h.Pf=function(a,b,c){var d=Oo(a);return d&&0!=d.length?b==chrome.cast.kl?!0:c&&c.mediaSource?(a=xn(c.mediaSource),Pb(a,function(e){return Vb(d,e)})):void 0==b||Wo(this,b)?!0:!1:!1};
var To=function(a,b,c){return yn(a)?a:bj(a)||dj(a)?(a={appId:0==(b.g&1)?"85CDB22F":"0F5096E8",capabilities:fn(b.g)},wn(new sn([a],void 0,void 0,void 0,c))[0]):a},Oo=function(a){var b=[],c=yn(a);if(c)b=un(c);else if(bj(a)||dj(a))aj(a)||b.push("85CDB22F"),b.push("0F5096E8");return b},No=function(a){var b=yn(a);if(!b)return null;a=Oo(a);var c=b.o||"";b=b.D;return c&&b?new Oaa(a,c,JSON.stringify(b)):null},Wo=function(a,b){return 0==b.indexOf(chrome.cast.El)?$n(a.l,b.substr(chrome.cast.El.length)):Pba(a.l,
b)},Fba=function(a,b,c){var d=a.H;if(Zm(d)&&Dl.hasOwnProperty(c.namespace_)){var e=b.gc();if(e){var f=JSON.parse(c.data);if("RECEIVER_STATUS"===f.type){var g=f.status&&f.status.applications&&f.status.applications[0],k=f=null;g&&(g.appId&&(f=g.appId),g.sessionId&&(k=g.sessionId));g=d.h.get(e);d.h.set(e,new ul(e,f,k));g&&g.appId===f||$m(d)}}}a=a.m;b=b.getId();Dl.hasOwnProperty(c.namespace_)?pba(a,b,c):qba(a,b,c)},um=function(a,b){a.D&&a.D.un(b);zm(a.H);a.j.td()};h=Mo.prototype;h.Ia=function(){return"cast.Provider"};
h.tb=function(){return[new Tba(this.C,qm(this.h),this.u)]};h.sb=function(){var a=Jl(this);a&&(this.C=a.j,lm(this.h,a.h),this.u=a.g)};h.searchSinks=function(){return db()};h.createMediaRouteController=function(a,b,c){return(a=this.m.createMediaRouteController(a,b,c))?Promise.reject(a):Promise.resolve()};h.provideSinks=function(a){Kaa(this.g,a)};var io=function(a){var b=a.Rd().some(function(c){return c.isLocal});a.j.sg(a.Ia(),b)};Mo.prototype.s=gb("mr.CastProvider");
var Tba=function(a,b,c){this.j=a;this.h=b;this.g=c};var Xo=function(){this.g=[]};Xo.prototype.listen=function(a,b,c){this.g.push({type:a,fd:b,target:c})};var Uba=function(a,b,c){var d=a.g.findIndex(function(e){return"internal_message"==e.type&&e.fd==b&&e.target==c});-1!=d&&a.g.splice(d,1)},Vba=function(a,b){a.g.forEach(function(c){c.type==b.type&&Promise.resolve().then(function(){return c.fd.call(c.target,b)})})};var Wba={SUCCESS:0,bq:1,Rv:2,Sv:3,IC:4,vB:5},Xba={SUCCESS:0,wB:1,bq:2,YB:3},Yba={SUCCESS:0,rA:1,wy:2},Yo=function(a){Bb("MediaRouter.Dial.CreateRoute",a,Wba)},Zo=function(a){Bb("MediaRouter.Dial.TerminateRoute",a,Xba)},$o=function(a){Bb("MediaRouter.Dial.ParseMessage",a,Yba)};var ap=function(a,b,c,d){b="["+b+"]: "+c+" "+d.responseURL+" => "+d.status+" ("+d.statusText+")";200<=d.status&&299>=d.status?a.info(b):nb(a,b)};var Zba=function(){this.name="unknown";this.state="error";this.g=null;this.allowStop=!0;this.resource=null;this.extraData={}},bp=function(){var a=Error.call(this);this.message=a.message;"stack"in a&&(this.stack=a.stack)};q(bp,Error);var dp=function(a){if(void 0===b){cp||(cp=new kf(10,2E3));var b=cp}this.h=a;this.g=b;this.s=gb("mr.dial.Client")};
dp.prototype.launchApp=function(a,b){var c=this;return this.g.send(ep(this,a),"POST",b,{timeoutMillis:15E3}).then(function(d){return fp(c,"launchApp","POST",d)})};
var hp=function(a,b){return gp(a,b).then(function(c){return c.resource?c.resource:(a.s.K("stopApp: Resource path for not available for app "+b+": using fallback path."),"run")},function(){a.s.K("stopApp: getAppInfo failed: using fallback path.");return"run"}).then(function(c){return a.g.send(ep(a,b)+"/"+c,"DELETE")}).then(function(c){return fp(a,"stopApp","DELETE",c)})},gp=function(a,b){return a.g.send(ep(a,b),"GET",void 0,{yn:3}).then(function(c){ap(a.s,"GetAppInfo","GET",c);if(!(200<=c.status&&
299>=c.status)){if(404==c.status)throw new bp;throw Error("Response error: "+c.status);}c=c.responseText;c=(new DOMParser).parseFromString(c,"text/xml");c=c.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","parsererror").length?null:c;if(!c)throw a.s.info("Invalid or empty response"),Error("Invalid or empty response");var d=c.getElementsByTagName("service");if(!d||1!=d.length)throw a.s.info("Invalid GET response (invalid service)"),Error("Invalid GET response (invalid service)");c=new Zba;for(var e=
0,f=d[0].childNodes.length;e<f;e++){var g=d[0].childNodes[e];if("state"==g.nodeName){a:switch(g.textContent){case "running":g="running";break a;case "stopped":g="stopped";break a;default:g="error"}c.state=g}else"name"==g.nodeName?c.name=g.textContent:"link"==g.localName?c.resource=g.getAttribute("href"):"options"==g.nodeName?c.allowStop="false"!=g.getAttribute("allowStop"):c.extraData[g.nodeName]=g.innerHTML}if("unknown"==c.name)throw a.s.info("GET response missing name value"),Error("GET response missing name value");
if(c.name!=b)throw a.s.info("GET app name mismatch"),Error("GET app name mismatch");if("error"==c.state)throw a.s.info("GET response missing state value"),Error("GET response missing state value");if((d=/installable=(.+)/.exec(c.state))&&d[1])c.state="installable",c.g=d[1];else if("running"!=c.state&&"stopped"!=c.state)throw a.s.info("GET response has invalid state value"),Error("GET response has invalid state value");return c})},ep=function(a,b){a=a.h.fe;"/"!=a.charAt(a.length-1)&&(a+="/");return a+
b},fp=function(a,b,c,d){return new Promise(function(e,f){ap(a.s,b,c,d);200<=d.status&&299>=d.status?e():f(Error(d.statusText))})},cp=null;var $ba=function(a,b){this.Tc=a;this.appName=b};var ip=function(a){this.g=new Map;this.h=a};ip.prototype.init=function(){Ml(this)};ip.prototype.clear=function(){this.g.clear()};ip.prototype.add=function(a){if(!this.g.get(a.Tc.id)){this.g.set(a.Tc.id,a);var b=this.h;jp(b);b.l.pg(b,a.Tc)}};var kp=function(a,b){a=l(a.g);for(var c=a.next();!c.done;c=a.next())if(c=l(c.value),c.next(),c=c.next().value,c.Tc.sinkId==b)return c;return null},mp=function(a,b){var c=a.g.get(b);c&&(a.g.delete(b),lp(a.h,c))};
ip.prototype.Rd=function(){return Array.from(this.g.values(),function(a){return a.Tc})};ip.prototype.Ia=function(){return"dial.ActivityRecords"};ip.prototype.tb=function(){return[Array.from(this.g)]};ip.prototype.sb=function(){var a=Jl(this);a&&(this.g=new Map(a))};var np=function(a){this.j=a;this.s=gb("mr.dial.SinkDiscoveryService");this.g=new Map;this.h={Ig:0,Yg:0};this.l=0};np.prototype.init=function(){Ml(this)};
var cca=function(a,b){a.s.info("addSinks returned "+b.length+" sinks");nb(a.s,function(){return"....the list is: "+JSON.stringify(b)});var c=new Set(a.g.keys());b.forEach(function(f){var g=f.sink_id,k=f.extra_data.dial_media_sink,m=aca.test(k.model_name);f=new cm(f.name,g);f.rc=k.ip_address.address_bytes?k.ip_address.address_bytes.join("."):k.ip_address.address.join(".");f.fe=k.app_url.url;f.Kc=k.model_name;f.Re=!m;bca(a,f);c.delete(f.getId())});var d=[];c.forEach(function(f){var g=a.g.get(f);d.push(g);
a.g.delete(f)});0<d.length&&a.j.Kj(d);var e=a.g.size;a.h={Ig:e,Yg:e}},bca=function(a,b){nb(a.s,"mayAddSink, id = "+b.getId());var c=a.g.get(b.getId());c?c.update(b)&&(nb(a.s,"Updated sink "+c.getId()),a.j.gi(c)):(nb(a.s,function(){return"Adding new sink "+b.getId()+": name = "+(b.Lc.friendlyName+(b.rc?", ip = "+b.rc:"")+(b.Kc?", model = "+b.Kc:"")+", apps = "+JSON.stringify(b.qc))}),a.g.set(b.getId(),b),a.j.Jj(b))};np.prototype.ta=function(a){return this.g.get(a)||null};
var eca=function(a,b){var c=[];a.g.forEach(function(d){"available"==dm(d,b)&&c.push(d.Lc)});return new Ko(c,dca[b])};np.prototype.lf=function(){return this.h};np.prototype.Ia=function(){return"dial.DialSinkDiscoveryService"};np.prototype.tb=function(){return[new fca(Array.from(this.g),this.h),{deviceCountMetricsRecordTime:this.l}]};
np.prototype.sb=function(){var a=Jl(this);if(a){for(var b=l(a.sinks),c=b.next();!c.done;c=b.next())c=c.value,this.g.set(c[0],Faa(c[1]));this.h=a.deviceCounts}if(a=Kl(this))this.l=a.deviceCountMetricsRecordTime};
var dca={YouTube:"https://tv.youtube.com https://tv-green-qa.youtube.com https://tv-release-qa.youtube.com https://web-green-qa.youtube.com https://web-release-qa.youtube.com https://www.youtube.com".split(" "),Netflix:["https://www.netflix.com"],Pandora:["https://www.pandora.com"],Radio:["https://www.pandora.com"],Hulu:["https://www.hulu.com"],Vimeo:["https://www.vimeo.com"],Dailymotion:["https://www.dailymotion.com"],"com.dailymotion":["https://www.dailymotion.com"]},aca=/Eureka Dongle|Chromecast Audio|Chromecast Ultra/i,
fca=function(a,b){this.sinks=a;this.deviceCounts=b};var op=function(a){return Promise.all(a.map(function(b){return b.then(function(c){return{me:!0,value:c}},function(c){return{me:!1,reason:c}})}))};var pp=function(a,b){this.s=gb("mr.dial.AppDiscoveryService");this.g=new Set;this.h=a;this.D=b;this.m=new Map;this.o=new Map;this.j=null;this.l=!1};pp.prototype.init=function(){Ml(this)};pp.prototype.start=function(){this.s.info("Starting periodic scanning.");this.l||(this.l=!0,qp(this))};pp.prototype.stop=function(){this.s.info("Stopping periodic scanning.");this.l&&(this.l=!1,this.j&&(clearTimeout(this.j),this.j=null),this.m.clear())};
var qp=function(a){a.s.info("Start app status scan.");var b=[];Array.from(a.h.g.values()).forEach(function(c){b.push.apply(b,rp(a,c))});Array.from(a.D.g.values()).forEach(function(c){b.push(gca(a,c))});op(b).then(function(){a.l&&!a.j&&(nb(a.s,"Scan complete; scheduling for next scan."),a.j=setTimeout(function(){nb(a.s,"Start app status scan (timer-based)");a.j=null;qp(a)},6E4))})},rp=function(a,b){if(!b.Re)return[];for(var c=[],d=l(a.g),e=d.next();!e.done;e=d.next())c.push(a.u(e.value,b));return c};
pp.prototype.u=function(a,b){var c=this;if("unknown"!=dm(b,a)&&36E5>Date.now()-(b.fi[a]||0)||!b.Re)return Promise.resolve();nb(this.s,"Querying "+b.getId()+" for "+a+" to update app status");return sp(this,b,a).then(function(d){a:if("Netflix"==d.name)d=!d.extraData||"websocket"!=d.extraData.capabilities||"running"!=d.state&&"stopped"!=d.state?"unavailable":"available";else switch(d.state){case "running":case "stopped":d="available";break a;default:d="unavailable"}tp(c,b,a,d)},function(d){d instanceof
bp?tp(c,b,a,"unavailable"):(c.s.K("Failed to process app availability; "+b.getId()+" does not support app availability"),b.Re=!1)})};
var gca=function(a,b){var c=a.h.ta(b.Tc.sinkId);if(!c)return a.s.K("Activity refers to nonexistent sink: "+b.Tc.id),Promise.resolve();if(!c.Re)return Promise.resolve();var d=b.appName;nb(a.s,"Querying "+c.getId()+" for "+d+" to update activity");return sp(a,c,d).then(function(e){"running"!=e.state&&up(a,c,d)},function(){return up(a,c,d)})},hca=function(a,b){var c=a.o.get(b.getId());c||(c=new dp(b),nb(a.s,"Created DIAL client for "+b.getId()),a.o.set(b.getId(),c));return c},sp=function(a,b,c){var d=
ica(b,c),e=a.m.get(d);if(e)return e;e=gp(hca(a,b),c);a.m.set(d,e);b=function(){a.m.delete(d)};e.then(b,b);return e},ica=function(a,b){return a.getId()+":"+b},tp=function(a,b,c,d){nb(a.s,"Got app status "+d+" from "+b.getId()+" for "+c);var e=dm(b,c);b.qc[c]=d;b.fi[c]=Date.now();d!=e&&a.h.j.gi(b)},up=function(a,b,c){(b=kp(a.D,b.getId()))&&b.appName==c&&mp(a.D,b.Tc.id)},jca=function(a,b){return Array.from(a.h.g.values()).some(function(c){return"unknown"==dm(c,b)})};pp.prototype.Ia=function(){return"dial.AppDiscoveryService"};
pp.prototype.tb=function(){return[Array.from(this.g)]};pp.prototype.sb=function(){var a=Jl(this);this.g=new Set(a||[])};var vp=function(a,b){this.appName=a;this.launchParameter=void 0===b?"":b},xp=function(a){try{var b=new URL(a)}catch(c){return wp.info("Invalid URL: "+a),null}switch(b.protocol){case "dial:":a:if(a=b.pathname,a.match(/^\w+$/)){if(b=b.searchParams.get("postData")||void 0)try{b=Ul(b)}catch(c){wp.K("Invalid base64 encoded postData:"+b);a=null;break a}a=new vp(a,b)}else wp.K("Invalid app name: "+a),a=null;return a;case "https:":return kca(b);default:return nb(wp,"Unhandled protocol: "+b.protocol),null}},
kca=function(a){var b=a.hash;if(!b)return null;a=(a=lca.exec(b))?a[1]:null;if(!a)return null;a=decodeURIComponent(a);if(b=(b=mca.exec(b))?b[1]:void 0)try{b=Ul(b)}catch(c){return wp.K("Invalid base64 encoded postData:"+b),null}return new vp(a,b)},wp=gb("mr.dial.PresentationUrl"),lca=/__dialAppName__=([A-Za-z0-9-._~!$&'()*+,;=%]+)/,mca=/__dialPostData__=([A-Za-z0-9]+={0,2})/;var yp=function(a,b){this.l=a;this.h=b||new np(this);this.j=new ip(this);this.g=null;this.s=gb("mr.DialProvider")};h=yp.prototype;h.getName=function(){return"dial"};h.lf=function(){return this.h.lf()};h.initialize=function(a){a=a&&0==a.enable_dial_sink_query?!1:!0;this.s.info("Dial sink query enabled: "+a+"...");this.j.init();this.h.init();a?(this.g=this.g||new pp(this.h,this.j),this.g.init()):this.g=null;jp(this)};
h.Qg=function(a){if(!this.g)return Lo;nb(this.s,"GetAvailableSinks for "+a);return(a=xp(a))?eca(this.h,a.appName):Lo};h.startObservingMediaSinks=function(a){if(this.g){var b=xp(a);if(b){a=this.g;b=b.appName;if(!a.g.has(b)||jca(a,b))a.g.add(b),0!=a.h.g.size&&(a.l?Array.from(a.h.g.values()).forEach(a.u.bind(a,b)):a.start());jp(this)}}};h.stopObservingMediaSinks=function(a){this.g&&(a=xp(a))&&(this.g.g.delete(a.appName),zp(this))};h.startObservingMediaRoutes=function(){jp(this)};
h.stopObservingMediaRoutes=function(){zp(this)};var zp=function(a){a.g&&(0==a.h.g.size||0==a.g.g.size&&0==a.j.g.size)&&a.g.stop()},jp=function(a){a.g&&0<a.h.g.size&&(0<a.g.g.size||0<a.j.g.size)&&a.g.start()};h=yp.prototype;h.ta=function(a){return(a=this.h.ta(a))?a.Lc:null};h.Rd=function(){return this.j.Rd()};
h.createRoute=function(a,b,c,d){var e=this,f=this.h.ta(b);if(!f)return Yo(1),Bi(Error("Unkown sink: "+b));am().h=new Yl(f.Kc,f.gc());var g=xp(a);if(!g)return Yo(4),Bi(Error("No app name set."));var k=g.appName,m=new dp(f);return Ci(gp(m,k).then(function(p){if("running"==p.state)return hp(m,k)}).then(function(){return m.launchApp(k,g.launchParameter)}).then(function(){Yo(0);return Ap(e,b,a,k,c,d)}).catch(function(p){Yo(3);throw p;}))};h.joinRoute=function(){return Bi(Error("Not supported"))};
h.connectRouteByRouteId=function(){return Bi(Error("Not supported"))};h.detachRoute=function(){};var Ap=function(a,b,c,d,e,f){b=so(e,a.getName(),b,c,!0,d);b.offTheRecord=f;a.j.add(new $ba(b,d));return b};yp.prototype.Jj=function(a){this.l.onSinkAvailabilityUpdated(this,1);this.g&&(jp(this),rp(this.g,a));this.l.td();am().g=new Yl(a.Kc,a.gc())};
yp.prototype.Kj=function(a){var b=this;if(0==this.h.g.size)this.l.onSinkAvailabilityUpdated(this,0);zp(this);a.forEach(function(c){var d=b.j;c=c.getId();if(c=kp(d,c))d.g.delete(c.Tc.id),lp(d.h,c)});this.l.td()};yp.prototype.gi=function(){this.l.td()};var lp=function(a,b){b=b.Tc;if(b.isLocal)a.l.onPresentationConnectionStateChanged(b.id,"terminated");zp(a);a.l.eh(b)};h=yp.prototype;
h.terminateRoute=function(a){var b=this.j.g.get(a)||null;if(!b)return Zo(1),Promise.reject(new Jo(3,"Route in DIAL provider not found for routeId "+a));mp(this.j,a);a=this.h.ta(b.Tc.sinkId);return a?hp(new dp(a),b.appName).then(function(){Zo(0);return Promise.resolve()}).catch(function(c){Zo(3);return Promise.reject(c)}):(Zo(1),Promise.reject(new Jo(3,"Sink in DIAL provider not found for sinkId "+b.Tc.sinkId)))};h.bg=function(){throw Error("Not implemented.");};h.ag=function(){return null};h.ni=function(){};
h.sendRouteMessage=function(){return Promise.reject(Error("DIAL sending messages is not supported"))};h.sendRouteBinaryMessage=function(){return Promise.reject(Error("DIAL sending messages is not supported"))};h.Jg=function(a,b){b=this.h.ta(b);return!b||bj(a)?!1:(a=xp(a))?"available"==dm(b,a.appName):!1};h.Pf=function(){return!1};h.searchSinks=function(){return db()};h.createMediaRouteController=function(){return db()};h.provideSinks=function(a){cca(this.h,a)};var Bp=function(a){this.o=new np(this);this.j=new mm;this.h=a;this.D=this.m=0;this.l=new Vm;this.g=new yp(this,this.o)};h=Bp.prototype;h.Ia=function(){return"cast.DialProviderWrapper"};h.tb=function(){return[new nca(qm(this.j),this.m,this.D,this.l.Na())]};h.sb=function(){var a=Jl(this);a&&(lm(this.j,a.h),this.m=a.sequenceNumber,this.D=a.j,Um(this.l,a.g))};h.getName=function(){return this.g.getName()};h.initialize=function(a){this.g.initialize(a);Ml(this)};h.Rd=function(){return this.g.Rd()};
h.Qg=function(a){return(a=Cp(a))?this.g.Qg(a):Lo};h.startObservingMediaSinks=function(a){(a=Cp(a))&&this.g.startObservingMediaSinks(a)};h.stopObservingMediaSinks=function(a){(a=Cp(a))&&this.g.stopObservingMediaSinks(a)};h.startObservingMediaRoutes=function(a){(a=Cp(a))&&this.g.startObservingMediaRoutes(a)};h.stopObservingMediaRoutes=function(a){(a=Cp(a))&&this.g.stopObservingMediaRoutes(a)};h.ta=function(a){return this.g.ta(a)};
var pca=function(a,b,c,d,e){var f=Cp(b);if(!f)return Yo(4),Promise.reject(Error("Invalid source"));var g=xp(f),k=a.o.ta(c);if(!k)return Yo(1),Promise.reject(Error("Attempting custom launch with closed route"));var m=g.appName;if(!m)return Yo(2),Promise.reject(Error("No app name given"));var p=oca(b);return p?gp(new dp(k),m).then(function(u){var A=Ap(a.g,c,b,m,e,d);u={routeId:A.id,sinkId:k.getId(),appName:m,Ul:u,launchParameter:g.launchParameter,session:null,clientId:null};a.j.set(A.id,u);var E=Dp(a,
u.sinkId),F=new jn("receiver_action",{receiver:E,action:chrome.cast.Eg.CAST});F.clientId=p;a.h.re(u.routeId,F);F=chrome.cast.ga;var J=String(a.D);a.D=(a.D+1)%9007199254740992;E=new F(J,"",u.appName,[],E);u.session=E;u.clientId=p;E=new jn("new_session",E);E.clientId=p;a.h.re(u.routeId,E);return A}).catch(function(u){Yo(3);throw u;}):(Yo(2),Promise.reject(Error("No client ID")))};
Bp.prototype.createRoute=function(a,b,c,d,e,f,g){return a.startsWith("cast-dial:")||Ep.test(a)?Ci(pca(this,a,b,d,c)):this.g.createRoute(a,b,c,d,e,f,g)};Bp.prototype.terminateRoute=function(a){var b=this.j.get(a);if(b&&b.session&&b.clientId){var c={receiver:Dp(this,b.sinkId),action:chrome.cast.Eg.STOP};c=new jn("receiver_action",c);c.clientId=b.clientId;this.h.re(b.routeId,c);this.h.onPresentationConnectionStateChanged(b.routeId,"terminated")}return this.g.terminateRoute(a)};
Bp.prototype.sendRouteMessage=function(a,b,c){try{var d=JSON.parse(b)}catch(e){return $o(1),Promise.reject(e)}switch(d.type){case "client_connect":return $o(0),qca(this,a,d.clientId);case "custom_dial_launch":if(this.l.contains(d.sequenceNumber))return $o(0),rca(this,a,d).then(function(e){Yo(0);return e}).catch(function(e){Yo(3);throw e;});break;case "v2_message":if("STOP"==d.message.type)return $o(0),this.terminateRoute(a),Promise.resolve()}$o(2);return this.g.sendRouteMessage(a,b,c)};
Bp.prototype.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};
var rca=function(a,b,c){a.l.remove(c.sequenceNumber);c=c.message;b=a.j.get(b);if(!b)return Promise.reject(Error("Unknown route"));if(c&&!c.doLaunch)return Promise.resolve();a=a.o.ta(b.sinkId);if(!a)return Promise.reject(Error("Custom launch response for sink that no longer exists"));a=new dp(a);var d=b.launchParameter;d=(c?c.launchParameter:null)||d;return a.launchApp(b.appName,d)},Dp=function(a,b){a=a.o.ta(b);b=bm(am(),b);b=new chrome.cast.Fi(b,a.Lc.friendlyName);b.ipAddress=a.gc();b.receiverType=
chrome.cast.Gh.DIAL;return b},qca=function(a,b,c){b=a.j.get(b);if(!b)return Promise.reject(Error("Unknown route"));var d=Dp(a,b.sinkId);d.receiverType=chrome.cast.Gh.DIAL;d=new jn("custom_dial_launch",new chrome.cast.ql(d,b.Ul.state,b.Ul.extraData));d.clientId=c;c=a.m;a.m=(a.m+1)%9007199254740992;d.sequenceNumber=c;a.l.add(d.sequenceNumber);a.h.re(b.routeId,d);return Promise.resolve()};h=Bp.prototype;h.bg=function(a){return this.g.bg(a)};h.ag=function(a){return this.g.ag(a)};h.ni=function(){};
h.Jg=function(a,b){return a.startsWith("cast-dial:")||Ep.test(a)||this.g.Jg(a,b)};h.Pf=function(a,b,c){return this.g.Pf(a,b,c)};h.connectRouteByRouteId=function(a,b,c,d,e){return this.g.connectRouteByRouteId(a,b,c,d,e)};h.joinRoute=function(a,b,c,d,e,f){return this.g.joinRoute(a,b,c,d,e,f)};h.detachRoute=function(a){this.j.remove(a);this.g.detachRoute(a)};h.td=function(){this.h.td()};h.onSinkAvailabilityUpdated=function(a,b){this.h.onSinkAvailabilityUpdated(a,b)};
h.pg=function(a,b){this.h.pg(this,b)};h.eh=function(a){this.h.eh(a)};h.vf=function(a){this.h.vf(a)};h.pj=function(){};h.getMirroringServiceHostForTab=function(){};h.getMirroringServiceHostForDesktop=function(){};h.getMirroringServiceHostForOffscreenTab=function(){};h.re=function(a,b){this.h.re(a,b)};h.onPresentationConnectionStateChanged=function(a,b){this.h.onPresentationConnectionStateChanged(a,b)};h.onPresentationConnectionClosed=function(a,b,c){this.h.onPresentationConnectionClosed(a,b,c)};
h.gj=function(a){return this.h.gj(a)};h.ij=function(){return this.h.ij()};h.qf=function(a){this.h.qf(a)};h.mi=function(a,b){this.h.mi(a,b)};h.oi=function(a){this.h.oi(a)};h.Jj=function(a){this.g.Jj(a)};h.Kj=function(a){this.g.Kj(a)};h.gi=function(a){this.g.gi(a)};h.Lj=function(){};h.en=function(){};h.searchSinks=function(a,b){return this.g.searchSinks(a,b)};h.provideSinks=function(a){this.g.provideSinks(a)};h.createMediaRouteController=function(){return db()};
h.sg=function(a,b){return this.h.sg(a,b)};h.lf=function(){return this.g.lf()};
var Cp=function(a){try{var b=new URL(a)}catch(e){return null}if("dial:"==b.protocol)return a;if("cast-dial:"==b.protocol){var c=b;a="cast-dial:"!=c.protocol?null:new rn(c.pathname,c.searchParams.get("dialPostData"),c.searchParams.get("clientId"));c=a.j;var d=a.g}else if("https:"==b.protocol){a=yn(a);if(!a)return null;c=a.F;d=a.C}c?(a=d||"",c=new URL("dial:"+c),a&&c.searchParams.set("postData",a),c=c.toString()):c=null;return c},oca=function(a){try{var b=new URL(a)}catch(c){return null}return"cast-dial:"==
b.protocol?b.searchParams.get("clientId"):"https:"==b.protocol?zn(a):null},nca=function(a,b,c,d){this.h=a;this.sequenceNumber=b;this.j=c;this.g=d},Ep=/__dialAppName__/;var Fp=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/,sca=function(a,b){if(a){a=a.split("&");for(var c=0;c<a.length;c++){var d=a[c].indexOf("="),e=null;if(0<=d){var f=a[c].substring(0,d);e=a[c].substring(d+1)}else f=a[c];b(f,e?decodeURIComponent(e.replace(/\+/g," ")):"")}}},Gp=function(a,b,c){c=null!=c?"="+encodeURIComponent(String(c)):"";if(b+=c){c=a.indexOf("#");0>c&&(c=a.length);var d=a.indexOf("?");if(0>d||d>c){d=c;var e=
""}else e=a.substring(d+1,c);a=[a.substr(0,d),e,a.substr(c)];c=a[1];a[1]=b?c?c+"&"+b:b:c;a=a[0]+(a[1]?"?"+a[1]:"")+a[2]}return a},tca=/#|$/,Hp=function(a,b){var c=a.search(tca);a:{var d=0;for(var e=b.length;0<=(d=a.indexOf(b,d))&&d<c;){var f=a.charCodeAt(d-1);if(38==f||63==f)if(f=a.charCodeAt(d+e),!f||61==f||38==f||35==f)break a;d+=e+1}d=-1}if(0>d)return null;e=a.indexOf("&",d);if(0>e||e>c)e=c;d+=b.length+1;return decodeURIComponent(a.substr(d,e-d).replace(/\+/g," "))},Ip=function(a,b){var c=a.length-
1;0<=c&&a.indexOf("/",c)==c&&(a=a.substr(0,a.length-1));jd(b,"/")&&(b=b.substr(1));return ue(a,"/",b)};var Jp=function(a){this.Ic=this.D=this.j="";this.Oa=null;this.l=this.g="";this.m=!1;var b;a instanceof Jp?(this.m=a.m,Kp(this,a.j),this.D=a.D,this.Ic=a.Ic,Lp(this,a.Jb()),this.g=a.g,Mp(this,a.h.clone()),this.l=a.l):a&&(b=String(a).match(Fp))?(this.m=!1,Kp(this,b[1]||"",!0),this.D=Np(b[2]||""),this.Ic=Np(b[3]||"",!0),Lp(this,b[4]),this.g=Np(b[5]||"",!0),Mp(this,b[6]||"",!0),this.l=Np(b[7]||"")):(this.m=!1,this.h=new Op(null,this.m))};
Jp.prototype.toString=function(){var a=[],b=this.j;b&&a.push(Pp(b,Qp,!0),":");var c=this.Ic;if(c||"file"==b)a.push("//"),(b=this.D)&&a.push(Pp(b,Qp,!0),"@"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c=this.Jb(),null!=c&&a.push(":",String(c));if(c=this.g)this.Ic&&"/"!=c.charAt(0)&&a.push("/"),a.push(Pp(c,"/"==c.charAt(0)?uca:vca,!0));(c=this.h.toString())&&a.push("?",c);(c=this.l)&&a.push("#",Pp(c,wca));return a.join("")};
Jp.prototype.resolve=function(a){var b=this.clone(),c=!!a.j;c?Kp(b,a.j):c=!!a.D;c?b.D=a.D:c=!!a.Ic;c?b.Ic=a.Ic:c=null!=a.Oa;var d=a.g;if(c)Lp(b,a.Jb());else if(c=!!a.g){if("/"!=d.charAt(0))if(this.Ic&&!this.g)d="/"+d;else{var e=b.g.lastIndexOf("/");-1!=e&&(d=b.g.substr(0,e+1)+d)}e=d;if(".."==e||"."==e)d="";else if(-1!=e.indexOf("./")||-1!=e.indexOf("/.")){d=jd(e,"/");e=e.split("/");for(var f=[],g=0;g<e.length;){var k=e[g++];"."==k?d&&g==e.length&&f.push(""):".."==k?((1<f.length||1==f.length&&""!=
f[0])&&f.pop(),d&&g==e.length&&f.push("")):(f.push(k),d=!0)}d=f.join("/")}else d=e}c?b.g=d:c=""!==a.h.toString();c?Mp(b,a.h.clone()):c=!!a.l;c&&(b.l=a.l);return b};Jp.prototype.clone=function(){return new Jp(this)};var Kp=function(a,b,c){a.j=c?Np(b,!0):b;a.j&&(a.j=a.j.replace(/:$/,""))};Jp.prototype.Jb=function(){return this.Oa};
var Lp=function(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.Oa=b}else a.Oa=null},Mp=function(a,b,c){b instanceof Op?(a.h=b,xca(a.h,a.m)):(c||(b=Pp(b,yca)),a.h=new Op(b,a.m))},Np=function(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""},Pp=function(a,b,c){return"string"===typeof a?(a=encodeURI(a).replace(b,zca),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null},zca=function(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)},
Qp=/[#\/\?@]/g,vca=/[#\?:]/g,uca=/[#\?]/g,yca=/[#\?@]/g,wca=/#/g,Op=function(a,b){this.h=this.g=null;this.j=a||null;this.l=!!b},Rp=function(a){a.g||(a.g=new mm,a.h=0,a.j&&sca(a.j,function(b,c){a.add(decodeURIComponent(b.replace(/\+/g," ")),c)}))},Tp=function(a){var b=Rm(a);if("undefined"==typeof b)throw Error("Keys are undefined");var c=new Op(null,void 0);a=Qm(a);for(var d=0;d<b.length;d++){var e=b[d],f=a[d];Sa(f)?Sp(c,e,f):c.add(e,f)}return c};h=Op.prototype;h.Ca=function(){Rp(this);return this.h};
h.add=function(a,b){Rp(this);this.j=null;a=Up(this,a);var c=this.g.get(a);c||this.g.set(a,c=[]);c.push(b);this.h+=1;return this};h.remove=function(a){Rp(this);a=Up(this,a);return pm(this.g,a)?(this.j=null,this.h-=this.g.get(a).length,this.g.remove(a)):!1};h.clear=function(){this.g=this.j=null;this.h=0};h.bc=function(){Rp(this);return 0==this.h};var Vp=function(a,b){Rp(a);b=Up(a,b);return pm(a.g,b)};h=Op.prototype;h.Rf=function(a){var b=this.Na();return Vb(b,a)};
h.forEach=function(a,b){Rp(this);this.g.forEach(function(c,d){Kb(c,function(e){a.call(b,e,d,this)},this)},this)};h.Qb=function(){Rp(this);for(var a=this.g.Na(),b=this.g.Qb(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c};h.Na=function(a){Rp(this);var b=[];if("string"===typeof a)Vp(this,a)&&(b=ec(b,this.g.get(Up(this,a))));else{a=this.g.Na();for(var c=0;c<a.length;c++)b=ec(b,a[c])}return b};
h.set=function(a,b){Rp(this);this.j=null;a=Up(this,a);Vp(this,a)&&(this.h-=this.g.get(a).length);this.g.set(a,[b]);this.h+=1;return this};h.get=function(a,b){if(!a)return b;a=this.Na(a);return 0<a.length?String(a[0]):b};var Sp=function(a,b,c){a.remove(b);0<c.length&&(a.j=null,a.g.set(Up(a,b),x(c)),a.h+=c.length)};
Op.prototype.toString=function(){if(this.j)return this.j;if(!this.g)return"";for(var a=[],b=this.g.Qb(),c=0;c<b.length;c++){var d=b[c],e=encodeURIComponent(String(d));d=this.Na(d);for(var f=0;f<d.length;f++){var g=e;""!==d[f]&&(g+="="+encodeURIComponent(String(d[f])));a.push(g)}}return this.j=a.join("&")};Op.prototype.clone=function(){var a=new Op;a.j=this.j;this.g&&(a.g=this.g.clone(),a.h=this.h);return a};
var Up=function(a,b){b=String(b);a.l&&(b=b.toLowerCase());return b},xca=function(a,b){b&&!a.l&&(Rp(a),a.j=null,a.g.forEach(function(c,d){var e=d.toLowerCase();d!=e&&(this.remove(d),Sp(this,e,c))},a));a.l=b};Op.prototype.extend=function(a){for(var b=0;b<arguments.length;b++)Sm(arguments[b],function(c,d){this.add(d,c)},this)};var Aca=function(a,b){this.input=a;this.domain=b};var Wp=function(a){this.g=a;this.s=gb("mr.ExternalMessageHandler")};
Wp.prototype.onMessage=function(a,b,c){var d=this;this.s.info("Received a message from "+b.id+" type: "+a.type);var e=chrome.runtime.id;"start"==a.type?(a=a.message,this.g.searchSinks("pseudo:cloud","urn:x-org.chromium.media:source:desktop",new Aca(a.meetingName,a.domain)).then(function(f){var g="PresentationId"+b.id+Bca++;d.g.createRoute("urn:x-org.chromium.media:source:desktop",f,g).then(function(k){c(new tf(e,"route",k.id))}).catch(function(k){c(new tf(e,"error",k))})},function(){c(new tf(e,"error",
Error("Failed to find sink.")))})):"stop"==a.type?this.g.terminateRoute(a.message.routeId).then(function(){c(new tf(e,"stopped"))}):"subscribe_log_data"==a.type?(ib.push(function(f){chrome.runtime.sendMessage(b.id,new tf(e,"log_message",f))}),c(new tf(e,"subscribed"))):(c(new tf(e,"error",Error("Unhandled message type"))),this.s.error("Unhandled message type "+a.type))};var Bca=0;var Xp=function(){this.g=[];this.h=[]};h=Xp.prototype;h.enqueue=function(a){if(1E3<=this.Ca()){if(this.bc())throw Error("Empty queue");0==this.g.length&&(this.g=this.h,this.g.reverse(),this.h=[]);this.g.pop()}this.h.push(a)};h.Ca=function(){return this.g.length+this.h.length};h.bc=function(){return 0==this.Ca()};h.Na=function(){var a=this.g.slice();a.reverse();a.push.apply(a,n(this.h));return a};h.clear=function(){this.g=[];this.h=[]};var Yp=function(){this.g=new Xp;this.h=Date.now()},$p=function(){null==Zp&&(Zp=new Yp);return Zp};
Yp.prototype.init=function(){hb=1;var a=gb("browser"),b=window.onerror;window.onerror=function(d,e,f,g,k){try{var m=k.result.error.errors[0];if("usageLimits"==m.domain&&"accessNotConfigured"==m.reason)return!0}catch(p){}b&&b(d,e,f,g,k);a.error("Error: "+d+" ("+e+" @ Line: "+f+")",k)};ib.push(this.l.bind(this));var c=window.localStorage["debug.logs"];c&&(hb=pb(c.toUpperCase()));(c=window.localStorage["debug.console"])&&"false"!=c.toLowerCase()&&ib.push(this.j.bind(this))};
Yp.prototype.l=function(a){this.g.enqueue(aq(this,a,!1));a=a.Qc;a instanceof Error&&a.stack&&this.g.enqueue(a.stack)};Yp.prototype.j=function(a){var b=[aq(this,a,!0)];a.Qc&&b.push(a.Qc);switch(a.level){case 3:console.error.apply(console,n(b));break;case 2:console.warn.apply(console,n(b));break;case 1:console.log.apply(console,n(b));break;default:console.debug.apply(console,n(b))}};
var aq=function(a,b,c){var d=["["];if(c)d.push(("       "+((Date.now()-a.h)/1E3).toFixed(3)).slice(-7));else{a=new Date(b.time);var e=function(f){return 10>f?"0"+f:f};d.push(a.getFullYear().toString(),"-",e(a.getMonth()+1),"-",e(a.getDate())," ",e(a.getHours()),":",e(a.getMinutes()),":",e(a.getSeconds()),".",e(Math.floor(a.getMilliseconds()/10)))}d.push("][",ob[b.level],"][",b.V,"] ",b.message);if(!c&&null!=b.Qc)if(d.push("\n"),b.Qc instanceof Error)d.push(b.Qc.message);else try{d.push(JSON.stringify(b.Qc))}catch(f){d.push(b.Qc.toString())}d.push("\n");
return d.join("")},Cca=function(){var a=$p();return 0==a.g.Ca()?"NA":a.g.Na().join("")},Dca=function(){var a=$p();Ml(a)};Yp.prototype.Ia=function(){return"LogManager"};Yp.prototype.tb=function(){return[this.g.Na()]};Yp.prototype.sb=function(){var a=this.g.Na();this.g.clear();for(var b=l(Jl(this)||[]),c=b.next();!c.done;c=b.next())this.g.enqueue(c.value);a=l(a);for(c=a.next();!c.done;c=a.next())this.g.enqueue(c.value)};var Zp=null;var bq=function(a){this.g=a;this.s=gb("mr.InternalMessageHandler")};
bq.prototype.onMessage=function(a,b,c){var d=this;if("retrieve_log_data"!=a.type)c(new tf(chrome.runtime.id,"error",Error("Unhandled message type")));else{var e={logs:Cca(),device:Eaa()};b=[];var f=sf(e.device.ip).then(function(k){k.g&&(e.device.version=k.g)});b.push(f);var g=this.g.F;g&&(a=Eca(this,g,a.source).then(function(k){k&&(e.castStreamingLogs=k)},function(){d.s.error("Log upload failed for service: "+g)}),b.push(a));e.dialDeviceCounts=Fca(this);b.push(Gca(this,e));a=this.g.getMediaSinkServiceStatus().then(function(k){e.mediaSinkServiceStatus=
k.status},function(){d.s.error("Fail to get media sink service status")});b.push(a);this.g.config&&(e.mirroringServiceEnabled=this.g.config.use_mirroring_service,e.nativeCastMrpEnabled=!this.g.config.enable_cast_sink_query,e.nativeDialMrpEnabled=!this.g.config.enable_dial_sink_query);op(b).then(function(){c(e)})}};
var Gca=function(a,b){return Ui("mr.cast.SinkDiscoveryService").then(function(c){c=c.lf();b.castDeviceCounts=c.Yg+"."+c.Ig},function(){a.s.error("Failed to get device counts for castDeviceCounts.")})},Fca=function(a){a=cq(a.g,"dial");if(!a)return"";a=a.lf();return a.Yg+"."+a.Ig},Eca=function(a,b,c){return dq(a.g,b).then(function(d){return d.Xj(c)})};var Hca={ACCEPTED:0,gp:1,TIMEOUT:2},Ica={SUCCESS:0,ux:1},Jca={xq:0,Up:1,UC:2,Vx:3,Ux:4,pz:5,TIMEOUT:6,KA:7},Kca={Sx:0,ZB:1},Lca={lA:0,Wy:1,USER:2,Nx:3},eq=function(a){Bb("MediaRouter.Cloud.Knock.Result",a,Hca)},fq=function(a){Bb("MediaRouter.Cloud.Session.Start",a,Ica)},gq=function(a){Bb("MediaRouter.Cloud.Session.Type",a,Kca)},hq=function(a){Bb("MediaRouter.Cloud.Device.UserRole",a,Lca)};var iq=function(a,b){this.g=a;this.h=b},jq=new iq("https://www.googleapis.com/clouddevices/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),Mca=new iq("https://castedumessaging-pa.googleapis.com/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),Nca=new iq("https://www.googleapis.com/calendar/v3",""),Oca=new iq("https://www.googleapis.com/hangouts/v1",""),kq=new iq("https://networktraversal.googleapis.com/v1alpha","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA");var lq=function(a,b,c,d,e,f){c=void 0===c?null:c;a||null==c&&(c="default");this.Vm=a;this.Ea=b;this.Ic=c;this.kg=void 0===d?null:d;this.hd=void 0===e?null:e;this.zf=void 0===f?null:f};lq.prototype.h=function(){var a="";this.hd?a=this.hd:this.kg&&(a=this.kg);return a};lq.prototype.Vd=function(){return this.Vm};lq.prototype.getId=function(){return this.Ea};lq.prototype.merge=function(a){!this.zf&&a.zf&&(this.zf=a.zf);!this.hd&&a.hd&&(this.hd=a.hd);this.hd&&a.hd&&this.zf&&(this.hd=a.hd)};var mq=function(a,b){this.h=a;this.j=b;this.s=gb("mr.cloud.calendar.CalendarService")},Rca=function(a){return Pca(a,a.j.g).then(function(b){a.s.info(nq(b.length)+" events discovered before filtering.");return Qca(a,b)},function(b){a.s.K("Error getting Hangouts from calendar.",b);return[]})},nq=function(a){return 20<a?"20+":a.toString()},Pca=function(a,b){var c=Date.now();return Sca(a,b,new Date(c),new Date(c+9E5)).then(function(d){return d.filter(a.g)})};
mq.prototype.g=function(a){return!(!a.start||!a.end||a.start.date||a.end.date||!a.start.dateTime||!a.end.dateTime)};
var Sca=function(a,b,c,d){b=oq(Nca.g,["calendars",b,"events"],{timeMin:c.toJSON(),timeMax:d.toJSON(),singleEvents:!0});nb(a.s,"Retrieving Hangouts from Calendar: "+b);return pq(a.h,b,"GET").then(function(e){return e.items?e.items:[]})},Qca=function(a,b){var c=[];b.filter(function(d){return d.hangoutLink}).forEach(function(d){var e=new Jp(d.hangoutLink);if("meet.google.com"==e.Ic)c.push(new lq(!0,e.g.substring(1),void 0,void 0,d.summary));else if(e=e.g.substring(12).split("/"),2==e.length){var f=l(e);
e=f.next().value;f=f.next().value;if(-1!=e.indexOf(".")){var g=f;var k=e}c.push(new lq(!1,f+"@"+e,k,g,d.summary,void 0))}else a.s.K("Invalid hangout link from calendar event: "+d.hangoutLink)});a.s.info(nq(c.length)+" events discovered with Hangout links.");return c};var qq=function(a){this.g=a;this.id=a.id;this.s=gb("mr.cloud.devices.WeaveDevice")};qq.prototype.isAvailable=function(){if(this.getState().appStatus){var a="online"==this.g.connectionStatus,b="available"==this.getState().appStatus,c=rq(this,864E5);nb(this.s,"Device id: "+this.id+", availability: GCM connected "+a+", app Available: "+b+", checked in: "+c);return a&&b&&c}a=rq(this,9E5);this.s.info("Availability for legacy receiver app: "+a);return a};
var rq=function(a,b){a=a.g.lastUpdateTimeMs?Number(a.g.lastUpdateTimeMs):null;return!!(a&&a>Date.now()-b)};qq.prototype.h=function(){return this.getState().settings.receiverName};qq.prototype.getId=function(){return this.id};qq.prototype.getState=function(){return this.g.state._cloudCast};var sq=function(){this.s=Pf("mr.cloud.GcmRegistrationSerializer");this.g=Promise.resolve("")};sq.prototype.register=function(a){var b=this,c=function(){return new Promise(function(d,e){chrome.gcm.register(a,function(f){f?(b.s.info("Got GCM registration ID: "+f),d(f)):e(Error(chrome.runtime.lastError&&chrome.runtime.lastError.message||"unknown error"))})})};return this.g=this.g.then(c,c)};var Tca=function(a){this.email=a;this.imageUrl=null},Uca=function(a){this.type=a},tq=function(a,b,c,d){this.type="__cloud_webrtc_session_message__";this.sessionDescription=a;this.user=b||null;this.flungUrl=c||null;this.presentationId=d||null};q(tq,Uca);
var uq=function(a,b,c){this.name=a;this.parameters=b;this.minimalRole=null!=c?c:"user"},vq={_settings:{type:"string"},_presentationRequest:{type:"string"},_optMediaConstraints:{type:"string"},_webrtcMessage:{type:"string"},_user:{type:"string"}},Vca=new uq("_knockingStartWebrtcSession",vq,"viewer"),Wca=new uq("_startWebrtcSession",vq),Xca=new uq("_stopSession",{},"viewer");var wq=function(a,b){this.m=a;this.D=b;this.h=this.j=this.g=null;this.l=!1;this.s=gb("mr.cloud.devices.WeaveDevicesService");Ml(this)};wq.prototype.getDevice=function(a){a=oq(jq.g,["devices",a]);return pq(this.m,a,"GET").then(function(b){return new qq(b)})};
var Yca=function(a){return xq(a,{descriptionSubstring:"Chrome Streaming Receiver"}).catch(function(){return[]})},xq=function(a,b){var c=oq(jq.g,["devices"],b);return pq(a.m,c,"GET").then(function(d){var e=(d.devices||[]).filter(function(g){return null!=g.commandDefs&&null!=g.commandDefs._cloudCast}).map(function(g){return new qq(g)});if(d=d.nextPageToken){var f=Mc(b);f.token=d;return xq(a,f).then(function(g){return e.concat(g)})}return e})};wq.prototype.Ia=function(){return"WeaveDevicesService"};
wq.prototype.tb=function(){return[new Zca(this.g,this.h,this.j)]};wq.prototype.sb=function(){var a=Jl(this);a&&(this.g=a.Qs,this.h=a.gcmRegistrationId,this.j=a.Ps)};var $ca=function(a){return a.h&&null!=a.j&&a.j+864E5>=Date.now()?Promise.resolve(a.h):a.D.register(["919648714761"]).then(function(b){nb(a.s,"Got GCM ID: "+b);a.h=b;a.j=Date.now();a.g=null;return b},function(b){a.s.K("Error",b);a.h=null;a.j=null;a.g=null;throw b;})};
wq.prototype.subscribe=function(a){var b=this;if(this.l)return Promise.resolve();this.l=!0;if(!a||this.g&&!(this.g+864E5<Date.now()))return Promise.resolve();a={filters:["myDevices"],gcmRegistrationId:a,gcmSenderId:"919648714761",expirationTimeMs:864E5};var c=oq(jq.g,["subscriptions","subscribe"],{});return pq(this.m,c,"POST",a).then(function(){nb(b.s,"Subscribed on: "+Date.now());b.g=Date.now();b.l=!1;return Promise.resolve()},function(){b.l=!1;return Promise.resolve()})};
var Zca=function(a,b,c){this.Qs=a;this.gcmRegistrationId=b;this.Ps=c};var yq=function(a,b,c,d,e,f,g,k){var m=bm(am(),a);this.yb=new Fl(m,b,g,k,e);this.deviceId=a;this.g=c;this.model=d;this.isAvailable=f};ca.Object.defineProperties(yq.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this.yb.id}},displayName:{configurable:!0,enumerable:!0,set:function(a){this.yb.friendlyName=a}}});var zq=function(a,b,c,d,e){yq.call(this,a,b,"weave","Chrome Streaming Receiver",d,e,"education");this.Oi=c};q(zq,yq);
var Aq=function(a){var b=a.Ic,c;a.kg&&a.h()!=a.kg&&(c=a.kg);yq.call(this,a.getId(),a.h(),"mesi","Hangout",b,!1,a.Vd()?"meeting":"hangout",c);this.Vd=a.Vd();this.xh=a.zf||""};q(Aq,yq);var Bq=function(a,b,c){yq.call(this,a,b,"slarti","Cast Receiver for Education","default",c,"education")};q(Bq,yq);var Cq=function(a,b,c){this.D=a;this.l=b;this.g=new Map;this.j=new Map;this.h=null;this.m=c};Cq.prototype.se=function(){var a=this.h+this.m;if(null==this.h||a<Date.now())this.h=Date.now(),ada(this);return Array.from(this.g.values())};Cq.prototype.ta=function(a){return this.g.get(a)||null};
var ada=function(a){a.D().then(function(b){bda(a,b)})},bda=function(a,b){var c=new Map(a.g),d=new Map,e=new Map,f=[],g=[];b.forEach(function(k){var m=k.id;d.set(m,k);e.set(m,k.deviceId);c.has(m)?c.has(m)&&JSON.stringify(c.get(m))!=JSON.stringify(k)&&g.push(k.yb):f.push(k.yb);c.delete(m)});b=[].concat(n(c.values())).map(function(k){return k.yb});a.j.clear();a.j=e;a.g.clear();a.g=d;cda(a,f,g,b)},cda=function(a,b,c,d){0<b.length&&Dq(a.l,b);0<c.length&&Eq(a.l,c);0<d.length&&Fq(a.l,d)},Gq=function(a){for(var b=
{},c=l(a.g.entries()),d=c.next();!d.done;d=c.next()){var e=l(d.value);d=e.next().value;e=e.next().value;b[d]=e}c={};d=l(a.j.entries());for(e=d.next();!e.done;e=d.next()){var f=l(e.value);e=f.next().value;f=f.next().value;c[e]=f}return new dda(b,c,a.h)},Hq=function(a,b){for(var c in b.sinks){var d=b.sinks[c],e=null;"Hangout"==d.model?e=new Aq(new lq(d.Vd,d.deviceId,d.yb.domain,d.yb.description,d.yb.friendlyName,d.xh)):"Cast Receiver for Education"==d.model?e=new Bq(d.deviceId,d.yb.friendlyName,d.isAvailable):
"Chrome Streaming Receiver"==d.model&&(e=new zq(d.deviceId,d.yb.friendlyName,d.Oi,d.yb.domain,d.isAvailable));a.g.set(c,e)}for(c in b.g)a.j.set(c,b.g[c]);b.h&&(a.h=b.h)},dda=function(a,b,c){this.sinks=a;this.g=b;this.h=c};var Jq=function(a,b,c){if(!Iq){Of();var d=Nf;d.h=Jf;var e=eda;d.g||(d.g=[]);d.g.push(e);Iq=!0}this.j=a;this.l=b;this.g=new Cq(this.m.bind(this),c,2E4);this.h=new Map;Ml(this)},eda=function(a){jb({V:a.j,level:qb(a.h.value),time:a.m,message:a.getMessage(),Qc:a.g})};Jq.prototype.se=function(){return this.g.se()};Jq.prototype.ta=function(a){return this.g.ta(a)};
Jq.prototype.m=function(){var a=this;this.s.info("Fetching hangouts");return op([fda(this.l),Rca(this.j)]).then(function(b){var c=Array.from(a.h.values());b.forEach(function(e){e.me?c=c.concat(e.value):a.s.error("Error discovering Hangouts",e.reason)});var d=c.reduce(function(e,f){var g=e[f.getId()];g?g.merge(f):g=f;e[g.getId()]=g;return e},{});return Object.keys(d).map(function(e){e=d[e];Ab("MediaRouter.Cloud.Hangout.Sink.Discovered");return new Aq(e)})})};
var gda=function(a,b){return Ui("mr.mirror.hangouts.MeetingsService").then(function(c){return c.hc(b)}).then(function(c){return Kq(a,c)},function(){return b.input.match(/^#/)?Promise.reject(Error("Failed to resolve meeting alias.")):Kq(a,b.input,b.domain)})},Kq=function(a,b,c){c=c||void 0;var d=!c;b=new lq(d,d?b:b+"@"+c,c,b,void 0,void 0);a.h.set(b.getId(),b);b=new Aq(b);a.g.g.set(b.id,b);return b.yb};Jq.prototype.Ia=function(){return"HangoutSinkDiscoveryService"};
Jq.prototype.tb=function(){for(var a={},b=l(this.h.entries()),c=b.next();!c.done;c=b.next()){var d=l(c.value);c=d.next().value;d=d.next().value;a[c]=d}return[{cache:Gq(this.g),manualHangouts:a}]};Jq.prototype.sb=function(){var a=Jl(this);if(a){Hq(this.g,a.cache);for(var b in a.manualHangouts){var c=a.manualHangouts[b];this.h.set(b,new lq(c.Vm,c.Ea,c.Ic,c.kg,c.hd,c.zf))}}};Jq.prototype.s=gb("mr.cloud.discovery.HangoutSinkDiscoveryService");var Iq=!1;var Mq=function(){this.h=!1;this.g=null;this.j=!1;this.s=gb("mr.cloud.identity.IdentityService");Ml(this);hda(this);Lq(this)},Nq=function(a){return a.g?a.g.substr(a.g.indexOf("@")+1):""};
Mq.prototype.getAuthToken=function(){return chrome.identity?new Promise(function(a,b){chrome.identity.getAuthToken({interactive:!1},function(c){chrome.runtime.lastError?b(Error("Unable to get user auth token: "+chrome.runtime.lastError.message)):null==c?b(Error("User is not logged in (no token found)")):a(c)})}):Promise.reject(Error("chrome.identity permission required for auth."))};
var ida=function(a){return new Promise(function(b){chrome.identity.removeCachedAuthToken({token:a},function(){b()})})},Lq=function(a){a.getAuthToken().then(function(b){chrome.identity.getProfileUserInfo(function(c){a.h=!!c.email||!!c.id;a.g=c.email||null;b&&!a.h&&(a.j=!0)})},function(b){nb(a.s,"Unable to set sign in and email.",b)})},hda=function(a){chrome.identity.onSignInChanged.addListener(function(b,c){Zi(6);a.h=c;a.s.info("Signed in change: "+a.h);a.h?Lq(a):(a.g=null,a.j=!1)})},jda=function(a){return a.getAuthToken().then(function(b){var c=
window.gapi;if(!c)return a.s.error("gapi not loaded."),!1;a.s.info("Setting gapi auth token");c.auth.setToken({access_token:b});return!0})};Mq.prototype.Ia=function(){return"IdentityService"};Mq.prototype.tb=function(){return[null,{signedIn:this.h,userEmail:this.g,kioskAuth:this.j}]};Mq.prototype.sb=function(){var a=Kl(this);a&&(a.signedIn&&(this.h=a.signedIn),a.userEmail&&(this.g=a.userEmail),a.kioskAuth&&(this.j=a.kioskAuth))};var Oq="cloudview.test@gmail.com castouts.qa.nohangouts@gmail.com castouts.qa@gmail.com castouts-qa.com castouts-test.com google.com youtube.com nest.com waze.com netflix.com twitter.com yahoo.com salesforce.com whirlpool.com nytimes.com kohls.com squareup.com ivci.com".split(" ");var Pq=function(a){var b=a.method,c=a.uri,d=a.baseUrl,e=a.Uc,f=a.Un,g=a.headers,k=a.body,m=a.start,p=a.apiKey,u=a.zh;a=a.rb;this.method=b&&b.toUpperCase()||"GET";(b=c)||(d=[d].concat(n(e||[])).join("/"),d=new Jp(encodeURI(d)),f&&(f=Tp(f),Mp(d,f)),b=d);this.uri=b;p&&this.uri.h.add("key",p);this.g=a||null;this.headers=g||{};(this.body=k)&&(this.headers["Content-Type"]="application/json");this.zh=void 0!==u?u:1E4;this.start=m||cb()},kda=function(a){return(a.g?a.g.getAuthToken():Promise.resolve(null)).then(function(b){b&&
(a.headers.Authorization="Bearer "+b);b={method:a.method,headers:a.headers};a.body&&(b.body=JSON.stringify(a.body));return new Request(a.uri.toString(),b)})};var lda={Qw:100,dC:101,hA:200,Rw:201,ACCEPTED:202,Kz:203,Yz:204,fB:205,sA:206,xz:207,wz:300,sz:301,Bx:302,DB:303,Uz:304,OC:305,gC:307,zA:308,Vo:400,AC:401,Fp:402,Ax:403,Qz:404,mz:405,Nz:406,OA:407,dB:408,Mw:409,Lx:410,Sy:411,HA:412,aB:413,eB:414,HC:415,cB:416,nx:417,GC:422,Vy:423,ox:424,IA:428,jC:429,bB:431,vp:500,Rz:501,Xv:502,KB:503,Gx:504,ey:505,sy:507,Ez:511,SA:1223};var Qq=function(a,b){Db.call(this,b&&b.message||a.statusText);this.code=a.status;this.response=a;this.status=(this.g=b)&&b.status};q(Qq,Db);var pda=function(a){if(mda.has(a.code))return!0;var b=a.g||{};return a.g?nda.has(b.status)?!0:!!(b.errors||[]).find(function(c){return oda.has(c)}):!1},Rq=function(a,b){a=new Response(void 0,{status:b||408,statusText:a});return new Qq(a)},mda=new Set([400,401,403,404,405,406,501]),nda=new Set(["PERMISSION_DENIED"]),oda=new Set("authError command_is_in_terminal_state forbidden notFound unmanaged_group_acl acl_entry_bad_scope network_error".split(" "));var V=function(){this.bd=this.bd;this.nb=this.nb};V.prototype.bd=!1;V.prototype.D=function(){return this.bd};V.prototype.eb=function(){this.bd||(this.bd=!0,this.fa())};V.prototype.g=function(a){Sq(this,bb(Tq,a))};var Sq=function(a,b){a.bd?b():(a.nb||(a.nb=[]),a.nb.push(b))};V.prototype.fa=function(){if(this.nb)for(;this.nb.length;)this.nb.shift()()};
var Tq=function(a){a&&"function"==typeof a.eb&&a.eb()},Uq=function(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];Ta(d)?Uq.apply(null,d):Tq(d)}};var Vq=function(a){this.id=a};Vq.prototype.toString=function(){return this.id};var W=function(a,b){this.type=a instanceof Vq?String(a):a;this.h=this.target=b;this.co=!0};W.prototype.l=function(){this.co=!1};var Wq=!Ee||9<=Number($e),qda=Ee&&!Ze("9"),rda=function(){if(!Ha.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});try{Ha.addEventListener("test",Oa,b),Ha.removeEventListener("test",Oa,b)}catch(c){}return a}();var Xq=function(a,b){W.call(this,a?a.type:"");this.relatedTarget=this.h=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=0;this.key="";this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.state=null;this.pointerId=0;this.pointerType="";this.g=null;a&&this.init(a,b)};w(Xq,W);var sda=yf({2:"touch",3:"pen",4:"mouse"});
Xq.prototype.init=function(a,b){var c=this.type=a.type,d=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.h=b;(b=a.relatedTarget)?He&&(ze(b,"nodeName")||(b=null)):"mouseover"==c?b=a.fromElement:"mouseout"==c&&(b=a.toElement);this.relatedTarget=b;d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:
a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0);this.button=a.button;this.key=a.key||"";this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.pointerId=a.pointerId||0;this.pointerType="string"===typeof a.pointerType?a.pointerType:sda[a.pointerType]||"";this.state=a.state;this.g=a;a.defaultPrevented&&this.l()};
Xq.prototype.l=function(){Xq.Lb.l.call(this);var a=this.g;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,qda)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var Yq="closure_listenable_"+(1E6*Math.random()|0),Zq=function(a){return!(!a||!a[Yq])},tda=0;var uda=function(a,b,c,d,e){this.listener=a;this.proxy=null;this.src=b;this.type=c;this.capture=!!d;this.fd=e;this.key=++tda;this.removed=this.Lh=!1},$q=function(a){a.removed=!0;a.listener=null;a.proxy=null;a.src=null;a.fd=null};var ar=function(a){this.src=a;this.g={};this.h=0};ar.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.g[f];a||(a=this.g[f]=[],this.h++);var g=br(a,b,d,e);-1<g?(b=a[g],c||(b.Lh=!1)):(b=new uda(b,this.src,f,!!d,e),b.Lh=c,a.push(b));return b};ar.prototype.remove=function(a,b,c,d){a=a.toString();if(!(a in this.g))return!1;var e=this.g[a];b=br(e,b,c,d);return-1<b?($q(e[b]),ac(e,b),0==e.length&&(delete this.g[a],this.h--),!0):!1};
var cr=function(a,b){var c=b.type;if(!(c in a.g))return!1;var d=bc(a.g[c],b);d&&($q(b),0==a.g[c].length&&(delete a.g[c],a.h--));return d};ar.prototype.removeAll=function(a){a=a&&a.toString();var b=0,c;for(c in this.g)if(!a||c==a){for(var d=this.g[c],e=0;e<d.length;e++)++b,$q(d[e]);delete this.g[c];this.h--}return b};var dr=function(a,b,c,d,e){a=a.g[b.toString()];b=-1;a&&(b=br(a,c,d,e));return-1<b?a[b]:null};
ar.prototype.hasListener=function(a,b){var c=void 0!==a,d=c?a.toString():"",e=void 0!==b;return Dc(this.g,function(f){for(var g=0;g<f.length;++g)if(!(c&&f[g].type!=d||e&&f[g].capture!=b))return!0;return!1})};var br=function(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.removed&&f.listener==b&&f.capture==!!c&&f.fd==d)return e}return-1};var er="closure_lm_"+(1E6*Math.random()|0),fr={},gr=0,ir=function(a,b,c,d,e){if(d&&d.once)return hr(a,b,c,d,e);if(Sa(b)){for(var f=0;f<b.length;f++)ir(a,b[f],c,d,e);return null}c=jr(c);return Zq(a)?a.listen(b,c,Va(d)?!!d.capture:!!d,e):kr(a,b,c,!1,d,e)},kr=function(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=Va(e)?!!e.capture:!!e,k=lr(a);k||(a[er]=k=new ar(a));c=k.add(b,c,d,g,f);if(c.proxy)return c;d=vda();c.proxy=d;d.src=a;d.listener=c;if(a.addEventListener)rda||(e=g),void 0===e&&
(e=!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(nr(b.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");gr++;return c},vda=function(){var a=wda,b=Wq?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b},hr=function(a,b,c,d,e){if(Sa(b)){for(var f=0;f<b.length;f++)hr(a,b[f],c,d,e);return null}c=jr(c);return Zq(a)?or(a,
b,c,Va(d)?!!d.capture:!!d,e):kr(a,b,c,!0,d,e)},pr=function(a,b,c,d,e){if(Sa(b))for(var f=0;f<b.length;f++)pr(a,b[f],c,d,e);else d=Va(d)?!!d.capture:!!d,c=jr(c),Zq(a)?a.M.remove(String(b),c,d,e):a&&(a=lr(a))&&(b=dr(a,b,c,d,e))&&qr(b)},qr=function(a){if("number"===typeof a||!a||a.removed)return!1;var b=a.src;if(Zq(b))return cr(b.M,a);var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(nr(c),d):b.addListener&&b.removeListener&&b.removeListener(d);
gr--;(c=lr(b))?(cr(c,a),0==c.h&&(c.src=null,b[er]=null)):$q(a);return!0},rr=function(a){if(a)if(Zq(a))a.zk(void 0);else if(a=lr(a)){var b=0,c;for(c in a.g)for(var d=a.g[c].concat(),e=0;e<d.length;++e)qr(d[e])&&++b}},nr=function(a){return a in fr?fr[a]:fr[a]="on"+a},tr=function(a,b,c,d){var e=!0;if(a=lr(a))if(b=a.g[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.capture==c&&!f.removed&&(f=sr(f,d),e=e&&!1!==f)}return e},sr=function(a,b){var c=a.listener,d=a.fd||a.src;a.Lh&&qr(a);
return c.call(d,b)},wda=function(a,b){if(a.removed)return!0;if(!Wq){var c=b||Na("window.event");b=new Xq(c,this);var d=!0;if(!(0>c.keyCode||void 0!=c.returnValue)){a:{var e=!1;if(0==c.keyCode)try{c.keyCode=-1;break a}catch(g){e=!0}if(e||void 0==c.returnValue)c.returnValue=!0}c=[];for(e=b.h;e;e=e.parentNode)c.push(e);a=a.type;for(e=c.length-1;0<=e;e--){b.h=c[e];var f=tr(c[e],a,!0,b);d=d&&f}for(e=0;e<c.length;e++)b.h=c[e],f=tr(c[e],a,!1,b),d=d&&f}return d}return sr(a,new Xq(b,this))},lr=function(a){a=
a[er];return a instanceof ar?a:null},ur="__closure_events_fn_"+(1E9*Math.random()>>>0),jr=function(a){if(Ua(a))return a;a[ur]||(a[ur]=function(b){return a.handleEvent(b)});return a[ur]};var X=function(){V.call(this);this.M=new ar(this);this.Nf=this;this.F=null};w(X,V);X.prototype[Yq]=!0;h=X.prototype;h.addEventListener=function(a,b,c,d){ir(this,a,b,c,d)};h.removeEventListener=function(a,b,c,d){pr(this,a,b,c,d)};
h.O=function(a){var b,c=this.F;if(c)for(b=[];c;c=c.F)b.push(c);c=this.Nf;var d=a.type||a;if("string"===typeof a)a=new W(a,c);else if(a instanceof W)a.target=a.target||c;else{var e=a;a=new W(d,c);Qc(a,e)}e=!0;if(b)for(var f=b.length-1;0<=f;f--){var g=a.h=b[f];e=g.Yf(d,!0,a)&&e}g=a.h=c;e=g.Yf(d,!0,a)&&e;e=g.Yf(d,!1,a)&&e;if(b)for(f=0;f<b.length;f++)g=a.h=b[f],e=g.Yf(d,!1,a)&&e;return e};h.fa=function(){X.Lb.fa.call(this);this.zk();this.F=null};
h.listen=function(a,b,c,d){return this.M.add(String(a),b,!1,c,d)};var or=function(a,b,c,d,e){return a.M.add(String(b),c,!0,d,e)};X.prototype.zk=function(a){this.M&&this.M.removeAll(a)};X.prototype.Yf=function(a,b,c){a=this.M.g[String(a)];if(!a)return!0;a=a.concat();for(var d=!0,e=0;e<a.length;++e){var f=a[e];if(f&&!f.removed&&f.capture==b){var g=f.listener,k=f.fd||f.src;f.Lh&&cr(this.M,f);d=!1!==g.call(k,c)&&d}}return d&&0!=c.co};
X.prototype.hasListener=function(a,b){return this.M.hasListener(void 0!==a?String(a):void 0,b)};var vr=function(a,b){this.j=a;this.l=b;this.h=0;this.g=null};vr.prototype.get=function(){if(0<this.h){this.h--;var a=this.g;this.g=a.next;a.next=null}else a=this.j();return a};var wr=function(a,b){a.l(b);100>a.h&&(a.h++,b.next=a.g,a.g=b)};var xr=function(a){Ha.setTimeout(function(){throw a;},0)},yr,xda=function(){var a=Ha.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!be("Presto")&&(a=function(){var e=eg(document,"IFRAME");e.style.display="none";oe(e);document.documentElement.appendChild(e);var f=e.contentWindow;e=f.document;e.open();e.write(ge(je));e.close();var g="callImmediate"+Math.random(),k="file:"==f.location.protocol?"*":f.location.protocol+"//"+f.location.host;
e=t(function(m){if(("*"==k||m.origin==k)&&m.data==g)this.port1.onmessage()},this);f.addEventListener("message",e,!1);this.port1={};this.port2={postMessage:function(){f.postMessage(g,k)}}});if("undefined"!==typeof a&&!be("Trident")&&!be("MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var e=c.gm;c.gm=null;e()}};return function(e){d.next={gm:e};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in eg(document,"SCRIPT")?function(e){var f=
eg(document,"SCRIPT");f.onreadystatechange=function(){f.onreadystatechange=null;f.parentNode.removeChild(f);f=null;e();e=null};document.documentElement.appendChild(f)}:function(e){Ha.setTimeout(e,0)}};var zr=function(){this.h=this.g=null},Br=new vr(function(){return new Ar},function(a){a.reset()});zr.prototype.add=function(a,b){var c=Br.get();c.set(a,b);this.h?this.h.next=c:this.g=c;this.h=c};zr.prototype.remove=function(){var a=null;this.g&&(a=this.g,this.g=this.g.next,this.g||(this.h=null),a.next=null);return a};var Ar=function(){this.next=this.scope=this.g=null};Ar.prototype.set=function(a,b){this.g=a;this.scope=b;this.next=null};Ar.prototype.reset=function(){this.next=this.scope=this.g=null};var Fr=function(a,b){Cr||yda();Dr||(Cr(),Dr=!0);Er.add(a,b)},Cr,yda=function(){if(Ha.Promise&&Ha.Promise.resolve){var a=Ha.Promise.resolve(void 0);Cr=function(){a.then(Gr)}}else Cr=function(){var b=Gr;!Ua(Ha.setImmediate)||Ha.Window&&Ha.Window.prototype&&!be("Edge")&&Ha.Window.prototype.setImmediate==Ha.setImmediate?(yr||(yr=xda()),yr(b)):Ha.setImmediate(b)}},Dr=!1,Er=new zr,Gr=function(){for(var a;a=Er.remove();){try{a.g.call(a.scope)}catch(b){xr(b)}wr(Br,a)}Dr=!1};var Hr=function(a){a.prototype.$goog_Thenable=!0},Ir=function(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(b){return!1}};var Lr=function(a,b){this.g=0;this.o=void 0;this.l=this.h=this.j=null;this.m=this.D=!1;if(a!=Oa)try{var c=this;a.call(b,function(d){Jr(c,2,d)},function(d){if(!(d instanceof Kr))try{if(d instanceof Error)throw d;throw Error("Promise rejected.");}catch(e){}Jr(c,3,d)})}catch(d){Jr(this,3,d)}},Mr=function(){this.next=this.context=this.h=this.l=this.g=null;this.j=!1};Mr.prototype.reset=function(){this.context=this.h=this.l=this.g=null;this.j=!1};
var Nr=new vr(function(){return new Mr},function(a){a.reset()}),Or=function(a,b,c){var d=Nr.get();d.l=a;d.h=b;d.context=c;return d},Pr=function(a){if(a instanceof Lr)return a;var b=new Lr(Oa);Jr(b,2,a);return b},Qr=function(a){return new Lr(function(b,c){c(a)})},Sr=function(a,b,c){Rr(a,b,c,null)||Fr(bb(b,a))},Tr=function(a){return new Lr(function(b,c){a.length||b(void 0);for(var d=0,e;d<a.length;d++)e=a[d],Sr(e,b,c)})},Ur=function(a){return new Lr(function(b,c){var d=a.length,e=[];if(d)for(var f=
function(p,u){d--;e[p]=u;0==d&&b(e)},g=function(p){c(p)},k=0,m;k<a.length;k++)m=a[k],Sr(m,bb(f,k),g);else b(e)})},Vr=function(a){return new Lr(function(b){var c=a.length,d=[];if(c)for(var e=function(k,m,p){c--;d[k]=m?{me:!0,value:p}:{me:!1,reason:p};0==c&&b(d)},f=0,g;f<a.length;f++)g=a[f],Sr(g,bb(e,f,!0),bb(e,f,!1));else b(d)})},Wr=function(){var a,b,c=new Lr(function(d,e){a=d;b=e});return new zda(c,a,b)};Lr.prototype.then=function(a,b,c){return Xr(this,Ua(a)?a:null,Ua(b)?b:null,c)};Hr(Lr);
var Zr=function(a,b,c){b=Or(b,b,c);b.j=!0;Yr(a,b);return a},$r=function(a,b){return Xr(a,null,b,void 0)};Lr.prototype.cancel=function(a){if(0==this.g){var b=new Kr(a);Fr(function(){as(this,b)},this)}};
var as=function(a,b){if(0==a.g)if(a.j){var c=a.j;if(c.h){for(var d=0,e=null,f=null,g=c.h;g&&(g.j||(d++,g.g==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(0==c.g&&1==d?as(c,b):(f?(d=f,d.next==c.l&&(c.l=d),d.next=d.next.next):bs(c),cs(c,e,3,b)))}a.j=null}else Jr(a,3,b)},Yr=function(a,b){a.h||2!=a.g&&3!=a.g||ds(a);a.l?a.l.next=b:a.h=b;a.l=b},Xr=function(a,b,c,d){var e=Or(null,null,null);e.g=new Lr(function(f,g){e.l=b?function(k){try{var m=b.call(d,k);f(m)}catch(p){g(p)}}:f;e.h=c?function(k){try{var m=c.call(d,
k);void 0===m&&k instanceof Kr?g(k):f(m)}catch(p){g(p)}}:g});e.g.j=a;Yr(a,e);return e.g};Lr.prototype.F=function(a){this.g=0;Jr(this,2,a)};Lr.prototype.C=function(a){this.g=0;Jr(this,3,a)};
var Jr=function(a,b,c){0==a.g&&(a===c&&(b=3,c=new TypeError("Promise cannot resolve to itself")),a.g=1,Rr(c,a.F,a.C,a)||(a.o=c,a.g=b,a.j=null,ds(a),3!=b||c instanceof Kr||Ada(a,c)))},Rr=function(a,b,c,d){if(a instanceof Lr)return Yr(a,Or(b||Oa,c||null,d)),!0;if(Ir(a))return a.then(b,c,d),!0;if(Va(a))try{var e=a.then;if(Ua(e))return Bda(a,e,b,c,d),!0}catch(f){return c.call(d,f),!0}return!1},Bda=function(a,b,c,d,e){var f=!1,g=function(m){f||(f=!0,c.call(e,m))},k=function(m){f||(f=!0,d.call(e,m))};try{b.call(a,
g,k)}catch(m){k(m)}},ds=function(a){a.D||(a.D=!0,Fr(a.u,a))},bs=function(a){var b=null;a.h&&(b=a.h,a.h=b.next,b.next=null);a.h||(a.l=null);return b};Lr.prototype.u=function(){for(var a;a=bs(this);)cs(this,a,this.g,this.o);this.D=!1};
var cs=function(a,b,c,d){if(3==c&&b.h&&!b.j)for(;a&&a.m;a=a.j)a.m=!1;if(b.g)b.g.j=null,es(b,c,d);else try{b.j?b.l.call(b.context):es(b,c,d)}catch(e){fs.call(null,e)}wr(Nr,b)},es=function(a,b,c){2==b?a.l.call(a.context,c):a.h&&a.h.call(a.context,c)},Ada=function(a,b){a.m=!0;Fr(function(){a.m&&fs.call(null,b)})},fs=xr,Kr=function(a){Db.call(this,a)};w(Kr,Db);Kr.prototype.name="cancel";var zda=function(a,b,c){this.ca=a;this.resolve=b;this.reject=c};var gs=function(a,b){X.call(this);this.l=a||1;this.j=b||Ha;this.m=t(this.u,this);this.o=cb()};w(gs,X);gs.prototype.enabled=!1;gs.prototype.h=null;var hs=function(a,b){a.l=b;a.h&&a.enabled?(a.stop(),a.start()):a.h&&a.stop()};gs.prototype.u=function(){if(this.enabled){var a=cb()-this.o;0<a&&a<.8*this.l?this.h=this.j.setTimeout(this.m,this.l-a):(this.h&&(this.j.clearTimeout(this.h),this.h=null),this.O("tick"),this.enabled&&(this.stop(),this.start()))}};
gs.prototype.start=function(){this.enabled=!0;this.h||(this.h=this.j.setTimeout(this.m,this.l),this.o=cb())};gs.prototype.stop=function(){this.enabled=!1;this.h&&(this.j.clearTimeout(this.h),this.h=null)};gs.prototype.fa=function(){gs.Lb.fa.call(this);this.stop();delete this.j};
var is=function(a,b,c){if(Ua(a))c&&(a=t(a,c));else if(a&&"function"==typeof a.handleEvent)a=t(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(b)?-1:Ha.setTimeout(a,b||0)},js=function(a){Ha.clearTimeout(a)},ks=function(a){var b=null;return $r(new Lr(function(c,d){b=is(function(){c(void 0)},a);-1==b&&d(Error("Failed to schedule timer."))}),function(c){js(b);throw c;})};var ls=function(){var a=void 0===a?!0:a;this.s=Pf("mr.cloud.slarti.Fetcher");this.g=0;this.h=a};ls.prototype.execute=function(a){var b=this,c="Fetch call "+ ++this.g,d=new hf(function(){return Cda(b,c,a,function(e){return d.abort(e)})},1E3,this.h?5:1);return d.start()};
var Cda=function(a,b,c,d){var e=c.uri.toString().replace(/\?.*/,"?<redacted>"),f=c.method+" "+e;y(a.s,b+": "+f);e=[kda(c).then(function(g){return Promise.resolve(fetch(g))})];c.zh&&e.push(ks(c.zh).then(function(){throw Rq("API call timed out",504);}));return Promise.race(e).then(function(g){if(!g.ok)return g.json().then(function(m){return m},function(){return null}).then(function(m){var p;m&&m instanceof Object&&m.error&&(p=m.error);throw new Qq(g,p);});var k=(cb()-c.start)/1E3;y(a.s,b+" succeeded: "+
f+" duration = "+k+"s");return(k=g.headers.get("content-type"))&&k.includes("application/json")?g.json():k&&(k.includes("image")||k.includes("application/octet-stream"))?g.blob():g.text()},function(g){var k="";if(g instanceof Qq)k=", ("+g.status+"): "+g.message,pda(g)&&d(g);else{try{k=", "+JSON.stringify(g,null,2)}catch(m){}g instanceof Error&&"Failed to fetch"==g.message&&(g=Rq(g.message))}Rf(a.s,b+" failed: "+k);throw g;})};var ms=function(a,b){this.g=Mca.g;this.rb=a;this.h=b};var ns=function(a,b){ms.call(this,a,b)};q(ns,ms);ns.prototype.register=function(a){a=new Pq({method:"POST",baseUrl:this.g,Uc:["user:register"],rb:this.rb,body:{gcmId:a}});return this.h.execute(a)};ns.prototype.unregister=function(a){a=new Pq({method:"POST",baseUrl:this.g,Uc:["user:unregister"],rb:this.rb,body:{gcmId:a}});return this.h.execute(a)};var Dda=function(a,b,c){this.s=gb("mr.cloud.slarti.GcmRegistration");this.j=a;this.h=b;this.l=c;this.g=null},Eda=function(a){if(!a.g){var b=a.h["mr.cloud.slarti.GcmRegistration.ID"];a.g=a.l.register(["307539924703"]).then(function(c){if(c==b)nb(a.s,"Slarti GCM ID unchanged: "+c);else return nb(a.s,"Got new Slarti GCM ID: "+c),(b?os(a,b):Promise.resolve()).then(function(){return a.j.register(c).then(function(){a.h["mr.cloud.slarti.GcmRegistration.ID"]=c})})},function(c){a.s.K("Error registering for GCM notifications",
c);b&&os(a,b).catch(function(d){a.s.K("Failed to unregister GCM ID with Slarti",d)});throw c;});a.g.then(function(){a.g=null},function(){a.g=null})}return a.g},os=function(a,b){return a.j.unregister(b).then(function(){delete a.h["mr.cloud.slarti.GcmRegistration.ID"]},function(c){a.s.K("Failed to unregister GCM ID with Slarti",c)})};var ps=null,qs=function(){no.call(this,5,"mr.cloud.slarti.GcmEventListener","mr.cloud.slarti.SinkDiscoveryService",chrome.gcm.onMessage);this.s=gb("mr.cloud.slarti.GcmEventListener")};q(qs,no);qs.prototype.Bh=function(a){if(a&&"307539924703"==a.from&&"object"==typeof a.data&&"string"==typeof a.data.data){var b=JSON.parse(a.data.data);a=b.type;b=b.id;if(a)return this.s.info("Received Slarti GCM notification: "+a+" ("+b+")"),!0}return!1};var rs=function(){null==ps&&(ps=new qs);return ps};var ss=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];d=a;c=l(c);for(var e=c.next();!e.done;e=c.next()){if(void 0==d||"object"!=typeof d)return;d=d[e.value]}return d};var ts=function(){no.call(this,5,"cloud.GcmEventListener","mr.cloud.discovery.WeaveSinkDiscoveryService",chrome.gcm.onMessage);this.s=gb("mr.WeaveGcmEventListener")};q(ts,no);ts.prototype.Bh=function(a){if(!a||"919648714761"!=a.from)return!1;a=ss(a,"data","notification");if(!a)return this.s.error("Notification json not found"),!1;try{var b=JSON.parse(a);return!!b&&Array.isArray(b.events)&&0<b.events.length}catch(c){return this.s.error("Invalid json: "+a),!1}};
var vs=function(){us||(us=new ts);return us},us=null;var ws=function(a){this.g=a;this.s=gb("mr.cloud.messaging.WeaveGcmMessageHandler")};ws.prototype.onMessage=function(a){var b=this;a=JSON.parse(a.data.notification);var c=am();a.events.forEach(function(d){if(d.deviceId){var e=bm(c,d.deviceId);switch(d.type){case "deviceCreated":Fda(b,d);break;case "deviceUpdated":Gda(b,d,e);break;case "deviceDeleted":Hda(b.g,{sinkId:e});break;default:nb(b.s,function(){return"[unhandled event] "+JSON.stringify(d)})}}else b.s.error("Device ID not provided")})};
var Fda=function(a,b){var c=ss(b,"statePatch","_cloudCast","settings","receiverName");"string"!=typeof c?a.s.error("Receiver name not a string: "+c):(b=new zq(b.deviceId,c,"owner","default",!0),a=a.g,a.g.g.set(b.id,b),a.g.h=Date.now(),Dq(a.h,[b.yb]))},Gda=function(a,b,c){b=ss(b,"statePatch","_cloudCast","appStatus");if("string"!=typeof b)a.s.error("App status not a string: "+b);else if(a=a.g,b="available"==b,c=a.g.ta(c))c.isAvailable=b||!1,a.g.h=Date.now(),Eq(a.h,[c.yb])};var xs=function(a,b){this.j=a;this.h=b;this.g=new Cq(this.gt.bind(this),b,2E4);this.l=new ws(this);vs().addListener();Ml(this);Xi("mr.cloud.discovery.WeaveSinkDiscoveryService",this)};q(xs,Ri);h=xs.prototype;h.se=function(){var a=this;$ca(this.j).then(function(b){a.j.subscribe(b)}).catch(function(){});return this.g.se().filter(function(b){return b.isAvailable})};h.ta=function(a){return this.g.ta(a)};
h.handleEvent=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];if(a==chrome.gcm.onMessage)this.l.onMessage.apply(this.l,n(c));else throw Error("Unhandled event: expected chrome.gcm.onMessage");};h.gt=function(){return Yca(this.j).then(function(a){return a.map(function(b){Ab("MediaRouter.Cloud.CloudReceiver.Sink.Discovered");var c=b.isAvailable()&&!(b.g.invitations&&0!=b.g.invitations.length);return new zq(b.getId(),b.h(),b.g.personalizedInfo.maxRole,"default",c)})},function(){})};
h.Ia=function(){return"WeaveSinkDiscoveryService"};h.tb=function(){return[{cache:Gq(this.g)}]};h.sb=function(){var a=Jl(this);a&&Hq(this.g,a.cache)};var Hda=function(a,b){if(b=a.g.ta(b.sinkId))a.g.g.delete(b.id),a.g.h=Date.now(),Fq(a.h,[b.yb])};var ys=Ha.JSON.parse,zs=Ha.JSON.stringify;var As=function(a,b,c,d,e,f,g,k,m){V.call(this);this.h=null;this.G=!1;this.C=Wr();this.j=[];this.F=a?encodeURIComponent(String(a)):null;this.H=null;!d&&b&&(this.H=b);this.L=c||null;this.l=!d;this.m=null!=e?e:null;this.u=f||null;this.N=!!g;this.M=k||null;this.o=null!=m?m:null};q(As,V);As.prototype.init=function(){var a=t(function(c){this.h=c;var d=Na("auth",c);Na("client.request",c)&&d?this.J():c.load("client",t(this.J,this))},this),b=Bs("gapi");b?a(b.gapi):Ida(this,a);return this.C.ca};
var Bs=function(a){for(var b=window,c=Na(a,b);!c&&b!=window.top&&Jda(b.parent,a);)b=b.parent,c=Na(a,b);return c?b:null},Jda=function(a,b){try{return!!a&&null!=a.location.href&&ze(a,b)}catch(c){return!1}},Ida=function(a,b){var c=Bs("gapi_onload");if(c){var d=c.gapi_onload;c.gapi_onload=function(){d();b(c.gapi)}}else{window.gapi_onload=function(){b(window.gapi)};var e=eg(document,"SCRIPT");pe(e,Kda);a.M&&hg(e,zs(a.M));document.getElementsByTagName("head")[0].appendChild(e)}};
As.prototype.J=function(){for(var a=0;a<this.j.length;a++)this.j[a].Kb.resolve(Cs(this,this.j[a].requestData));this.G=!0;this.C.resolve(this.h)};As.prototype.sendRequest=function(a){if(this.G)return Cs(this,a);var b=Wr();this.j.push({requestData:a,Kb:b});return b.ca};
var Cs=function(a,b){var c=Na("config.get",a.h);if(!a.l){var d=c("googleapis.config/auth/useFirstPartyAuth");var e=c("googleapis.config/auth/useOriginToken")}var f;null!=a.m&&(f=c("client/cors"));var g;null!=a.o&&(g=c("client/xd4"));try{var k=Na("config.update",a.h);a.l||(k("googleapis.config/auth/useFirstPartyAuth",!1),k("googleapis.config/auth/useOriginToken",!1));null!=a.m&&k("client/cors",a.m);null!=a.o&&k("client/xd4",a.o);var m=Lda(a);b.headers&&Qc(m,b.headers);var p={headers:m,root:a.L,path:b.path,
method:b.method,body:b.body},u=b.params||{};a.F&&!a.u?Qc(u,{key:a.F}):a.u&&Qc(u,{key:null});Kc(u)||(p.params=u);var A=Pr(Na("client.request",a.h)(p));b.callback&&A.then(function(E){b.callback.apply(null,[E.result,E])},function(E){b.callback.apply(null,[E.result,E])});return A}finally{c=Na("config.update",a.h),a.l||(c("googleapis.config/auth/useFirstPartyAuth",d),c("googleapis.config/auth/useOriginToken",e)),null!=a.m&&c("client/cors",f),null!=a.o&&c("client/xd4",g)}},Lda=function(a){if(a.l){if(a.u)return{Authorization:"Bearer "+
a.u};var b=Na("auth.getAuthHeaderValueForFirstParty",a.h);return{Authorization:a.N?b([]):b(),"X-Goog-AuthUser":a.H}}return{}},Kda=new hd(fd,Vc(new Uc(Sc,"https://apis.google.com/js/client.js")));var Mda=function(a){this.g=a},oq=function(a,b,c){var d="";b.forEach(function(e){d+="/"+encodeURIComponent(e)});a=new Jp(a+d);c&&(c=Tp(c),Mp(a,c));return a},pq=function(a,b,c,d){return a.g.getAuthToken().then(function(e){var f=Nda(e);return Oda(f,b,c,d).catch(function(g){if("INVALID_ACCESS_ERROR"==g)return Pda(a,e,b,c,d);throw g;})})},Pda=function(a,b,c,d,e){return ida(b).then(function(){return pq(a,c,d,e)})},Oda=function(a,b,c,d){return new Promise(function(e,f){a.sendRequest(Qda(b,c,function(g){g&&
!g.error?e(g):g&&401==g.error.code?f("INVALID_ACCESS_ERROR"):f(g&&g.error?g.error.errors?g.error.errors[0]:g:Error(g))},d))})},Nda=function(a){a=new As(void 0,void 0,void 0,!1,!1,a);a.init();return a},Qda=function(a,b,c,d){a={callback:c,method:b,path:a.toString()};d&&(a.body=d);return a};var Ds={Jw:{1E3:{other:"0K"},1E4:{other:"00K"},1E5:{other:"000K"},1E6:{other:"0M"},1E7:{other:"00M"},1E8:{other:"000M"},1E9:{other:"0B"},1E10:{other:"00B"},1E11:{other:"000B"},1E12:{other:"0T"},1E13:{other:"00T"},1E14:{other:"000T"}},Iw:{1E3:{other:"0 thousand"},1E4:{other:"00 thousand"},1E5:{other:"000 thousand"},1E6:{other:"0 million"},1E7:{other:"00 million"},1E8:{other:"000 million"},1E9:{other:"0 billion"},1E10:{other:"00 billion"},1E11:{other:"000 billion"},1E12:{other:"0 trillion"},1E13:{other:"00 trillion"},
1E14:{other:"000 trillion"}}},Es=Ds;Es=Ds;var Fs={AED:[2,"dh","\u062f.\u0625."],ALL:[0,"Lek","Lek"],AUD:[2,"$","AU$"],BDT:[2,"\u09f3","Tk"],BGN:[2,"lev","lev"],BRL:[2,"R$","R$"],CAD:[2,"$","C$"],CDF:[2,"FrCD","CDF"],CHF:[2,"CHF","CHF"],CLP:[0,"$","CL$"],CNY:[2,"\u00a5","RMB\u00a5"],COP:[32,"$","COL$"],CRC:[0,"\u20a1","CR\u20a1"],CZK:[50,"K\u010d","K\u010d"],DKK:[50,"kr.","kr."],DOP:[2,"RD$","RD$"],EGP:[2,"\u00a3","LE"],ETB:[2,"Birr","Birr"],EUR:[2,"\u20ac","\u20ac"],GBP:[2,"\u00a3","GB\u00a3"],HKD:[2,"$","HK$"],HRK:[2,"kn","kn"],HUF:[34,
"Ft","Ft"],IDR:[0,"Rp","Rp"],ILS:[34,"\u20aa","IL\u20aa"],INR:[2,"\u20b9","Rs"],IRR:[0,"Rial","IRR"],ISK:[0,"kr","kr"],JMD:[2,"$","JA$"],JPY:[0,"\u00a5","JP\u00a5"],KRW:[0,"\u20a9","KR\u20a9"],LKR:[2,"Rs","SLRs"],LTL:[2,"Lt","Lt"],MNT:[0,"\u20ae","MN\u20ae"],MVR:[2,"Rf","MVR"],MXN:[2,"$","Mex$"],MYR:[2,"RM","RM"],NOK:[50,"kr","NOkr"],PAB:[2,"B/.","B/."],PEN:[2,"S/.","S/."],PHP:[2,"\u20b1","PHP"],PKR:[0,"Rs","PKRs."],PLN:[50,"z\u0142","z\u0142"],RON:[2,"RON","RON"],RSD:[0,"din","RSD"],RUB:[50,"\u20bd",
"RUB"],SAR:[2,"Rial","Rial"],SEK:[50,"kr","kr"],SGD:[2,"$","S$"],THB:[2,"\u0e3f","THB"],TRY:[2,"\u20ba","TRY"],TWD:[2,"NT$","NT$"],TZS:[0,"TSh","TSh"],UAH:[2,"\u0433\u0440\u043d.","UAH"],USD:[2,"$","US$"],UYU:[2,"$","$U"],VND:[48,"\u20ab","VN\u20ab"],YER:[0,"Rial","Rial"],ZAR:[2,"R","ZAR"]};var Gs={nl:".",Bi:",",Cl:"%",Hi:"0",Gp:"+",xl:"-",rl:"E",Dl:"\u2030",Ci:"\u221e",Bp:"NaN",cp:"#,##0.###",BB:"#E0",yA:"#,##0%",Ww:"\u00a4#,##0.00",ol:"USD"},Hs=Gs;Hs=Gs;var Js=function(){this.C=40;this.h=1;this.j=3;this.H=this.D=0;this.L=!1;this.G=this.u="";this.l=Hs.xl;this.F="";this.g=1;this.o=!1;this.m=[];this.M=this.J=!1;var a=Hs.cp;a.replace(/ /g,"\u00a0");var b=[0];this.u=Is(this,a,b);for(var c=b[0],d=-1,e=0,f=0,g=0,k=-1,m=a.length,p=!0;b[0]<m&&p;b[0]++)switch(a.charAt(b[0])){case "#":0<f?g++:e++;0<=k&&0>d&&k++;break;case "0":if(0<g)throw Error('Unexpected "0" in pattern "'+a+'"');f++;0<=k&&0>d&&k++;break;case ",":0<k&&this.m.push(k);k=0;break;case ".":if(0<=
d)throw Error('Multiple decimal separators in pattern "'+a+'"');d=e+f+g;break;case "E":if(this.M)throw Error('Multiple exponential symbols in pattern "'+a+'"');this.M=!0;this.H=0;b[0]+1<m&&"+"==a.charAt(b[0]+1)&&(b[0]++,this.L=!0);for(;b[0]+1<m&&"0"==a.charAt(b[0]+1);)b[0]++,this.H++;if(1>e+f||1>this.H)throw Error('Malformed exponential pattern "'+a+'"');p=!1;break;default:b[0]--,p=!1}0==f&&0<e&&0<=d&&(f=d,0==f&&f++,g=e-f,e=f-1,f=1);if(0>d&&0<g||0<=d&&(d<e||d>e+f)||0==k)throw Error('Malformed pattern "'+
a+'"');g=e+f+g;this.j=0<=d?g-d:0;0<=d&&(this.D=e+f-d,0>this.D&&(this.D=0));this.h=(0<=d?d:g)-e;this.M&&(this.C=e+this.h,0==this.j&&0==this.h&&(this.h=1));this.m.push(Math.max(0,k));this.J=0==d||d==g;c=b[0]-c;this.G=Is(this,a,b);b[0]<a.length&&";"==a.charAt(b[0])?(b[0]++,1!=this.g&&(this.o=!0),this.l=Is(this,a,b),b[0]+=c,this.F=Is(this,a,b)):(this.l+=this.u,this.F+=this.G)};
Js.prototype.parse=function(a,b){b=b||[0];a=a.replace(/ |\u202f/g,"\u00a0");var c=a.indexOf(this.u,b[0])==b[0],d=a.indexOf(this.l,b[0])==b[0];c&&d&&(this.u.length>this.l.length?d=!1:this.u.length<this.l.length&&(c=!1));c?b[0]+=this.u.length:d&&(b[0]+=this.l.length);if(a.indexOf(Hs.Ci,b[0])==b[0]){b[0]+=Hs.Ci.length;var e=Infinity}else{e=a;var f=!1,g=!1,k=!1,m=-1,p=1,u=Hs.nl,A=Hs.Bi,E=Hs.rl;A=A.replace(/\u202f/g,"\u00a0");for(var F="";b[0]<e.length;b[0]++){var J=e.charAt(b[0]),U=Ks(J);if(0<=U&&9>=
U)F+=U,k=!0;else if(J==u.charAt(0)){if(f||g)break;F+=".";f=!0}else if(J==A.charAt(0)&&("\u00a0"!=A.charAt(0)||b[0]+1<e.length&&0<=Ks(e.charAt(b[0]+1)))){if(f||g)break}else if(J==E.charAt(0)){if(g)break;F+="E";g=!0;m=b[0]}else if("+"==J||"-"==J){if(k&&m!=b[0]-1)break;F+=J}else if(1==this.g&&J==Hs.Cl.charAt(0)){if(1!=p)break;p=100;if(k){b[0]++;break}}else if(1==this.g&&J==Hs.Dl.charAt(0)){if(1!=p)break;p=1E3;if(k){b[0]++;break}}else break}1!=this.g&&(p=this.g);e=parseFloat(F)/p}if(c){if(a.indexOf(this.G,
b[0])!=b[0])return NaN;b[0]+=this.G.length}else if(d){if(a.indexOf(this.F,b[0])!=b[0])return NaN;b[0]+=this.F.length}return d?-e:e};
Js.prototype.format=function(a){if(isNaN(a))return Hs.Bp;var b=[];var c=Rda;a=Ls(a,-c.sr);b.push(c.prefix);var d=0>a||0==a&&0>1/a;b.push(d?this.l:this.u);if(isFinite(a))if(a=a*(d?-1:1)*this.g,this.M)if(0==a)Ms(this,a,this.h,b),Ns(this,0,b);else{var e=Math.floor(Math.log(a)/Math.log(10)+2E-15);a=Ls(a,-e);var f=this.h;1<this.C&&this.C>this.h?(f=e%this.C,0>f&&(f=this.C+f),a=Ls(a,f),e-=f,f=1):1>this.h?(e++,a=Ls(a,-1)):(e-=this.h-1,a=Ls(a,this.h-1));Ms(this,a,f,b);Ns(this,e,b)}else Ms(this,a,this.h,b);
else b.push(Hs.Ci);b.push(d?this.F:this.G);b.push(c.lv);return b.join("")};
var Ms=function(a,b,c,d){if(a.D>a.j)throw Error("Min value must be less than max value");d||(d=[]);var e=Ls(b,a.j);e=Math.round(e);if(isFinite(e)){b=Math.floor(Ls(e,-a.j));var f=Math.floor(e-Ls(b,a.j))}else f=0;e=b;b=f;var g=e;f=b;var k=0<a.D||0<f||!1;e=a.D;k&&(e=a.D);var m="";for(b=g;1E20<b;)m="0"+m,b=Math.round(Ls(b,-1));m=b+m;var p=Hs.nl;b=Hs.Hi.charCodeAt(0);var u=m.length,A=0;if(0<g||0<c){for(g=u;g<c;g++)d.push(String.fromCharCode(b));if(2<=a.m.length)for(c=1;c<a.m.length;c++)A+=a.m[c];c=u-A;
if(0<c){g=a.m;A=u=0;for(var E,F=Hs.Bi,J=m.length,U=0;U<J;U++)if(d.push(String.fromCharCode(b+1*Number(m.charAt(U)))),1<J-U)if(E=g[A],U<c){var va=c-U;(1===E||0<E&&1===va%E)&&d.push(F)}else A<g.length&&(U===c?A+=1:E===U-c-u+1&&(d.push(F),u+=E,A+=1))}else{c=m;m=a.m;g=Hs.Bi;E=c.length;F=[];for(u=m.length-1;0<=u&&0<E;u--){A=m[u];for(J=0;J<A&&0<=E-J-1;J++)F.push(String.fromCharCode(b+1*Number(c.charAt(E-J-1))));E-=A;0<E&&F.push(g)}d.push.apply(d,F.reverse())}}else k||d.push(String.fromCharCode(b));(a.J||
k)&&d.push(p);k=String(f);f=k.split("e+");if(2==f.length){if(k=parseFloat(f[0])){p=k;if(isFinite(p)){for(c=0;1<=(p/=10);)c++;p=c}else p=0<p?p:0;p=0-p-1;k=-1>p?k&&isFinite(k)?Ls(Math.round(Ls(k,-1)),1):k:k&&isFinite(k)?Ls(Math.round(Ls(k,p)),-p):k}k=String(k);k=k.replace(".","");k+=re("0",parseInt(f[1],10)-k.length+1)}a.j+1>k.length&&(k="1"+re("0",a.j-k.length)+k);for(a=k.length;"0"==k.charAt(a-1)&&a>e+1;)a--;for(g=1;g<a;g++)d.push(String.fromCharCode(b+1*Number(k.charAt(g))))},Ns=function(a,b,c){c.push(Hs.rl);
0>b?(b=-b,c.push(Hs.xl)):a.L&&c.push(Hs.Gp);b=""+b;for(var d=Hs.Hi,e=b.length;e<a.H;e++)c.push(d);c.push(b)},Ks=function(a){a=a.charCodeAt(0);if(48<=a&&58>a)return a-48;var b=Hs.Hi.charCodeAt(0);return b<=a&&a<b+10?a-b:-1},Is=function(a,b,c){for(var d="",e=!1,f=b.length;c[0]<f;c[0]++){var g=b.charAt(c[0]);if("'"==g)c[0]+1<f&&"'"==b.charAt(c[0]+1)?(c[0]++,d+="'"):e=!e;else if(e)d+=g;else switch(g){case "#":case "0":case ",":case ".":case ";":return d;case "\u00a4":c[0]+1<f&&"\u00a4"==b.charAt(c[0]+
1)?(c[0]++,d+=Hs.ol):(g=Hs.ol,d+=g in Fs?Fs[g][1]:g);break;case "%":if(!a.o&&1!=a.g)throw Error("Too many percent/permill");if(a.o&&100!=a.g)throw Error("Inconsistent use of percent/permill characters");a.g=100;a.o=!1;d+=Hs.Cl;break;case "\u2030":if(!a.o&&1!=a.g)throw Error("Too many percent/permill");if(a.o&&1E3!=a.g)throw Error("Inconsistent use of percent/permill characters");a.g=1E3;a.o=!1;d+=Hs.Dl;break;default:d+=g}}return d},Rda={prefix:"",lv:"",sr:0},Ls=function(a,b){if(!a||!isFinite(a)||
0==b)return a;a=String(a).split("e");return parseFloat(a[0]+"e"+(parseInt(a[1]||0,10)+b))};var Os=function(a){return 1==a%10&&11!=a%100?"one":2==a%10&&12!=a%100?"two":3==a%10&&13!=a%100?"few":"other"},Ps=Os;Ps=Os;var Qs=function(a,b){if(void 0===b){b=a+"";var c=b.indexOf(".");b=Math.min(-1==c?0:b.length-c-1,3)}return 1==(a|0)&&0==b?"one":"other"},Rs=Qs;Rs=Qs;var Vs=function(){this.l=Sda;this.h=this.g=this.m=null;var a=Hs,b=Es;if(Ss!==a||Ts!==b)Ss=a,Ts=b,Us=new Js;this.D=Us},Ss=null,Ts=null,Us=null,Tda=/'([{}#].*?)'/g,Uda=/''/g;Vs.prototype.format=function(a){if(this.l){this.m=[];var b=Vda(this,this.l);this.h=Ws(this,b);this.l=null}if(this.h&&0!=this.h.length)for(this.g=x(this.m),b=[],Xs(this,this.h,a,!1,b),a=b.join("");0<this.g.length;)a=a.replace(this.j(this.g),this.g.pop());else a="";return a};
var Xs=function(a,b,c,d,e){for(var f=0;f<b.length;f++)switch(b[f].type){case 4:e.push(b[f].value);break;case 3:var g=b[f].value,k=a,m=e,p=c[g];void 0===p?m.push("Undefined parameter - "+g):(k.g.push(p),m.push(k.j(k.g)));break;case 2:g=b[f].value;k=a;m=c;p=d;var u=e,A=g.Kh;void 0===m[A]?u.push("Undefined parameter - "+A):(A=g[m[A]],void 0===A&&(A=g.other),Xs(k,A,m,p,u));break;case 0:g=b[f].value;Ys(a,g,c,Rs,d,e);break;case 1:g=b[f].value;Ys(a,g,c,Ps,d,e);break;default:Gb("Unrecognized block type: "+
b[f].type)}},Ys=function(a,b,c,d,e,f){var g=b.Kh,k=b.Wl,m=+c[g];isNaN(m)?f.push("Undefined or invalid parameter - "+g):(k=m-k,g=b[c[g]],void 0===g&&(d=d(Math.abs(k)),g=b[d],void 0===g&&(g=b.other)),b=[],Xs(a,g,c,e,b),c=b.join(""),e?f.push(c):(a=a.D.format(k),f.push(c.replace(/#/g,a))))},Vda=function(a,b){var c=a.m,d=t(a.j,a);b=b.replace(Uda,function(){c.push("'");return d(c)});return b=b.replace(Tda,function(e,f){c.push(f);return d(c)})},Zs=function(a){var b=0,c=[],d=[],e=/[{}]/g;e.lastIndex=0;for(var f;f=
e.exec(a);){var g=f.index;"}"==f[0]?(c.pop(),0==c.length&&(f={type:1},f.value=a.substring(b,g),d.push(f),b=g+1)):(0==c.length&&(b=a.substring(b,g),""!=b&&d.push({type:0,value:b}),b=g+1),c.push("{"))}b=a.substring(b);""!=b&&d.push({type:0,value:b});return d},$s=/^\s*(\w+)\s*,\s*plural\s*,(?:\s*offset:(\d+))?/,at=/^\s*(\w+)\s*,\s*selectordinal\s*,/,bt=/^\s*(\w+)\s*,\s*select\s*,/,Ws=function(a,b){var c=[];b=Zs(b);for(var d=0;d<b.length;d++){var e={};if(0==b[d].type)e.type=4,e.value=b[d].value;else if(1==
b[d].type){var f=b[d].value;switch($s.test(f)?0:at.test(f)?1:bt.test(f)?2:/^\s*\w+\s*/.test(f)?3:5){case 2:e.type=2;e.value=Wda(a,b[d].value);break;case 0:e.type=0;e.value=Xda(a,b[d].value);break;case 1:e.type=1;e.value=Yda(a,b[d].value);break;case 3:e.type=3;e.value=b[d].value;break;default:Gb("Unknown block type for pattern: "+b[d].value)}}else Gb("Unknown part of the pattern.");c.push(e)}return c},Wda=function(a,b){var c="";b=b.replace(bt,function(k,m){c=m;return""});var d={};d.Kh=c;b=Zs(b);for(var e=
0;e<b.length;){var f=b[e].value;e++;var g;1==b[e].type?g=Ws(a,b[e].value):Gb("Expected block type.");d[f.replace(/\s/g,"")]=g;e++}return d},Xda=function(a,b){var c="",d=0;b=b.replace($s,function(m,p,u){c=p;u&&(d=parseInt(u,10));return""});var e={};e.Kh=c;e.Wl=d;b=Zs(b);for(var f=0;f<b.length;){var g=b[f].value;f++;var k;1==b[f].type?k=Ws(a,b[f].value):Gb("Expected block type.");e[g.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=k;f++}return e},Yda=function(a,b){var c="";b=b.replace(at,function(k,m){c=m;return""});
var d={};d.Kh=c;d.Wl=0;b=Zs(b);for(var e=0;e<b.length;){var f=b[e].value;e++;if(1==b[e].type)var g=Ws(a,b[e].value);else Gb("Expected block type.");d[f.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=g;e++}return d};Vs.prototype.j=function(a){return"\ufddf_"+(a.length-1).toString(10)+"_"};var ct=chrome.i18n.getMessage("1522140683318860351"),dt=chrome.i18n.getMessage("4246483347873264186"),et=chrome.i18n.getMessage("5991427458288444010"),ti=chrome.i18n.getMessage("6063910461797960050"),Zda=chrome.i18n.getMessage("7735695102441495789"),$da=chrome.i18n.getMessage("4575332923598659024"),Sda=chrome.i18n.getMessage("2297080986956220930"),ft=new Vs;var aea=function(a){this.g=a;this.s=gb("mr.cloud.mesi.MesiService")},fda=function(a){var b=oq(Oca.g,["hangouts","search"]);a.s.info("Retrieving Hangouts from MESI: "+b);return pq(a.g,b,"POST",bea).then(function(c){var d=[];c.result&&(d=c.result.map(function(e){var f=e.hangout,g=f.meeting_room_name,k;f.meeting_domain?k=f.meeting_domain:"BUSINESS"==f.type&&f.company_title&&(k=f.company_title.toLowerCase());var m=ft.format({ORGANIZER:"",PARTICIPANTS:0});if((e=e.participant)&&0<e.length){var p=e[0].display_name;
m=e.reduce(function(u,A){u.add(A.user_id);"ORGANIZER"==A.role&&(p=A.display_name);return u},new Set);m=ft.format({ORGANIZER:p,PARTICIPANTS:m.size})}return g&&k?new lq(!1,g+"@"+k,k,g,m,f.hangout_id):new lq(!1,f.hangout_id,k,g,m,f.hangout_id)}));return d})},bea={request_header:{client_version:{client_id:"39"}},search_sources:["0"]};var cea=function(a,b){this.h=a;this.g=b},dea=function(a,b,c,d){switch(b.type){case "REFRESH_AUTH":var e=d.Vd,f=d.deviceId,g=d.xh;return jda(a.h).then(function(){gt(a.g,new sj("AUTH_READY",{Vd:e,Va:f,xh:g}),c.id)});case "STATUS_REQUEST":return gt(a.g,b,c.id),Promise.resolve();case "STATUS_RESPONSE":return gt(a.g,b,c.id,!0),b.data.routeDescription||gt(a.g,b,c.id),Promise.resolve();case "HANGOUT_INACTIVE":return ht(a.g,c,4,xi(new si(Zda,"warning"),c.sinkId));case "HANGOUT_INVALID":return ht(a.g,c,3,
xi(new si($da,"warning"),c.sinkId));default:return Promise.reject(Error("Unknown type: "+b.type))}};var it=new Map([["status","status"],["results","result"],["expirationTime","expiration_time"]]),jt=function(a,b){ms.call(this,a,b);this.s=Pf("mr.cloud.slarti.CommandsService")};q(jt,ms);jt.prototype.get=function(a){a=new Pq({method:"GET",baseUrl:this.g,Uc:["commands",a],rb:this.rb});return this.h.execute(a).then(function(b){return b})};
jt.prototype.list=function(a){a=new Pq({method:"GET",baseUrl:this.g,Uc:["commands"],Un:{deviceId:a},rb:this.rb});return this.h.execute(a).then(function(b){return b.command||[]})};jt.prototype.send=function(a,b){var c=this;a=new Pq({method:"POST",baseUrl:this.g,Uc:["commands:send"],rb:this.rb,body:{command:b,deviceId:a}});return this.h.execute(a).then(function(d){c.s.info("Sent Slarti command with ID "+d.id);return d})};
jt.prototype.update=function(a,b){for(var c=[],d={},e=l(it.keys()),f=e.next();!f.done;f=e.next())f=f.value,b[f]&&(d[f]=b[f],c.push(it.get(f)));d.id=a;a=new Pq({method:"PUT",baseUrl:this.g,Uc:["commands",a],rb:this.rb,body:{command:d,updateMask:c}});return this.h.execute(a).then(function(g){return g})};var eea=Ha.JSON.parse;var kt=function(){};kt.prototype.g=null;kt.prototype.getOptions=function(){var a;(a=this.g)||(a={},lt(this)&&(a[0]=!0,a[1]=!0),a=this.g=a);return a};var mt,nt=function(){};w(nt,kt);var ot=function(a){return(a=lt(a))?new ActiveXObject(a):new XMLHttpRequest},lt=function(a){if(!a.h&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.h=d}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed");}return a.h};mt=new nt;var pt=function(a){X.call(this);this.headers=new mm;this.X=a||null;this.j=!1;this.W=this.h=null;this.ja=this.L="";this.u=0;this.l="";this.m=this.ia=this.J=this.ea=!1;this.o=0;this.G=null;this.C="";this.N=this.H=!1};w(pt,X);pt.prototype.s=Pf("goog.net.XhrIo");var fea=/^https?$/i,gea=["POST","PUT"],qt=[],rt=function(a,b,c,d,e,f,g){var k=new pt;qt.push(k);b&&k.listen("complete",b);or(k,"ready",k.xa);f&&(k.o=Math.max(0,f));g&&(k.H=g);k.send(a,c,d,e);return k};
pt.prototype.xa=function(){this.eb();bc(qt,this)};
pt.prototype.send=function(a,b,c,d){if(this.h)throw Error("[goog.net.XhrIo] Object is active with another request="+this.L+"; newUri="+a);b=b?b.toUpperCase():"GET";this.L=a;this.l="";this.u=0;this.ja=b;this.ea=!1;this.j=!0;this.h=this.X?ot(this.X):ot(mt);this.W=this.X?this.X.getOptions():mt.getOptions();this.h.onreadystatechange=t(this.ra,this);try{Tf(this.s,st(this,"Opening Xhr")),this.ia=!0,this.h.open(b,String(a),!0),this.ia=!1}catch(f){Tf(this.s,st(this,"Error opening Xhr: "+f.message));tt(this,
f);return}a=c||"";var e=this.headers.clone();d&&Sm(d,function(f,g){e.set(g,f)});d=Sb(e.Qb(),hea);c=Ha.FormData&&a instanceof Ha.FormData;!Vb(gea,b)||d||c||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");e.forEach(function(f,g){this.h.setRequestHeader(g,f)},this);this.C&&(this.h.responseType=this.C);"withCredentials"in this.h&&this.h.withCredentials!==this.H&&(this.h.withCredentials=this.H);try{ut(this),0<this.o&&(this.N=iea(this.h),Tf(this.s,st(this,"Will abort after "+this.o+
"ms if incomplete, xhr2 "+this.N)),this.N?(this.h.timeout=this.o,this.h.ontimeout=t(this.ua,this)):this.G=is(this.ua,this.o,this)),Tf(this.s,st(this,"Sending request")),this.J=!0,this.h.send(a),this.J=!1}catch(f){Tf(this.s,st(this,"Send error: "+f.message)),tt(this,f)}};var iea=function(a){return Ee&&Ze(9)&&"number"===typeof a.timeout&&void 0!==a.ontimeout},hea=function(a){return kd("Content-Type",a)};
pt.prototype.ua=function(){"undefined"!=typeof Ga&&this.h&&(this.l="Timed out after "+this.o+"ms, aborting",this.u=8,Tf(this.s,st(this,this.l)),this.O("timeout"),this.abort(8))};var tt=function(a,b){a.j=!1;a.h&&(a.m=!0,a.h.abort(),a.m=!1);a.l=b;a.u=5;vt(a);wt(a)},vt=function(a){a.ea||(a.ea=!0,a.O("complete"),a.O("error"))};pt.prototype.abort=function(a){this.h&&this.j&&(Tf(this.s,st(this,"Aborting")),this.j=!1,this.m=!0,this.h.abort(),this.m=!1,this.u=a||7,this.O("complete"),this.O("abort"),wt(this))};
pt.prototype.fa=function(){this.h&&(this.j&&(this.j=!1,this.m=!0,this.h.abort(),this.m=!1),wt(this,!0));pt.Lb.fa.call(this)};pt.prototype.ra=function(){this.D()||(this.ia||this.J||this.m?xt(this):this.Da())};pt.prototype.Da=function(){xt(this)};
var xt=function(a){if(a.j&&"undefined"!=typeof Ga)if(a.W[1]&&4==yt(a)&&2==a.Xa())Tf(a.s,st(a,"Local request error detected and ignored"));else if(a.J&&4==yt(a))is(a.ra,0,a);else if(a.O("readystatechange"),4==yt(a)){Tf(a.s,st(a,"Request complete"));a.j=!1;try{if(zt(a))a.O("complete"),a.O("success");else{a.u=6;try{var b=2<yt(a)?a.h.statusText:""}catch(c){Tf(a.s,"Can not get status: "+c.message),b=""}a.l=b+" ["+a.Xa()+"]";vt(a)}}finally{wt(a)}}},wt=function(a,b){if(a.h){ut(a);var c=a.h,d=a.W[0]?Oa:null;
a.h=null;a.W=null;b||a.O("ready");try{c.onreadystatechange=d}catch(e){Rf(a.s,"Problem encountered resetting onreadystatechange: "+e.message)}}},ut=function(a){a.h&&a.N&&(a.h.ontimeout=null);a.G&&(js(a.G),a.G=null)},zt=function(a){var b=a.Xa();a:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break a;default:c=!1}if(!c){if(b=0===b)a=String(a.L).match(Fp)[1]||null,!a&&Ha.self&&Ha.self.location&&(a=Ha.self.location.protocol,a=a.substr(0,a.length-1)),b=!fea.test(a?a.toLowerCase():
"");c=b}return c},yt=function(a){return a.h?a.h.readyState:0};pt.prototype.Xa=function(){try{return 2<yt(this)?this.h.status:-1}catch(a){return-1}};
var At=function(a){try{return a.h?a.h.responseText:""}catch(b){return Tf(a.s,"Can not get responseText: "+b.message),""}},jea=function(a){if(a.h)return eea(a.h.responseText)},kea=function(a){try{if(!a.h)return null;if("response"in a.h)return a.h.response;switch(a.C){case "":case "text":return a.h.responseText;case "arraybuffer":if("mozResponseArrayBuffer"in a.h)return a.h.mozResponseArrayBuffer}Rf(a.s,"Response type "+a.C+" is not supported on this browser");return null}catch(b){return Tf(a.s,"Can not get response: "+
b.message),null}};pt.prototype.getResponseHeader=function(a){if(this.h&&4==yt(this))return a=this.h.getResponseHeader(a),null===a?void 0:a};var lea=function(a){var b={};a=(a.h&&4==yt(a)?a.h.getAllResponseHeaders()||"":"").split("\r\n");for(var c=0;c<a.length;c++)if(!ld(a[c])){var d=we(a[c],":",1),e=d[0];d=d[1];if("string"===typeof d){d=d.trim();var f=b[e]||[];b[e]=f;f.push(d)}}return Cc(b,function(g){return g.join(", ")})},st=function(a,b){return b+" ["+a.ja+" "+a.L+" "+a.Xa()+"]"};var mea=function(){this.s=gb("mr.cloud.CredentialService")},Bt=function(a){var b=new Cb,c=kq.g+"/iceconfig?key="+kq.h;a.s.info("Requesting TURN credentials from "+c);var d=rt(c,function(){zt(d)?(a.s.info("Got TURN credentials: "+At(d)),b.resolve(nea(a,jea(d)))):b.resolve(oea(a))},"POST",void 0,{"Content-Type":"application/json"});return b.g},nea=function(a,b){try{var c=[];b.iceServers.forEach(function(d){d.urls.forEach(function(e){0==e.indexOf("turn:")&&c.push({url:e,credential:d.credential,username:d.username})})});
return c}catch(d){return a.s.error("Error parsing TURN credentials.",d),[]}},oea=function(a){a.s.error("XHR failed fetching TURN credentials.",null);return[]};var pea=function(a,b,c){this.s=gb("mr.cloud.slarti.MessageHandler");this.j=a;this.l=b;this.g=c;this.h=new Map},qea=function(a){if(aj(a.mediaSource))return Promise.resolve({title:"screen"});var b=a.Db&&a.Db.tabId;return null==b?Promise.resolve({title:"",url:""}):new Promise(function(c){chrome.tabs.get(b,function(d){c({title:d&&d.title||"",url:d&&d.url||""})})})},rea=function(a,b,c,d){var e=d.deviceId,f=b.data;return qea(c).then(function(g){g={id:null,issuer:null,name:"stream",status:null,results:null,
expirationTime:null,parameters:JSON.stringify({info:g,sessionDescription:f.description,mediaConstraints:f.mediaConstraints,settings:f.settings})};return a.j.send(e,g).then(function(k){return new Promise(function(m,p){a.h.set(k.id,{routeId:c.id,sinkId:d.id,resolve:m,reject:p,Is:"PENDING_APPROVAL"==k.status})})},function(){ht(a.g,c.id,7,xi(wi(vi(new si(ct,"warning")),c.id),d.id))})})},sea=function(a,b){return Bt(a.l).then(function(c){gt(a.g,new sj("TURN_CREDENTIALS",{credentials:c}),b.id)})};var tea=function(a,b,c,d){this.h=a;this.j=b;this.l=c;this.g=d},wea=function(a,b,c,d,e){return new Promise(function(f){switch(b){case "slarti":case "weave":case "mesi":break;default:throw Error("Unrecognized channel type: "+b);}if(!c.type)throw Error("Message has no type");switch(c.type){case "STOP":f(ht(a.g,d,1,null));return;case "SESSION_START_SUCCESS":fq(0);break;case "SESSION_END":break;case "SESSION_FAILURE":fq(1);f(ht(a.g,d,2,xi(new si(ct,"warning"),d?d.sinkId:"")));return;case "__webrtc_stats__":break;
case "PRESENTATION_CONNECTION_MESSAGE":gt(a.g,c.data,d.id,!0);break;case "OFFER":switch(b){case "slarti":f(rea(a.h,c,d,e));return;case "weave":f(uea(a.j,c,d,e));return;default:throw Error("Unexpected channel type: "+b);}case "GET_TURN_CREDENTIALS":switch(b){case "slarti":f(sea(a.h,d));return;case "weave":f(vea(a.j,d));return;default:throw Error("Unexpected channel type: "+b);}case "REFRESH_AUTH":case "LOCAL_PRESENT":case "MUTE":case "STATUS_REQUEST":case "STATUS_RESPONSE":case "HANGOUT_INACTIVE":case "HANGOUT_INVALID":f(dea(a.l,
c,d,e));return;case "new_session":gt(a.g,c,d.id,!0);break;case "remove_session":gt(a.g,c,d.id,!0);a.g.terminateRoute(d.id);break;default:throw Error("Unknown type: "+c.type);}f()})};var Ct=function(a,b,c){this.state=a;this.type=null!=b?b:null;this.results=null!=c?c:null},Dt=function(a){this.g=a},xea=function(a,b,c,d){return Et(a,Vca,b,c,d,35E3).then(function(e){return Ft(a,e)})},yea=function(a,b,c,d){return Et(a,Wca,b,c,d,23E3).then(function(e){var f=e.state;return"done"==f?(e=Gt(e),new Ct(f,e.type,new tq(e.sessionDescription))):new Ct(f)})},Et=function(a,b,c,d,e,f){var g={_webrtcMessage:JSON.stringify(d.presentationUrl?new tq(d.description,null,d.presentationUrl,d.presentationId):
new tq(d.description))};d.settings&&(g._settings=pj(d.settings));d.mediaConstraints&&(g._optMediaConstraints=JSON.stringify(d.mediaConstraints));e&&(g._user=JSON.stringify(e));return Ht(a,c,b,g,f)},Ft=function(a,b){var c=b.state;switch(c){case "done":return Promise.resolve(zea(b));case "queued":case "inProgress":return Aea(a,b).then(function(d){return Ft(a,d)});default:return Promise.resolve(new Ct(c))}},Aea=function(a,b){return new Promise(function(c){var d=setInterval(function(){Bea(a,b.id).then(function(e){"queued"!=
e.state&&"inProgress"!=e.state&&(clearInterval(d),c(e))})},2E3)})},zea=function(a){a=Gt(a);return"__cloud_webrtc_session_message__"==a.type?new Ct("done","knocking_cloud_webrtc_session_message",new tq(a.sessionDescription)):new Ct("done",a.type)},Ht=function(a,b,c,d,e){b={deviceId:b,name:"_cloudCast."+c.name,parameters:d,expirationTimeoutMs:e||1E4};c={};e&&(c.responseAwaitMs=Math.min(e+5E3,25E3));e=oq(jq.g,["commands"],c);return pq(a.g,e,"POST",b)},Gt=function(a){return a.results&&a.results.results?
JSON.parse(a.results.results):null},Bea=function(a,b){b=oq(jq.g,["commands",b]);return pq(a.g,b,"GET")};Dt.$inject=["gapiService"];var Cea=function(a,b,c,d){this.h=a;this.j=b;this.l=c;this.g=d},uea=function(a,b,c,d){return Dea(a,b,d).then(function(e){a:{var f=c.id;if("done"!=e.state)f=Promise.reject(Error("Offer not executed by receiver. State: "+e.state));else{switch(e.type){case "__cloud_webrtc_session_message__":e=new sj("ANSWER",e.results.sessionDescription);gt(a.g,e,f);break;case "knocking_cloud_webrtc_session_message":eq(0);e=new sj("KNOCK_ANSWER",e.results.sessionDescription);gt(a.g,e,f);break;case "knock_denied":eq(1);
It(a,dt,f);break;case "knock_timeout":eq(2);It(a,et,f);break;default:f=Promise.reject(Error("Invalid message type: "+e.type));break a}f=Promise.resolve()}}return f})},vea=function(a,b){return Bt(a.l).then(function(c){gt(a.g,new sj("TURN_CREDENTIALS",{credentials:c}),b.id)})},Dea=function(a,b,c){var d=c.deviceId,e=a.j.g;e=e?new Tca(e):void 0;b=b.data;switch(c.Oi){case "owner":hq(0);break;case "manager":hq(1);break;case "user":hq(2);break;case "viewer":hq(3)}return"viewer"==c.Oi?xea(a.h,d,b,e):yea(a.h,
d,b,e)},It=function(a,b,c){b=new si(b,"warning");vi(b);a.g.g.qf(b);gt(a.g,new sj("STOP"),c)};var Eea=function(){var a=this;this.s=gb("mr.cloud.settings.SettingsService");this.g=null;chrome.settingsPrivate.onPrefsChanged.addListener(function(b){Zi(13);if(a.g){b=l(b);for(var c=b.next();!c.done;c=b.next())if(c=c.value,"media_router.cloudservices.enabled"==c.key){a.g.call(null,c.value);break}}})},Fea=function(a,b){a.g=b},Gea=function(){return new Promise(function(a,b){chrome.storage.sync.get("mr.cloud.notifiedHangouts",function(c){chrome.runtime.lastError?b(chrome.runtime.lastError):a(c)})})},
Hea=function(a){return Jt().catch(function(){return Jt().catch(function(b){a.s.K("Error retrieving cloud enabled setting.",b);return!1})})},Jt=function(){return Iea().then(function(a){return!!a.value})},Iea=function(){return new Promise(function(a,b){chrome.settingsPrivate.getPref("media_router.cloudservices.enabled",function(c){chrome.runtime.lastError?b(chrome.runtime.lastError):a(c)})})},Jea=function(a){var b=a.s;chrome.storage.sync.set({"mr.cloud.notifiedHangouts":!0},function(){chrome.runtime.lastError&&
b.K("Error setting notified Hangout privacy.",chrome.runtime.lastError)})},Kea=function(a){return Kt().catch(function(){return Kt().catch(function(b){a.s.K("Error retrieving hangouts notified setting.",b);return!1})})},Kt=function(){return Gea().then(function(a){return!!a["mr.cloud.notifiedHangouts"]})};var Lt=new Map([["displayName","display_name"],["description","description"],["type","type"],["status","status"],["state","state"],["commandDefs","command_defs"]]),Mt=function(a,b){ms.call(this,a,b)};q(Mt,ms);h=Mt.prototype;h.act=function(a,b){a=new Pq({method:"POST",baseUrl:this.g,Uc:["devices:act"],rb:this.rb,body:{gcmId:b,id:a}});return this.h.execute(a).then(function(c){return c})};h.create=function(a){a=new Pq({method:"POST",baseUrl:this.g,Uc:["devices"],rb:this.rb,body:a});return this.h.execute(a).then(function(b){return b})};
h.delete=function(a){a=new Pq({method:"DELETE",baseUrl:this.g,Uc:["devices",a],rb:this.rb});return this.h.execute(a)};h.get=function(a){a=new Pq({method:"GET",baseUrl:this.g,Uc:["devices",a],rb:this.rb});return this.h.execute(a).then(function(b){return b})};
h.list=function(a){var b=a.type,c=a.status;a=a.permission;var d={};b&&(d.type=b);c&&(d.status=c);a&&(d.permission=a);b=new Pq({method:"GET",baseUrl:this.g,Uc:["devices"],Un:d,rb:this.rb});return this.h.execute(b).then(function(e){return e.device||[]})};h.update=function(a,b){for(var c=[],d={},e=l(Lt.keys()),f=e.next();!f.done;f=e.next())f=f.value,b[f]&&(d[f]=b[f],c.push(Lt.get(f)));d.id=a;a=new Pq({method:"PUT",baseUrl:this.g,Uc:["devices",a],rb:this.rb,body:{device:d,updateMask:c}});return this.h.execute(a).then(function(g){return g})};var Nt=function(a,b,c,d,e,f){f=void 0===f?null:f;this.s=gb("mr.cloud.slarti.SinkDiscoveryService");this.D=a;this.j=b;this.h=c;this.m=d;this.l=e;this.g=f||new Cq(this.o.bind(this),c,36E5);rs().addListener();Ml(this);Xi("mr.cloud.slarti.SinkDiscoveryService",this)};q(Nt,Ri);Nt.prototype.se=function(){Eda(this.l).catch(function(){});return this.g.se().filter(function(a){return a.isAvailable})};Nt.prototype.ta=function(a){return this.g.ta(a)};
Nt.prototype.handleEvent=function(a,b){if(a!=chrome.gcm.onMessage)throw Error("Unhandled event: expected chrome.gcm.onMessage");Lea(this,b)};
var Lea=function(a,b){var c=JSON.parse(b.data.data);a.s.info("Received Slarti GCM notification: "+c.type);nb(a.s,function(){return"Got notification: "+JSON.stringify(c)});switch(c.type){case "DEVICE_ADDED":Ot(a,c).then(function(d){"cast-receiver"==d.type&&(d=new Bq(d.id,d.displayName,"ONLINE"==d.status),a.g.g.set(d.id,d),Dq(a.h,[d.yb]))});break;case "DEVICE_CHANGED":Ot(a,c).then(function(d){if("cast-receiver"==d.type){var e=bm(am(),d.id);if(e=a.g.ta(e))e.displayName=d.displayName,e.isAvailable="ONLINE"==
d.status,Eq(a.h,[e.yb])}});break;case "DEVICE_REMOVED":Mea(a,Nea(c));Promise.resolve();break;case "COMMAND_CHANGED":Oea(a,c).then(function(d){var e=a.m,f=d.id,g=e.h.get(f);if(g){var k=g.routeId,m=g.sinkId,p=g.resolve,u=g.reject,A=g.Is;g=!0;try{var E=JSON.parse(d.results||"{}"),F=E.sessionDescription,J=E.errorCode,U=E.errorText;switch(d.status){case "SUCCESS":p(gt(e.g,new sj("ANSWER",F),k));A&&eq(0);break;case "ERROR":case "TIMEOUT":var va="TIMEOUT"==d.status;p=ct;"KNOCK_DENIED"==J&&(eq(va?2:1),p=
va?et:dt);ht(e.g,k,7,xi(wi(vi(new si(p,"warning")),k),m));throw Error("Slarti command "+f+" failed with status: "+(d.status+", errorCode: "+J+", errorText: ")+U);default:g=!1}}catch(Xa){u(Xa)}finally{g&&e.h.delete(f)}}else e.s.K("Received update to unknown command with name = "+(d.name+" and id = "+f))});break;default:Promise.resolve()}};Nt.prototype.o=function(){return this.j.list({type:"cast-receiver"}).then(function(a){return a.map(function(b){return new Bq(b.id,b.displayName,"ONLINE"==b.status)})})};
Nt.prototype.Ia=function(){return"SlartiSinkDiscoveryService"};Nt.prototype.tb=function(){return[{cache:Gq(this.g)}]};Nt.prototype.sb=function(){var a=Jl(this);a&&Hq(this.g,a.cache)};
var Mea=function(a,b){b=bm(am(),b);var c=a.g.ta(b);c&&(a.g.g.delete(b),Fq(a.h,[c.yb]))},Nea=function(a){a=a.deviceInfo;return a.device?a.device.id:a.deviceId},Ot=function(a,b){b=b.deviceInfo;return b.device?Promise.resolve(b.device):a.j.get(b.deviceId)},Oea=function(a,b){b=b.commandInfo;return b.command?Promise.resolve(b.command):a.D.get(b.commandId)};var Pt=function(){this.g=null},Qt=function(a,b){if(!a.g||M(a.g,2)<M(b,2))a.g=nl(b)},Rt=function(a){return a.g?M(a.g,2)+";"+M(a.g,1):null};var St=function(){this.C=this.D=this.L=this.M=this.H=this.G=this.j=this.F=this.l=this.h=this.m=this.ja=this.ia=this.X=this.J=this.nb=this.ea=this.W=this.N=this.o=this.u=this.g=null},Tt=function(){var a=St.ib();null==a.D&&(a.D=new Pt);return a.D},Ut=function(a){null==a.g&&(a.g=new Mq);return a.g},Vt=function(a){null==a.u&&(a.u=new Mda(Ut(a)));return a.u},Wt=function(a){null==a.o&&(a.o=new ls);return a.o},Xt=function(a){null==a.N&&(a.N=new jt(Ut(a),Wt(a)));return a.N},Zt=function(a,b){null==a.J&&(a.J=
new pea(Xt(a),Yt(a),b));return a.J},$t=function(a){null==a.F&&(a.F=new Dt(Vt(a)));return a.F},Yt=function(a){null==a.L&&(a.L=new mea(Vt(a)));return a.L},au=function(a){null==a.C&&(a.C=new sq);return a.C};Pa(St);var cu=function(a,b){this.j=a;this.D=b;this.m=new Cb;this.la=this.m.g;this.g=bu(a.id);this.h=new Cb;this.l=!1;Pea(this);Qea(this);this.g.sendMessage(new sj("GET_TURN_CREDENTIALS"))};cu.prototype.start=function(){var a=this;return this.la.then(function(b){if(b.g)return Promise.reject(Error("Presentation already started"));b.start();return a.h.g})};cu.prototype.stop=function(){var a=this;this.l=!1;return this.la.then(function(b){b.stop();a.la=Promise.reject(Error("Peer connection has already been stopped"))})};
var Pea=function(a){a.g.onMessage=function(b){if(b.type)switch(b.type){case "TURN_CREDENTIALS":a.m.resolve(new wj(a.j.id,b.data.credentials));break;case "ANSWER":a.la.then(function(c){Cj(c,b.data)});break;case "STOP":a.h.reject("Stop signal received");a.stop();break;default:throw Error("Unknown message type: "+b.type);}else a.la.then(function(c){var d={type:"PRESENTATION_CONNECTION_MESSAGE",data:b};"string"==typeof d?c.l.send(d):c.l.send(JSON.stringify(d))})}},Qea=function(a){a.la.then(function(b){Aj(b,
function(c){a.g.sendMessage(new sj("OFFER",new uj(c,null,null,a.D,a.j.id)))});Bj(b,function(c){c=tj(c);"STOP"==c.type&&a.stop();a.g.sendMessage(c)});xj(b,function(){a.l=!0;a.g.sendMessage(new sj("SESSION_START_SUCCESS"));a.h.resolve(a.j)});zj(b,function(){a.g.sendMessage(new sj("SESSION_END"))});yj(b,function(c){a.l||a.h.reject(c);a.g.sendMessage(new sj("SESSION_FAILURE"))})})};var du=function(a){this.g=a;this.h=new Map;this.G=new Map;this.H=new Map;this.D=[];this.F=this.J=this.u=this.M=this.l=null;this.m=this.j=!1;this.C=new Map;this.o=new Map;Ml(this)};du.prototype.getName=function(){return"cloud"};
du.prototype.initialize=function(){var a=this;this.s.info("Initializing Cloud MRP");var b=St.ib();null==b.ja&&(null==b.ia&&(b.ia=new wq(Vt(b),au(b))),b.ja=new xs(b.ia,this));this.D.push(b.ja);if(null==b.nb){var c=Xt(b);null==b.W&&(b.W=new Mt(Ut(b),Wt(b)));var d=b.W,e=Zt(b,this);null==b.X&&(null==b.ea&&(b.ea=new ns(Ut(b),Wt(b))),b.X=new Dda(b.ea,window.localStorage,au(b)));b.nb=new Nt(c,d,this,e,b.X)}this.D.push(b.nb);null==b.l&&(null==b.h&&(b.h=new mq(Vt(b),Ut(b))),c=b.h,null==b.m&&(b.m=new aea(Vt(b))),
b.l=new Jq(c,b.m,this));this.l=b.l;this.D.push(this.l);this.M=$t(b);Zt(b,this);this.u=Ut(b);null==b.H&&(c=Zt(b,this),null==b.j&&(b.j=new Cea($t(b),Ut(b),Yt(b),this)),d=b.j,null==b.G&&(b.G=new cea(Ut(b),this)),b.H=new tea(c,d,b.G,this));this.J=b.H;null==b.M&&(b.M=new Eea);this.F=b.M;Hea(this.F).then(function(f){a.j=f;a.s.info("Cloud enabled setting: "+a.j)});Fea(this.F,function(f){a.j=f;a.s.info("Cloud enabled setting: "+a.j);a.j&&eu(a)});Kea(this.F).then(function(f){a.m=f;a.s.info("Privacy notified setting: "+
a.m)})};du.prototype.Rd=function(){return Array.from(this.h.values())};
du.prototype.Qg=function(a){if(!fu(this,a))return Lo;nb(this.s,"GetAvailableSinks for "+a);var b=eu(this);this.o.clear();for(var c={},d=l(this.C.values()),e=d.next();!e.done;c={Hf:c.Hf,Dh:c.Dh},e=d.next())c.Hf=e.value,c.Dh=!1,b.forEach(function(f){return function(g){g.id==f.Hf.yb.id&&(f.Dh=!0,g.friendlyName=f.Hf.yb.friendlyName)}}(c)),c.Dh||this.o.set(c.Hf.id,c.Hf.yb);b=b.concat.apply(b,n(this.o.values()));nb(this.s,function(){return"Available sinks are..."+JSON.stringify(b)});this.l&&(b=b.concat(Rea));
return new Ko(b,-1!=a.indexOf("0F5096E8")?ej:null)};var eu=function(a){var b=[];a.s.info("Checking cloud discovery services");a.D.forEach(function(c){c=c.se().map(function(d){return d.yb});b=b.concat(c)});return b};h=du.prototype;h.startObservingMediaSinks=function(){};h.stopObservingMediaSinks=function(){};h.startObservingMediaRoutes=function(){};h.stopObservingMediaRoutes=function(){};h.ta=function(a){return(a=gu(this,a))?a.yb:null};
h.createRoute=function(a,b,c,d,e,f,g){var k=this;this.s.info("createRoute called");nb(this.s,"urn: "+a+" sinkId:"+b);if(e=this.G.get(b))return zi(this.g.en(this,e,a,c,g,function(m){m.mediaSource=a;m.Db.tabId=g;return Ai(m)}),function(m){k.g.vf(m);return m});e=gu(this,b);return Sea(this,a,e,b,c,d,g)};
var hu=function(a,b,c,d,e){b instanceof Jo&&2==b.errorCode?ht(a,c,6,null):(a.s.error("Error on start session",b instanceof Error?b:Error("Expected an Error value, got "+b)),a.h.has(c.id)&&ht(a,c,e,xi(new si(ct,"warning"),c.sinkId)));if(b=a.l)b=a.l,b.h.delete(d.deviceId)?(b.g.g.delete(d.id),b=!0):b=!1;b&&Fq(a,[d.yb])},Sea=function(a,b,c,d,e,f,g){if(f)return Bi(Error("not supported"));f=!1;switch(c.g){case "slarti":case "weave":gq(1);break;case "mesi":f=!0;if(!a.m){a.m=!0;Jea(a.F);var k=xi(ui(),d);
a.g.qf(k)}gq(0)}am().h=new Yl(c.model,null);var m=so(e,a.getName(),d,b,!0,"");a.h.set(m.id,m);a.G.set(d,m);a.C.set(m.id,c);a.H.set(m.id,c.g);a.g.pg(a,m);a.g.sg(a.Ia(),!0);if(dj(b)&&!f)return a.s.info("starting presentation on route: "+m.id),Tea(m,b).catch(function(p){hu(a,p,m,c,7);throw p;});a.s.info("starting mirroring on route: "+m.id);m.Db={tabId:g,sessionId:"",vg:"",we:c.model};dj(b)&&(m.isOffscreenPresentation=!0);return a.g.Lj(a,m,e).catch(function(p){hu(a,p,m,c,5);throw p;})};
du.prototype.terminateRoute=function(a){return ht(this,a,0,null)};
var ht=function(a,b,c,d){var e="string"==typeof b?a.h.get(b):b;if(!e)return Promise.reject(new Jo(3,"Route in cloud provider not found for routeId "+b));a.s.info("terminating route: "+e.id);a.h.delete(e.id);a.G.delete(e.sinkId);b=a.C.get(e.id);a.C.delete(e.id);d&&a.g.qf(d);Bb("MediaRouter.Cloud.Session.End",c,Jca);switch(c){case 1:break;default:switch(b.g){case "weave":Ht(a.M,b.deviceId,Xca,{})}}a.g.eh(e);0==a.h.size&&a.g.sg(a.Ia(),!1);a.g.onPresentationConnectionStateChanged(e.id,"terminated");a.o.has(e.sinkId)&&
(c=a.o.get(e.sinkId),Fq(a,[c]),a.o.delete(e.sinkId));return Promise.resolve()};h=du.prototype;h.sendRouteMessage=function(a,b){var c=this.H.get(a);if(c){var d=(a=this.h.get(a)||void 0)?gu(this,a.sinkId):void 0;return wea(this.J,c,b,a,d)}return"string"===typeof b?(gt(this,b,a),Promise.resolve()):Promise.reject(Error("Channel type missing"))};h.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};
h.bg=function(a){var b=new qj;5>b.minFrameRate&&(b.minFrameRate=5);var c=this.ag(a);"hangouts"==c||"meetings"==c?(b.maxWidth=Math.min(window.screen&&window.screen.width||Infinity,2880),b.maxHeight=Math.min(window.screen&&window.screen.height||Infinity,1800)):b.senderSideLetterboxing=!0;rj(b);Object.freeze(b);this.s.info("Settings for "+a+": "+pj(b));if(!b.shouldCaptureAudio&&!b.shouldCaptureVideo)throw Error("Cannot start mirroring without video or audio capture.");return b};
h.ag=function(a){var b=null;a=gu(this,a);switch(a.g){case "slarti":case "weave":b="webrtc";break;case "mesi":b=a.Vd?"meetings":"hangouts"}return b};h.ni=function(){};h.Jg=function(a,b){nb(this.s,"Checking canRoute: "+a+" for sinkId: "+b);return fu(this,a)&&!!this.ta(b)};h.Pf=function(a,b){return dj(a)&&this.h.has(b)};h.joinRoute=function(a,b){return(a=this.h.get(b))?(this.s.info("joining route: "+a.id),Ai(a)):Bi(Error("not supported"))};h.connectRouteByRouteId=function(){return Bi(Error("not supported"))};
h.detachRoute=function(){};
var Dq=function(a,b){a.s.info(b.length+" sinks added");b=gu(a,b[0].id);am().g=new Yl(b.model,null);a.g.td();a.g.onSinkAvailabilityUpdated(a,2);a.s.info("sinkAvailability changed to AVAILABLE")},Fq=function(a,b){a.s.info(b.length+" sinks removed");a.D.some(function(c){return 0<c.se().length})||(a.g.onSinkAvailabilityUpdated(a,0),a.s.info("sinkAvailability changed to UNAVAILABLE"));a.g.td()},Eq=function(a,b){a.s.info(b.length+" sinks updated");a.g.td()},gt=function(a,b,c,d){(void 0===d?0:d)?a.g.re(c,
b):a.g.mi(c,b)},gu=function(a,b){var c=Uea(a,b);c||(c=null,(b=a.G.get(b))&&(c=a.C.get(b.id)));return c},Uea=function(a,b){var c=null;a.D.some(function(d){c=d.ta(b);return!!c});return c},fu=function(a,b){var c=bj(b);b=dj(b);if(a.u.j&&!a.u.h&&c)return a.g.onSinkAvailabilityUpdated(a,2),!0;var d=!1;a.j&&a.u.h&&(d=!0);var e;if(e=!chrome.declarativeWebRequest)a=a.u,e=!(a.j||a.h&&a.g&&(-1!=Oq.indexOf(a.g)||-1!=Oq.indexOf(Nq(a))))&&b;return e?!1:d&&(c||b)};h=du.prototype;
h.searchSinks=function(a,b){var c=this;if(!fu(this,a))return Promise.reject(Error("err"));a=gda(this.l,b);a.then(function(d){Dq(c,[d])});return a};h.createMediaRouteController=function(){return db()};h.provideSinks=function(){};h.Ia=function(){return"CloudProvider"};h.tb=function(){return[void 0,{cloudEnabled:this.j,notifiedHangoutsPrivacy:this.m}]};h.sb=function(){var a=Kl(this);a&&(a.cloudEnabled&&(this.j=a.cloudEnabled),a.notifiedHangoutsPrivacy&&(this.m=a.notifiedHangoutsPrivacy))};
var Tea=function(a,b){a=new cu(a,b);return Ci(a.start())};du.prototype.s=gb("mr.CloudProvider");var Rea=new Fl("pseudo:cloud","","meeting","","default");var iu=function(){no.call(this,12,"ExternalMessageListener","mr.ProviderManager",chrome.runtime.onMessageExternal)};q(iu,no);iu.prototype.Bh=function(a,b){return b.id&&-1!=Vea.indexOf(b.id)?"start"==a.type||"stop"==a.type||"subscribe_log_data"==a.type:!1};iu.prototype.Xi=function(){return!0};var ku=function(){ju||(ju=new iu);return ju},ju=null,Vea=["idmofbkcelhplfjnmmdolenpigiiiecc","ggedfkijiiammpnbdadhllnehapomdge","njjegkblellcjnakomndbaloifhcoccg"];var lu=function(){no.call(this,11,"InternalMessageListener","mr.ProviderManager",chrome.runtime.onMessage)};q(lu,no);lu.prototype.Bh=function(a,b){return"retrieve_log_data"==a.type&&b.id==chrome.runtime.id&&b.url=="chrome-extension://"+b.id+"/feedback.html"};lu.prototype.Xi=function(){return!0};var nu=function(){mu||(mu=new lu);return mu},mu=null;function Wea(){var a=ou;var b=new Mo(a);var c=new Bp(a);b=[b,c];b.push(new du(a));return b};var pu=function(a,b){this.routeId=a;this.message=b},qu=function(a){return"string"!=typeof a.message};var ru=function(a){this.C=a;this.l=this.m=null},su=function(a){if(null==a.l)if(null==a.m||Date.now()-a.m>=a.C)a.D();else{var b=Math.max(a.m+a.C-Date.now(),5);a.l=setTimeout(a.D.bind(a),b)}};ru.prototype.D=function(){null!=this.l&&(clearTimeout(this.l),this.l=null);this.F();this.m=Date.now()};ru.prototype.F=function(){};var tu=function(a,b){ru.call(this,20);this.g=new Map;this.h=new Set;this.u=null;this.o=this.j=0;this.G=!1;this.M=a;this.H=b;this.s=gb("mr.RouteMessageSender")};q(tu,ru);tu.prototype.init=function(a){this.u=a;Ml(this)};tu.prototype.stopListeningForRouteMessages=function(a){this.h.delete(a)};
tu.prototype.send=function(a,b){var c=this.g.get(a);c||(c=[],this.g.set(a,c));b=new pu(a,b);c.push(b);50<c.length&&1==c.length%50&&this.s.K(function(){return"Message queue length is excessively large ("+(c.length+") for route "+a)});this.j+=qu(b)?0:b.message.length;qu(b)&&this.o++;uu(this);this.h.has(a)&&su(this)};
var vu=function(a,b){if(0!=b.length){b=l(b);for(var c=b.next();!c.done;c=b.next())c=c.value,a.j-=qu(c)?0:c.message.length,qu(c)&&a.o--}},uu=function(a){var b=0<a.o||a.j>a.H;b!=a.G&&(a.G=b,a.M.sg(a.Ia(),b))};tu.prototype.F=function(){if(this.u){for(var a=l(this.h),b=a.next();!b.done;b=a.next()){b=b.value;var c=this.g.get(b);c&&0!=c.length&&(this.u(b,c),vu(this,c),this.g.set(b,[]))}uu(this)}else this.s.error("sendMessagesCallback not set. Messages not delivered.")};tu.prototype.Ia=function(){return"mr.RouteMessageSender"};
tu.prototype.tb=function(){var a=[].concat(n(this.g.entries())).map(function(b){return[b[0],b[1].map(function(c){return c.message})]});return[new Xea(a,Array.from(this.h),this.j)]};tu.prototype.sb=function(){var a=Jl(this);if(a){this.g=new Map;for(var b={},c=l(a.h),d=c.next();!d.done;b={Eh:b.Eh},d=c.next())d=d.value,b.Eh=d[0],d=d[1].map(function(e){return function(f){return new pu(e.Eh,f)}}(b)),this.g.set(b.Eh,d);this.h=new Set(a.g);this.j=a.j}};var Xea=function(a,b,c){this.h=a;this.g=b;this.j=c};var Yea=function(a,b){this.type="internal_message";this.routeId=a;this.message=b};var wu=function(a,b,c){this.g=a;this.l=b;this.j=c;this.onMessage=function(){};c.listen("internal_message",this.h,this)};wu.prototype.sendMessage=function(a,b){return this.l(this.g,a,b)};wu.prototype.h=function(a){if(a.routeId==this.g)this.onMessage(a.message)};wu.prototype.eb=function(){this.onMessage=function(){};Uba(this.j,this.h,this)};
var Zea=new wu("",function(){return Promise.resolve()},new Xo),$ea=function(a){this.g=a},bu=function(a){var b=qi,c=b.g.gj(a);return c?new wu(a,c.sendRouteMessage.bind(c),b.g.ij()):Zea};var xu=function(a,b){this.D=null!=b?a.bind(b):a;this.m=this.o.bind(this);this.l=[];this.g=!1;this.h=null};xu.prototype.j=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];this.l=[].concat(n(b));null==this.h?yu(this):this.g=!0};var yu=function(a){a.h=setTimeout(a.m,500);a.D.apply(a,n(a.l))};xu.prototype.o=function(){this.h=null;this.g&&(this.g=!1,yu(this))};var zu=function(){this.config=null;this.s=gb("mr.ProviderManager");this.j=[];this.h=new Map;this.o=new Map;this.m=new Set;this.l=new Set;this.C=new Map;this.g=this.F=null;this.J=new Xo;this.L=new xu(this.ko,this);this.X=new xu(this.M,this);this.D=new tu(this,524288);this.H=0;this.u=new Map;this.G=[];var a=new bq(this);this.W=a.onMessage.bind(a);a=new Wp(this);this.N=a.onMessage.bind(a);this.onBeforeInvokeHandler=this.onBeforeInvokeHandler;this.createRoute=this.createRoute;this.joinRoute=this.joinRoute;
this.connectRouteByRouteId=this.connectRouteByRouteId;this.terminateRoute=this.terminateRoute;this.startObservingMediaSinks=this.startObservingMediaSinks;this.stopObservingMediaSinks=this.stopObservingMediaSinks;this.sendRouteMessage=this.sendRouteMessage;this.sendRouteBinaryMessage=this.sendRouteBinaryMessage;this.startListeningForRouteMessages=this.startListeningForRouteMessages;this.stopListeningForRouteMessages=this.stopListeningForRouteMessages;this.startObservingMediaRoutes=this.startObservingMediaRoutes;
this.stopObservingMediaRoutes=this.stopObservingMediaRoutes;this.detachRoute=this.detachRoute;this.searchSinks=this.searchSinks;this.provideSinks=this.provideSinks;this.updateMediaSinks=this.updateMediaSinks;this.createMediaRouteController=this.createMediaRouteController};q(zu,Ri);
zu.prototype.handleEvent=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];if(a==chrome.runtime.onMessage)this.W.apply(this,n(c));else if(a==chrome.runtime.onMessageExternal)this.N.apply(this,n(c));else throw Error("Unhandled event");};
var dq=function(a,b){b=a.C.get(b);return Ui(b).then(function(c){c.initialize(a,!!a.config&&a.config.use_mirroring_service);return c})},afa=function(a,b,c){b.forEach(function(d){if(cq(a,d.getName()))a.s.K("Provider "+d.getName()+" already registered.");else try{d.initialize(c),a.j.push(d),a.u.set(d.getName(),0)}catch(e){a.s.K("Provider "+d.getName()+" failed to initialize.",e)}})};
zu.prototype.initialize=function(a,b,c){this.C.set("webrtc","mr.mirror.webrtc.WebRtcService");this.C.set("cast_streaming","mr.mirror.cast.Service");this.C.set("hangouts","mr.mirror.hangouts.HangoutsService");this.C.set("meetings","mr.mirror.hangouts.MeetingsService");var d=new $ea(this);qi||(qi=d);this.g=a;this.D.init(this.g.onRouteMessagesReceived.bind(this.g));afa(this,b,c);this.config=c;Ml(this);Xi("mr.ProviderManager",this)};
var Bu=function(a,b,c){return new Promise(function(d,e){var f=null;a.H++;Au(a);f=window.setTimeout(function(){f=null;b.cancel(new Jo(2,"timeout after "+c+" ms."))},c);b.g.then(function(g){a.H--;Au(a);null!=f&&window.clearTimeout(f);d(g)},function(g){a.H--;Au(a);null!=f&&window.clearTimeout(f);e(g instanceof Jo?g:g instanceof Error?new Jo(0,g.message,g.stack):new Jo(0))})})};zu.prototype.onBeforeInvokeHandler=function(){Zi(0)};
var Cu=function(a){return"string"==typeof a?a:a.unique?"":a.scheme+"://"+a.host+"\n       "+(a.port?":"+a.port:"")+"/"};h=zu.prototype;
h.createRoute=function(a,b,c,d,e,f,g){var k=this;g=void 0===g?!1:g;var m=bfa(this,a,b);if(!m)return Promise.reject(new Jo(7,"No provider supports createRoute with source: "+a+" and sink: "+b));var p=void 0;void 0!==d&&(p=Cu(d));f=f&&0<f?f:6E4;a=m.createRoute(a,b,c,g,f,p,e);return Bu(this,a,f).then(function(u){return u},function(u){k.s.error("Error creating route.",u);throw u;})};
h.connectRouteByRouteId=function(a,b,c,d,e,f){var g=this.h.get(b);if(!g)return Promise.reject(new Jo(7,"No provider supports join "+b));a=g.connectRouteByRouteId(a,b,c,Cu(d),e);return Bu(this,a,f&&0<f?f:3E4)};h.joinRoute=function(a,b,c,d,e,f){f=void 0===f?!1:f;var g=cfa(this,a,b);if(!g)return Promise.reject(new Jo(7,"No provider supports join "+b));e=e&&0<e?e:3E4;a=g.joinRoute(a,b,f,e,Cu(c),d);return Bu(this,a,e)};
h.terminateRoute=function(a){var b=this.h.get(a);return b?Du(this,a).then(function(){return b.terminateRoute(a)}):Promise.reject(new Jo(3,"Route not found for routeId "+a))};h.startObservingMediaSinks=function(a){this.m.has(a)||(this.m.add(a),this.j.forEach(function(b){b.startObservingMediaSinks(a)}));Eu(this,a)};h.stopObservingMediaSinks=function(a){this.m.delete(a)?Fu(this,a):this.s.info("No existing query "+a)};
var Fu=function(a,b){a.j.forEach(function(c){c.stopObservingMediaSinks(b)})},Eu=function(a,b){if("urn:x-org.chromium.media:source:tab:-1"==b)a.s.K("No sinks for sourceUrn: "+b);else{var c=new Map,d=[];a.j.forEach(function(e){var f=e.Qg(b);0<f.sinks.length&&(d=f.origins);f.sinks.forEach(function(g){c.has(g.id)?a.s.K("Detected duplicate sink "+g.id+" from provider: "+e.getName()):c.set(g.id,g)})});dfa(a,b,Array.from(c.values()),d||[])}},dfa=function(a,b,c,d){a.s.info("Sending "+c.length+" sinks to MR for "+
b);a.g.onSinksReceived(b,c,d.map(gba))};h=zu.prototype;h.sendRouteMessage=function(a,b,c){var d=this.h.get(a);d?(a=d.sendRouteMessage(a,b,c),a=Bu(this,Ci(a),3E4)):a=Promise.reject(Error("Invalid route ID "+a));return a};h.sendRouteBinaryMessage=function(a,b){var c=this.h.get(a);c?(a=c.sendRouteBinaryMessage(a,b),a=Bu(this,Ci(a),3E4)):a=Promise.reject(Error("Invalid route ID "+a));return a};
h.startListeningForRouteMessages=function(a){var b=this.D;b.h.has(a)||(b.h.add(a),(a=b.g.get(a))&&0<a.length&&su(b))};h.stopListeningForRouteMessages=function(a){this.D.stopListeningForRouteMessages(a)};h.detachRoute=function(a){var b=this.h.get(a);b?b.detachRoute(a):this.s.info("Route "+a+" does not exist.")};h.enableMdnsDiscovery=function(){};var bfa=function(a,b,c){return a.j.find(function(d){return d.Jg(b,c)})||null},cfa=function(a,b,c){return a.j.find(function(d){return d.Pf(b,c)})||null};
zu.prototype.M=function(){var a=this;this.m.forEach(function(b){Eu(a,b)})};var Au=function(a){a.g.setKeepAlive(0<a.H||0<a.G.length)};h=zu.prototype;h.startObservingMediaRoutes=function(a){this.l.has(a)||(this.l.add(a),this.j.forEach(function(b){b.startObservingMediaRoutes(a)}));this.L.j()};h.stopObservingMediaRoutes=function(a){this.l.delete(a)?this.j.forEach(function(b){b.stopObservingMediaRoutes(a)}):this.s.info("No existing route query "+a)};
h.ko=function(){var a=this;if(0!=this.l.size){var b=[];this.j.forEach(function(c){b=b.concat(c.Rd())});this.l.forEach(function(c){var d=[];a.j.forEach(function(e){e.Rd().forEach(function(f){!f.Sf&&e.Pf(c,void 0,f)&&d.push(f.id)})});a.g.onRoutesUpdated(b,c,d)})}};h.Ia=function(){return"ProviderManager"};
h.tb=function(){return[new efa(this.j.map(function(a){return a.getName()}),Array.from(this.m),Array.from(this.l),Array.from(this.h,function(a){var b=l(a);a=b.next().value;b=b.next().value;return[a,b.getName()]}),Array.from(this.u),this.F)]};h.sb=function(){var a=Jl(this);if(a){this.m=new Set(a.m);this.l=new Set(a.j);for(var b=l(a.h),c=b.next();!c.done;c=b.next()){var d=l(c.value);c=d.next().value;d=d.next().value;d=cq(this,d);this.h.set(c,d)}this.u=new Map(a.l);this.F=a.g||null}};h.gj=function(a){return this.h.get(a)};
h.pg=function(a,b){this.h.set(b.id,a);this.vf(b)};h.eh=function(a){Du(this,a.id);this.h.delete(a.id);var b=this.D,c=a.id;b.h.delete(c);var d=b.g.get(c);d&&(b.g.delete(c),vu(b,d),uu(b));this.vf(a)};h.vf=function(){0<this.l.size&&this.L.j()};h.pj=function(a){var b=this.h.get(a.id);b&&(b.ni(a.id),0<this.l.size&&this.ko())};h.re=function(a,b){this.h.has(a)?("string"===typeof b||b instanceof Uint8Array||(b=JSON.stringify(b)),this.D.send(a,b)):this.s.K("Got route message for closed route "+a)};
h.onPresentationConnectionStateChanged=function(a,b){"terminated"==b&&this.D.D();this.g.onPresentationConnectionStateChanged(a,b)};h.onPresentationConnectionClosed=function(a,b,c){this.D.D();this.g.onPresentationConnectionClosed(a,b,c)};h.oi=function(a){this.o.delete(a);var b=this.h.get(a);b&&b.terminateRoute(a)};h.mi=function(a,b){Vba(this.J,new Yea(a,b))};h.td=function(){this.X.j()};
h.onSinkAvailabilityUpdated=function(a,b){var c=this;if(this.u.get(a.getName())!=b){var d=Gu(this);this.u.set(a.getName(),b);a=Gu(this);d!=a&&(0==a&&this.M(),this.g.onSinkAvailabilityUpdated(a),0==a&&(this.m.forEach(function(e){Fu(c,e)}),this.m.clear()))}};var Gu=function(a){return Array.from(a.u.values()).reduce(function(b,c){return Math.max(b,c)},0)};zu.prototype.ij=function(){return this.J};zu.prototype.qf=function(a){this.g.onIssue(a)};
var Du=function(a,b){return a.o.has(b)?dq(a,a.o.get(b)).then(function(c){a.o.delete(b);return c.o()}):Promise.resolve(!1)};zu.prototype.Lj=function(a,b,c,d){var e=this,f=a.ag(b.sinkId);this.s.info("Starting mirroring using service: "+f);this.o.set(b.id,f);return Di(dq(this,f),function(g){e.F=f;return g.Yj(b,b.mediaSource,a.bg(b.sinkId),c,d).catch(function(k){if(k instanceof Fi&&3==k.reason)throw new Jo(8);throw k;})})};
zu.prototype.en=function(a,b,c,d,e,f){var g=this,k=this.o.get(b.id);return k?Di(dq(this,k),function(m){g.F=k;return m.Zj(b,c,a.bg(b.sinkId),d,e,f)}):Bi(Error("Route "+b.id+" is not mirroring"))};zu.prototype.sg=function(a,b){var c=this.G.indexOf(a),d=0<=c;b&&!d?this.G.push(a):!b&&d&&this.G.splice(c,1);Au(this)};var cq=function(a,b){return a.j.find(function(c){return c.getName()==b})||null};h=zu.prototype;
h.searchSinks=function(a,b,c){var d=a.startsWith("pseudo:")?a.substring(7):null;return(d=d?cq(this,d):null)?d.searchSinks(b,c).then(function(e){return e.id}):Promise.reject(Error("No provider supports "+a))};h.provideSinks=function(a,b){var c=cq(this,a);c?c.provideSinks(b):this.s.error("provideSinks: Provider not found for providerName "+a)};h.updateMediaSinks=function(a){this.m.has(a)||Eu(this,a)};
h.createMediaRouteController=function(a,b,c){var d=this,e=this.h.get(a);return e?e.createMediaRouteController(a,b,c).catch(function(f){d.s.error("createMediaRouteController failed: "+f.message);b.close();c.ptr.reset();throw f;}):(a="createMediaRouteController: Provider not found for "+a,this.s.error(a),b.close(),c.ptr.reset(),Promise.reject(Error(a)))};h.onMediaRemoterCreated=function(a,b,c){this.g.onMediaRemoterCreated(a,b,c)};
h.getMediaSinkServiceStatus=function(){return"function"!=typeof this.g.getMediaSinkServiceStatus?Promise.resolve({status:""}):this.g.getMediaSinkServiceStatus()};h.getMirroringServiceHostForTab=function(a,b){this.g.getMirroringServiceHostForTab(a,b)};h.getMirroringServiceHostForDesktop=function(a,b,c){this.g.getMirroringServiceHostForDesktop(a,b,c)};h.getMirroringServiceHostForOffscreenTab=function(a,b,c){this.g.getMirroringServiceHostForOffscreenTab(a,b,c)};
var efa=function(a,b,c,d,e,f){this.m=b;this.j=c;this.h=d;this.l=e;this.g=f};
